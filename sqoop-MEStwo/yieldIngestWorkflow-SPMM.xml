<workflow-app name="ModcoIngest-SPMM" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SPML_ModuleInfo-Ingest-SPMM"/>


    <action name="_SPML_ModuleInfo-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/_SPML_ModuleInfo/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ModuleInfoID,SerialNo,LaminateID,LaminateCreatedDT,LaminateOrderNo,LaminatePartNo,BINNo,CktFormBuildPart,CktFormBuildMachine,CktFormBuildDT,GlassBuildPart,GlassBuildDate,LaminationBuildMachine,LaminationBuildDT,ModuleID,ModuleCreatedDT,ModuleOrderNo,IntendedModulePartNo,IntendedModulePartDesc,FramingBuildPart,FramingBuildMachine,FramingBuildDT,JboxBuildPart,JboxBuildDT,FlashtestClassifiedDT,FinalModulePartNo,FinalModulePartDesc,ActualPower,ActualVocMod,ActualFF,PackedDT,InventoryState,JboxBuildMachine,ActualIsc,FlashtestBuildMachine,Komax1,Komax2,Komax3,GlassID,CellType,StringerOperator,CircuitOperator1,CircuitOperator2,TrimChangeReason,PowerChartGenerated,LaminateWoId,ModuleWoId,VisualStateId,RfInvStateId,ElTestDate,ElBuildMachine,ActualVmpMod,ActualImpMod,TrimBuildMachine,TrimBuildDT,CellThickness,PalletID,FlashTestID,PadLock,BtoCtoSerialNo,EvaUseByDT, 2 as "org_id"  FROM dbo._SPML_ModuleInfo WHERE $CONDITIONS</arg>

            <arg>--split-by</arg>
            <arg>ModuleInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/_SPML_ModuleInfo/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Address-Ingest-SPMM"/>
        <error to="Address-Ingest-SPMM"/>
    </action>

    <action name="Address-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Address/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AddressID,Address1,Address2,City,County,PostCode,Country, 2 as "org_id"  FROM dbo.Address WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Address/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Customer-Ingest-SPMM"/>
        <error to="Customer-Ingest-SPMM"/>
    </action>

    <action name="Customer-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Customer/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CustomerID,Customer,CustomerCode,AddressID,RfLanguageID, 2 as "org_id"  FROM dbo.Customer WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Customer/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Department-Ingest-SPMM"/>
        <error to="Department-Ingest-SPMM"/>
    </action>

    <action name="Department-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Department/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DepartmentID,Name,DepartmentGroup,Classification1,PlantID,DepartmentCode,Description, 2 as "org_id"  FROM dbo.Department WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Department/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPMM"/>
        <error to="InvChangeState-Ingest-SPMM"/>
    </action>

    <action name="InvChangeState-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/InvChangeState/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 2 as "org_id"  FROM dbo.InvChangeState WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/InvChangeState/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvIsolatedReason-Ingest-SPMM"/>
        <error to="InvIsolatedReason-Ingest-SPMM"/>
    </action>

    <action name="InvIsolatedReason-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/InvIsolatedReason/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvIsolatedReasonID,PartTypeID,IsolatedReason,InvStateID, 2 as "org_id"  FROM dbo.InvIsolatedReason WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/InvIsolatedReason/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvState-Ingest-SPMM"/>
        <error to="InvState-Ingest-SPMM"/>
    </action>

    <action name="InvState-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/InvState/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvStateID,InvState,Description,RfInvStateID,InvStateCode,IsAddToProduction,IsAddToHFI,IsDefault, 2 as "org_id"  FROM dbo.InvState WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/InvState/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineGroup-Ingest-SPMM"/>
        <error to="LineGroup-Ingest-SPMM"/>
    </action>

    <action name="LineGroup-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/LineGroup/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineGroupID,LineGroup,LineGroupCode,Description,OEETarget,WasteTarget,Reference1,Reference2,Reference3,Reference4,Reference5, 2 as "org_id"  FROM dbo.LineGroup WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/LineGroup/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo-Ingest-SPMM"/>
        <error to="LineInfo-Ingest-SPMM"/>
    </action>

    <action name="LineInfo-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/LineInfo/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,RfLineInfoEventID,LineID,ShiftID,WOID,FromDT,ToDT,rfDayHourPeriodID,TotalTime,ExcludedTime,ScheduledTime,STOperations,STInduced,DTTechnical,DTOperations,DTQuality,DownTime,StopTime,RunTime,NotRunTime,TheoreticalCycleTime,QuantityScrap,QuantityGood,ModifiedDT,LoginID,QuantityIn,TotalInventoryProduced,TotalInventoryReintroduced,NetQuantityProduced,QuantityInLineSpoilage,TotalSpoilage,AccountedSpoilage,TotalInventoryIsolated,ProductionStopJobID,TotalUnitsProduced,BottleNeckMachineStageID,InventoryIn,InterProdStopTime,InProdStopTime,QuantityUnitsIn,QuantityInventoryIn,TotalQuantityProduced,TotalPacksProduced,TotalPacksIsolated,TotalPacksReintroduced,TotalPacksMade,ValidState,LineGroupID,LineGroupShiftID,LineGroupBottleneckID, 2 as "org_id"  FROM dbo.LineInfo WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/LineInfo/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineSection-Ingest-SPMM"/>
        <error to="LineSection-Ingest-SPMM"/>
    </action>

    <action name="LineSection-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/LineSection/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineSectionID,LineSection,Description,IsRetired, 2 as "org_id"  FROM dbo.LineSection WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/LineSection/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineType-Ingest-SPMM"/>
        <error to="LineType-Ingest-SPMM"/>
    </action>

    <action name="LineType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/LineType/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineTypeID,LineType,Description,IsRetired,LineInfoPrecedence,BudgetChangeOver,BudgetEfficiency, 2 as "org_id"  FROM dbo.LineType WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/LineType/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageType-Ingest-SPMM"/>
        <error to="MachineStageType-Ingest-SPMM"/>
    </action>

    <action name="MachineStageType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/MachineStageType/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageTypeID,Name,Description,MachineStageTypeCode, 2 as "org_id"  FROM dbo.MachineStageType WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/MachineStageType/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopCategory-Ingest-SPMM"/>
        <error to="MachineStopCategory-Ingest-SPMM"/>
    </action>

    <action name="MachineStopCategory-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/MachineStopCategory/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopCategoryID,MachineStopCategory,Description,MachineStageTypeID,StopCategoryCode,DisplayOrder, 2 as "org_id"  FROM dbo.MachineStopCategory WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/MachineStopCategory/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopReason-Ingest-SPMM"/>
        <error to="MachineStopReason-Ingest-SPMM"/>
    </action>

    <action name="MachineStopReason-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/MachineStopReason/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonID,StopReason,Description,MachineStageTypeID,IsPlanned,StopCode,RfMachineStopClassID,RfLineStopReasonTypeID,MachineStopCategoryID,IsRetired, 2 as "org_id"  FROM dbo.MachineStopReason WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/MachineStopReason/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Operation-Ingest-SPMM"/>
        <error to="Operation-Ingest-SPMM"/>
    </action>

    <action name="Operation-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Operation/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OperationID,OperationTypeID,MachineStageID,JobID, 2 as "org_id"  FROM dbo.Operation WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Operation/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OperationType-Ingest-SPMM"/>
        <error to="OperationType-Ingest-SPMM"/>
    </action>

    <action name="OperationType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/OperationType/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OperationTypeID,OperationType,OperationTypeCode,Description,PartTypeID,Sequence,IsOptional, 2 as "org_id"  FROM dbo.OperationType WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/OperationType/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartClassification-Ingest-SPMM"/>
        <error to="PartClassification-Ingest-SPMM"/>
    </action>

    <action name="PartClassification-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/PartClassification/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartClassificationID,PartClassification,RfPartClassificationID, 2 as "org_id"  FROM dbo.PartClassification WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/PartClassification/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartSubClassification-Ingest-SPMM"/>
        <error to="PartSubClassification-Ingest-SPMM"/>
    </action>

    <action name="PartSubClassification-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/PartSubClassification/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartSubClassificationID,PartSubClassification,PartClassificationID, 2 as "org_id"  FROM dbo.PartSubClassification WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/PartSubClassification/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartType-Ingest-SPMM"/>
        <error to="PartType-Ingest-SPMM"/>
    </action>

    <action name="PartType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/PartType/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartTypeID,PartType,Description,PartTypeCode,Variant1TagListID,Variant2TagListID,Variant3TagListID,Variant4TagListID,Variant5TagListID,Variant6TagListID,Variant7TagListID,Variant8TagListID,Variant9TagListID,Variant10TagListID,Variant11TagListID,Variant12TagListID,Variant13TagListID,Variant14TagListID,Variant15TagListID,Variant16TagListID,Variant17TagListID,Variant18TagListID,Variant19TagListID,Variant20TagListID,RfInventoryAccountingModeID, 2 as "org_id"  FROM dbo.PartType WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/PartType/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ScrapReason-Ingest-SPMM"/>
        <error to="ScrapReason-Ingest-SPMM"/>
    </action>

    <action name="ScrapReason-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/ScrapReason/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ScrapReasonID,ScrapReason,Description,MachineStageTypeID,DefaultUnitID,IsRetired, 2 as "org_id"  FROM dbo.ScrapReason WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/ScrapReason/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Shift-Ingest-SPMM"/>
        <error to="Shift-Ingest-SPMM"/>
    </action>

    <action name="Shift-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Shift/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftID,ShiftTypeID,ShiftPatternID,FromDT,ToDT,Sequence, 2 as "org_id"  FROM dbo.Shift WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Shift/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftPattern-Ingest-SPMM"/>
        <error to="ShiftPattern-Ingest-SPMM"/>
    </action>

    <action name="ShiftPattern-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/ShiftPattern/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftPatternID,ShiftPattern,PatternDuration,IsPatternDirty,IsCustomPeriod, 2 as "org_id"  FROM dbo.ShiftPattern WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/ShiftPattern/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftType-Ingest-SPMM"/>
        <error to="ShiftType-Ingest-SPMM"/>
    </action>

    <action name="ShiftType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/ShiftType/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftTypeID,Name,Description,IsNonWorking, 2 as "org_id"  FROM dbo.ShiftType WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/ShiftType/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Supplier-Ingest-SPMM"/>
        <error to="Supplier-Ingest-SPMM"/>
    </action>

    <action name="Supplier-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Supplier/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SupplierID,Supplier,SupplierCode,AddressID, 2 as "org_id"  FROM dbo.Supplier WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Supplier/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagList-Ingest-SPMM"/>
        <error to="TagList-Ingest-SPMM"/>
    </action>

    <action name="TagList-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/TagList/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagListID,ListName,VariantNo, 2 as "org_id"  FROM dbo.TagList WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/TagList/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Unit-Ingest-SPMM"/>
        <error to="Unit-Ingest-SPMM"/>
    </action>

    <action name="Unit-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/Unit/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitID,Unit,Description, 2 as "org_id"  FROM dbo.Unit WHERE $CONDITIONS</arg>

            <arg>--num-mappers</arg>
            <arg>1</arg>

            <arg>--target-dir</arg>
            <arg>/MEStwo/Unit/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BuildRecordALL-Ingest-SPMM"/>
        <error to="BuildRecordALL-Ingest-SPMM"/>
    </action>

    <action name="BuildRecordALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/BuildRecordALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BuildRecord.BuildRecordID, BuildRecord.InvPackCreatedID, BuildRecord.InvPackConsumedID, BuildRecord.QuantityUsed, BuildRecord.UnitID, BuildRecord.BuildDT, BuildRecord.IsEdited, BuildRecord.RevisionNo, BuildRecord.BuildMachineStageID, BuildRecord_.Comments, BuildRecord_.LoginID, BuildRecord_.OpenedDT, BuildRecord_.SavedDT, BuildRecord_.EditedBuildRecordID, BuildRecord_.OriginalLoginID, BuildRecord_.Reference1, BuildRecord_.Reference2, BuildRecord_.Reference3, BuildRecord_.Reference4, BuildRecord_.Reference5,  2 as "org_id" FROM BuildRecord FULL JOIN BuildRecord_ ON (BuildRecord.BuildRecordID = BuildRecord_.BuildRecordID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>BuildRecord.BuildRecordID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/BuildRecordALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryLabelALL-Ingest-SPMM"/>
        <error to="InventoryLabelALL-Ingest-SPMM"/>
    </action>

    <action name="InventoryLabelALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/InventoryLabelALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryLabel.InventoryLabelID, InventoryLabel.MachineStage, InventoryLabel.PartNumber, InventoryLabel.PartType, InventoryLabel.QuantityOrdered, InventoryLabel.WONumber, InventoryLabel.InventoryPackNo, InventoryLabel.CreatedFromDT, InventoryLabel.Quantity, InventoryLabel.Unit, InventoryLabel.Line, InventoryLabel.LabelTemplate, InventoryLabel.LabelsPerInventoryPack, InventoryLabel.ItemsPerLayer, InventoryLabel.LayersPerInventoryPack, InventoryLabel.PrinterURL, InventoryLabel.PrintedDT, InventoryLabel.ItemsPerInventoryPack, InventoryLabel.ScannedDT, InventoryLabel.IsCancelled, InventoryLabel.OrderQuantityPacks, InventoryLabel.LineShortName, InventoryLabel.PackNo, InventoryLabel.IsReprint, InventoryLabel.PartDescription, InventoryLabel.LabelSaveDirectory, InventoryLabel.JobID, InventoryLabel.IsPrintLandscape, InventoryLabel.NoCopies, InventoryLabel_.LabelColour, InventoryLabel_.EANCode, InventoryLabel_.CusNum, InventoryLabel_.PackingCode, InventoryLabel_.CustomerPartNo, InventoryLabel_.CustomerPartDescription, InventoryLabel_.LabelText1, InventoryLabel_.LabelText2, InventoryLabel_.LabelText3, InventoryLabel_.Customer, InventoryLabel_.Address1, InventoryLabel_.Address2, InventoryLabel_.City, InventoryLabel_.County, InventoryLabel_.PostCode, InventoryLabel_.Country, InventoryLabel_custom.InventoryPackID,  2 as "org_id" FROM InventoryLabel FULL JOIN InventoryLabel_ ON (InventoryLabel.InventoryLabelID = InventoryLabel_.InventoryLabelID) FULL JOIN InventoryLabel_custom ON (InventoryLabel.InventoryLabelID = InventoryLabel_custom.InventoryLabelID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>InventoryLabel.InventoryLabelID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/InventoryLabelALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryPackALL-Ingest-SPMM"/>
        <error to="InventoryPackALL-Ingest-SPMM"/>
    </action>

    <action name="InventoryPackALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/InventoryPackALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryPack.InventoryPackID, InventoryPack.InventoryPackNo, InventoryPack.WOID, InventoryPack.JobID, InventoryPack.CreatedFromDT, InventoryPack.CreatedToDT, InventoryPack.CreatedOnMachineStageID, InventoryPack.IsEdited, InventoryPack.RevisionNo, InventoryPack.PartID, InventoryPack.Quantity, InventoryPack.UnitID, InventoryPack.Ignored, InventoryPack.InventoryPackIndex, InventoryPack.CustomerUniqueKey, InventoryPack.ReceivedDT, InventoryPack.BirthDT, InventoryPack.LastBuildRecordID, InventoryPack.msrepl_tran_version, InventoryPack.CurrentQuantity, InventoryPack.QuantityAdjustment, InventoryPack.PositionNumber, InventoryPack.LocationID, InventoryPack.InvStateID, InventoryPack.LocationFromDT, InventoryPack_.Comments, InventoryPack_.LoginID, InventoryPack_.OpenedDT, InventoryPack_.SavedDT, InventoryPack_.OriginalLoginID, InventoryPack_.EditedInventoryPackID, InventoryPack_.Reference1, InventoryPack_.Reference2, InventoryPack_.Reference3, InventoryPack_.Reference4, InventoryPack_.Reference5, InventoryPack_.Reference6, InventoryPack_.Reference7, InventoryPack_.Reference8, InventoryPack_.Reference9, InventoryPack_.Reference10, InventoryPack_.SupplierID, InventoryPack_.SupplierReference, InventoryPack_.UseByDT, InventoryPack_.UseAfterDT, InventoryPack_Custom.Txn_date, InventoryPack_Custom.OracleStatus, InventoryPack_Custom.IntendedWOID, InventoryPack_Custom.FinalWOID, InventoryPack_Custom.OriginalQty, InventoryPack_Custom.Seq_Id, InventoryPack_Custom.From_Subinventory, InventoryPack_Custom.From_Locator, InventoryPack_Custom.To_Subinventory, InventoryPack_Custom.To_Locator, InventoryPack_Custom.ScrappedShiftID, InventoryPack_Custom.LastInventoryLabelID, InventoryPack_Custom.ScrapLocationID, InventoryPack_Custom.MachineLocationID, InventoryPack_Custom.ScrapReasonID, InventoryPack_Custom.ModuleInfoID, InventoryPack_Custom.ResealedDT,  2 as "org_id" FROM InventoryPack FULL JOIN InventoryPack_ ON (InventoryPack.InventoryPackID = InventoryPack_.InventoryPackID) FULL JOIN InventoryPack_Custom ON (InventoryPack.InventoryPackID = InventoryPack_Custom.InventoryPackId)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>InventoryPack.InventoryPackID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/InventoryPackALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="JobALL-Ingest-SPMM"/>
        <error to="JobALL-Ingest-SPMM"/>
    </action>

    <action name="JobALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/JobALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Job.JobID, Job.WOID, Job.RfJobStatusID, Job.DeadlineDT, Job.ActualStartDT, Job.ActualEndDT, Job.PlannedStartDT, Job.PlannedEndDT, Job.PlannedDuration, Job.EstimatedStartDT, Job.EstimatedEndDT, Job.EstimatedDuration, Job.ScheduledSequence, Job.LineID, Job.ProductionStartDT, Job.ProductionEndDT, Job.TheoreticalCycleTime, Job.BudgetChangeOver, Job.QuantityOrdered, Job.IsCalculated, Job.LineGroupID, Job_.JobInstructions, Job_.ReleaseDT, Job_.ReleaseLoginID, Job_.StartLoginID, Job_.EndLoginID, Job_.Comments, Job_.ModifiedDt, Job_.ModifiedLoginID, Job_.StoppedReason, Job_.SkippedReason, Job_.SkippedDT,  2 as "org_id" FROM Job FULL JOIN Job_ ON (Job.JobID = Job_.JobID) FULL JOIN Job_Custom ON (Job.JobID = Job_Custom.JobID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>Job.JobID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/JobALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineALL-Ingest-SPMM"/>
        <error to="LineALL-Ingest-SPMM"/>
    </action>

    <action name="LineALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/LineALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Line.LineID, Line.Line, Line.Description, Line.LineTypeID, Line.IsRetired, Line.RfIntervalModeID, Line.IsOEEInventoryIsolation, Line.IsOEEInventoryReintroduction, Line.IsCountOutputInventory, Line.IsCountInputInventory, Line.IsLineInfoSweepEnabled, Line.IsWOOnSingleJob, Line.LineShortName, Line.CurrentLineInfoID, Line.LastLineInfoID, Line.RfInvCreatedDateModeID, Line.RfEndJobInvModeID, Line.CurrentJobID, Line.IsScrapAsQualityLoss, Line.IsScrapInProductionCounts, Line.LineDownCostPerHour, Line.IsContributeLineGroupOutput, Line.IsContributeLineGroupWaste, Line.IsContributeLineGroupDowntime, Line_.OEETarget, Line_.WasteTarget, Line_.Reference1, Line_.Reference2, Line_.Reference3, Line_.Reference4, Line_.Reference5,  2 as "org_id" FROM Line FULL JOIN Line_ ON (Line.LineID = Line_.LineID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>Line.LineID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/LineALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LocationAll-Ingest-SPMM"/>
        <error to="LocationAll-Ingest-SPMM"/>
    </action>

    <action name="LocationAll-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/LocationAll/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Location.LocationID, Location.Location, Location.LocationTypeID, Location.IsRetired, Location.MaxQuantity, Location.LocationCode, Location.Description, LocationType.LocationType, LocationType.LocationTypeCode,  2 as "org_id" FROM Location FULL JOIN LocationType ON (Location.LocationID = LocationType.LocationTypeID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>Location.LocationID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/LocationAll/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageAll-Ingest-SPMM"/>
        <error to="MachineStageAll-Ingest-SPMM"/>
    </action>

    <action name="MachineStageAll-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/MachineStageAll/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStage.MachineStageID, MachineStage.MachineStageTypeID, MachineStage.Name, MachineStage.IsRetired, MachineStage.DepartmentID, MachineStage.Description, MachineStage.CurrentShiftPatternID, MachineStage.NoHeads, MachineStage.IsOEEBottleNeck, MachineStage.IsProductionOutput, MachineStage.MachineStopID, MachineStage.StoppedScreenThreshold, MachineStage.LineSectionID, MachineStage.IsDiscrete, MachineStage.RfDowntimeCollectionModeID, MachineStage.RfSpoilageCollectionModeID, MachineStage.RfProductionCollectionModeID, MachineStage.LastBuildRecordID, MachineStage.CurrentJobID, MachineStage_Custom.ModuleDatabase, MachineStage_Custom.IntendedWOID, MachineStage_Custom.MachineStageCode,  2 as "org_id" FROM MachineStage FULL JOIN MachineStage_Custom ON (MachineStage.MachineStageID = MachineStage_Custom.MachineStageID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>MachineStage.MachineStageID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/MachineStageAll/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopAll-Ingest-SPMM"/>
        <error to="MachineStopAll-Ingest-SPMM"/>
    </action>

    <action name="MachineStopAll-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/MachineStopAll/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStop.MachineStopID, MachineStop.MachineStopReasonID, MachineStop.FromDT, MachineStop.ToDT, MachineStop.MachineStageID, MachineStop.IsEdited, MachineStop.RevisionNo, MachineStop_.StopComments, MachineStop_.StartComments, MachineStop_.StartLoginID, MachineStop_.StopLoginID, MachineStop_.OpenedStopDT, MachineStop_.SavedStopDT, MachineStop_.OpenedStartDT, MachineStop_.SavedStartDT, MachineStop_.OriginalLoginID, MachineStop_.EditedMachineStopID,  2 as "org_id" FROM MachineStop FULL JOIN MachineStop_ ON (MachineStop.MachineStopID = MachineStop_.MachineStopID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>MachineStop.MachineStopID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/MachineStopAll/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartALL-Ingest-SPMM"/>
        <error to="PartALL-Ingest-SPMM"/>
    </action>

    <action name="PartALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/PartALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Part.PartID, Part.PartNumber, Part.Description, Part.IsRetired, Part.BaseUnitID, Part.PartTypeID, Part.Reference1, Part.Reference2, Part.Reference3, Part.Reference4, Part.Reference5, Part.Variant1, Part.Variant2, Part.Variant3, Part.Variant4, Part.Variant5, Part.Variant6, Part.Variant7, Part.Variant8, Part.Variant9, Part.Variant10, Part.Variant11, Part.Variant12, Part.Variant13, Part.Variant14, Part.Variant15, Part.Variant16, Part.Variant17, Part.Variant18, Part.Variant19, Part.Variant20, Part_.TheoreticalSpeed, Part_.LabelsPerInventoryPack, Part_.ItemsPerInventoryPack, Part_.ItemsPerLayer, Part_.LayersPerInventoryPack, Part_.PackingCode, Part_.LabelTemplate, Part_.ProductionInstructions, Part_.QualityInstructions, Part_.CustomerPartNo, Part_.CustomerPartDescription, Part_.LabelText1, Part_.LabelText2, Part_.LabelText3, Part_.UnitPrice1, Part_.UnitPrice2, Part_.LegacyPartNo, Part_.CreateDT, Part_.ModifiedDT, Part_.LoginID, Part_.PartRevisionNo, Part_.PartClassificationID, Part_.LastPurchaseCost, Part_.AveragePurchaseCost, Part_.StandardPurchaseCost, Part_.StandardManufactureCost, Part_.StandardSaleCost, Part_.PartSubClassificationID, Part_.CreatedInvUseByPeriod, Part_.CreatedInvUseAfterPeriod, Part_custom.Txn_date, Part_custom.Inventory_Item_Id, Part_custom.Item_Type_Description,  2 as "org_id" FROM Part FULL JOIN Part_ ON (Part.PartID = Part_.PartID) FULL JOIN Part_custom ON (Part.PartID = Part_custom.PartID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>Part.PartID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/PartALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WOALL-Ingest-SPMM"/>
        <error to="WOALL-Ingest-SPMM"/>
    </action>

    <action name="WOALL-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="/MEStwo/WOALL/2"/>
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WO.WOID, WO.WONumber, WO.RunNo, WO.PartID, WO.QuantityOrdered, WO.RfJobStatusID, WO.DeadlineDT, WO.ActualStartDT, WO.ActualEndDT, WO.PlannedStartDT, WO.PlannedEndDT, WO.EstimatedStartDT, WO.EstimatedEndDT, WO.CustomerID, WO.IsDiscrete, WO.Reference1, WO.Reference2, WO.Reference3, WO.Reference4, WO.Reference5, WO.WORefID, WO_.CustomerOrderNo, WO_.LabelsPerInventoryPack, WO_.ItemsPerInventoryPack, WO_.ItemsPerLayer, WO_.LayersPerInventoryPack, WO_.PackingCode, WO_.LabelTemplate, WO_.LabelColour, WO_.EANCode, WO_.CusStartNum, WO_.CusEndNum, WO_.CustomerPartNo, WO_.CustomerPartDescription, WO_.LabelText1, WO_.LabelText2, WO_.LabelText3, WO_.PrinterURL, WO_.BOMVariantID,  2 as "org_id" FROM WO FULL JOIN WO_ ON (WO.WOID = WO_.WOID)   WHERE $CONDITIONS</arg>
            <arg>--split-by</arg>
            <arg>WO.WOID</arg>
            <arg>--num-mappers</arg>
            <arg>8</arg>
            <arg>--target-dir</arg>
            <arg>/MEStwo/WOALL/2</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="EndOf-Ingest-SPMM"/>
        <error to="EndOf-Ingest-SPMM"/>
    </action>

	<end name="EndOf-Ingest-SPMM"/>
</workflow-app>

<workflow-app name="Ingest-Full-16" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SPML_ModuleInfo-Ingest-SPTM-Decision"/>


	<decision name="_SPML_ModuleInfo-Ingest-SPTM-Decision">
    	<switch>
			<case to="_SPML_ModuleInfo-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER__SPML_ModuleInfo_DoFull') eq 'true'}</case>
            <default to="AcquisitionDevice-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="_SPML_ModuleInfo-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER__SPML_ModuleInfo_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ModuleInfoID,SerialNo,LaminateID,LaminateCreatedDT,LaminateOrderNo,LaminatePartNo,BINNo,CktFormBuildPart,CktFormBuildMachine,CktFormBuildDT,GlassBuildPart,GlassBuildDate,LaminationBuildMachine,LaminationBuildDT,ModuleID,ModuleCreatedDT,ModuleOrderNo,IntendedModulePartNo,IntendedModulePartDesc,FramingBuildPart,FramingBuildMachine,FramingBuildDT,JboxBuildPart,JboxBuildDT,FlashtestClassifiedDT,FinalModulePartNo,FinalModulePartDesc,ActualPower,ActualVocMod,ActualFF,PackedDT,InventoryState,JboxBuildMachine,ActualIsc,FlashtestBuildMachine,Komax1,Komax2,Komax3,GlassID,CellType,StringerOperator,CircuitOperator1,CircuitOperator2,TrimChangeReason,PowerChartGenerated,LaminateWoId,ModuleWoId,VisualStateId,RfInvStateId,ElTestDate,ElBuildMachine,ActualVmpMod,ActualImpMod,TrimBuildMachine,TrimBuildDT,CellThickness,PalletID,FlashTestID,PadLock,BtoCtoSerialNo,EvaUseByDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo._SPML_ModuleInfo WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER__SPML_ModuleInfo_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionDevice-Ingest-SPTM-Decision"/>
        <error to="AcquisitionDevice-Ingest-SPTM-Decision"/>
    </action>

	<decision name="AcquisitionDevice-Ingest-SPTM-Decision">
    	<switch>
			<case to="AcquisitionDevice-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AcquisitionDevice_DoFull') eq 'true'}</case>
            <default to="ActionNote-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionDevice-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AcquisitionDevice_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionDeviceID,AcquisitionVariableTypeID,WorkstationConfigID,Instructions,ImageURI,RfSourceID,DataDeviceID,DeviceArgs,DeviceOutput,FillMode,Preset,Multiplier,PreprocessingFunction,IsManualTrigger,IsManualConfirm, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AcquisitionDevice WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AcquisitionDevice_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionNote-Ingest-SPTM-Decision"/>
        <error to="ActionNote-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ActionNote-Ingest-SPTM-Decision">
    	<switch>
			<case to="ActionNote-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ActionNote_DoFull') eq 'true'}</case>
            <default to="Asset-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ActionNote-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ActionNote_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionNoteID,ActionID,Note,Comments,NoteDT,LoginID,Reference1,Reference2,Reference3, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ActionNote WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ActionNote_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Asset-Ingest-SPTM-Decision"/>
        <error to="Asset-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Asset-Ingest-SPTM-Decision">
    	<switch>
			<case to="Asset-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Asset_DoFull') eq 'true'}</case>
            <default to="AttributeType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Asset-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Asset_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetID,AssetName,RfAssetTypeID,LineID,MachineStageID,ToolID,GaugeID,PartID,InventoryPackID,LocationID,IsRetired,CostCentreID,ManufacturerID,SupplierID,AcquiredDT,PONumber,OrderedDT,ExpectedDeliveryDT,ExpectedFirstUseDT,EndUseDT,EndUseReason,PurchaseCost,DefaultLocationID,Comments, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Asset WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Asset_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AttributeType-Ingest-SPTM-Decision"/>
        <error to="AttributeType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="AttributeType-Ingest-SPTM-Decision">
    	<switch>
			<case to="AttributeType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AttributeType_DoFull') eq 'true'}</case>
            <default to="BOMVariant-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AttributeType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AttributeType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeID,ProductTypeID,Name,Description,ImageURI,RfAttributeClassID,IsPassFail,IsRaiseCA,LikelyCauses,Impact,Weighting,Reference1,Reference2,Reference3,Reference4,Reference5,AttributeTypeCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AttributeType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AttributeType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BOMVariant-Ingest-SPTM-Decision"/>
        <error to="BOMVariant-Ingest-SPTM-Decision"/>
    </action>

	<decision name="BOMVariant-Ingest-SPTM-Decision">
    	<switch>
			<case to="BOMVariant-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_BOMVariant_DoFull') eq 'true'}</case>
            <default to="ConcernStatus-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="BOMVariant-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_BOMVariant_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BOMVariantID,BOMVariant,PartID,IsDefault,BOMVariantIndex,IsRetired,LoginID,DT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.BOMVariant WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_BOMVariant_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ConcernStatus-Ingest-SPTM-Decision"/>
        <error to="ConcernStatus-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ConcernStatus-Ingest-SPTM-Decision">
    	<switch>
			<case to="ConcernStatus-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ConcernStatus_DoFull') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ConcernStatus-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ConcernStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernStatusID,ConcernStatus,ConditionalFormat,IsClosedState, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ConcernStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ConcernStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPTM-Decision"/>
        <error to="DefectCount-Ingest-SPTM-Decision"/>
    </action>

	<decision name="DefectCount-Ingest-SPTM-Decision">
    	<switch>
			<case to="DefectCount-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_DefectCount_DoFull') eq 'true'}</case>
            <default to="EBATrigger-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="DefectCount-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_DefectCount_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_DefectCount_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="EBATrigger-Ingest-SPTM-Decision"/>
        <error to="EBATrigger-Ingest-SPTM-Decision"/>
    </action>

	<decision name="EBATrigger-Ingest-SPTM-Decision">
    	<switch>
			<case to="EBATrigger-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_EBATrigger_DoFull') eq 'true'}</case>
            <default to="IndividualDefect-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="EBATrigger-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_EBATrigger_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT EBATriggerID,RfTriggerTypeID,ContextDictionary,TriggerOwnerID,CreateDT,ProcessedDT,RfWatchProcessStateID,Message,TotalTime,OracleInsertTime,OracleConnectionTime,OracleInsertStatement, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.EBATrigger WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_EBATrigger_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="IndividualDefect-Ingest-SPTM-Decision"/>
        <error to="IndividualDefect-Ingest-SPTM-Decision"/>
    </action>

	<decision name="IndividualDefect-Ingest-SPTM-Decision">
    	<switch>
			<case to="IndividualDefect-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_IndividualDefect_DoFull') eq 'true'}</case>
            <default to="LineCell-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="IndividualDefect-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_IndividualDefect_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT IndividualDefectID,PartInstanceID,Ignored,DefectCount,MeasurementSetID,AttributeTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.IndividualDefect WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_IndividualDefect_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineCell-Ingest-SPTT-Decision"/>
        <error to="LineCell-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LineCell-Ingest-SPTT-Decision">
    	<switch>
			<case to="LineCell-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LineCell_DoFull') eq 'true'}</case>
            <default to="LineType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LineCell-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LineCell_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineCellID,LineID,IsPartNumber,IsWONumber,IsCustomer,IsDescription,IsHeader,IsRows,ConfigLayout,IsClickable,IsStopJob,IsStartJob,IsEditable,IsStartNextJob,IsWORef1,IsWORef2,IsWORef3,IsWorkInstruction, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LineCell WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LineCell_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineType-Ingest-SPTM-Decision"/>
        <error to="LineType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LineType-Ingest-SPTM-Decision">
    	<switch>
			<case to="LineType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LineType_DoFull') eq 'true'}</case>
            <default to="LkConcernDocument-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LineType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LineType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineTypeID,LineType,Description,IsRetired,LineInfoPrecedence,BudgetChangeOver,BudgetEfficiency, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LineType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LineType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkConcernDocument-Ingest-SPTM-Decision"/>
        <error to="LkConcernDocument-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkConcernDocument-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkConcernDocument-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkConcernDocument_DoFull') eq 'true'}</case>
            <default to="LkDocumentInvPack-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkConcernDocument-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkConcernDocument_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernID,DocumentID,LKConcernDocumentID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkConcernDocument WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkConcernDocument_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentInvPack-Ingest-SPTM-Decision"/>
        <error to="LkDocumentInvPack-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkDocumentInvPack-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkDocumentInvPack-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkDocumentInvPack_DoFull') eq 'true'}</case>
            <default to="LkLineLineGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentInvPack-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkDocumentInvPack_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentInvPackID,DocumentID,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkDocumentInvPack WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkDocumentInvPack_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkLineLineGroup-Ingest-SPTM-Decision"/>
        <error to="LkLineLineGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkLineLineGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkLineLineGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkLineLineGroup_DoFull') eq 'true'}</case>
            <default to="LkMPGMP-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkLineLineGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkLineLineGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkLineLineGroupID,LineGroupID,LineID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkLineLineGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkLineLineGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMPGMP-Ingest-SPTM-Decision"/>
        <error to="LkMPGMP-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkMPGMP-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkMPGMP-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkMPGMP_DoFull') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkMPGMP-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkMPGMP_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkMPGMPID,MaintenanceProcedureGroupID,MaintenanceProcedureID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkMPGMP WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkMPGMP_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPTM-Decision"/>
        <error to="LkPartLineSection-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkPartLineSection-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkPartLineSection_DoFull') eq 'true'}</case>
            <default to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartLineSection-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkPartLineSection_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkPartLineSection_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision"/>
        <error to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision">
    	<switch>
			<case to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFull') eq 'true'}</case>
            <default to="LkVCOCVRule-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RfSPCStatID,SPCStatsStyleID,LkSPCStatsStyleRfSPCStatID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LKSPCStatsStyleRfSPCStat_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkVCOCVRule-Ingest-SPTM-Decision"/>
        <error to="LkVCOCVRule-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkVCOCVRule-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkVCOCVRule-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkVCOCVRule_DoFull') eq 'true'}</case>
            <default to="MachineStageEvent-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkVCOCVRule-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkVCOCVRule_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarChartOCID,RfViolationRuleID,LkVCOCVRuleID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkVCOCVRule WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkVCOCVRule_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageEvent-Ingest-SPTM-Decision"/>
        <error to="MachineStageEvent-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStageEvent-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStageEvent-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStageEvent_DoFull') eq 'true'}</case>
            <default to="MachineStopReasonGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageEvent-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStageEvent_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageEventID,LoginID,DT,MachineStageID,MachineStageEventTypeID,Comments, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStageEvent WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStageEvent_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopReasonGroup-Ingest-SPTM-Decision"/>
        <error to="MachineStopReasonGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStopReasonGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStopReasonGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStopReasonGroup_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedureGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStopReasonGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStopReasonGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonGroupID,MachineStopReasonGroup,Description,MachineStopReasonGroupCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStopReasonGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStopReasonGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedureGroup-Ingest-SPTM-Decision"/>
        <error to="MaintenanceProcedureGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceProcedureGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceProcedureGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceProcedureGroup_DoFull') eq 'true'}</case>
            <default to="MaintenanceWork_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedureGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceProcedureGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureGroupID,MaintenanceProcedureGroup,Description, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceProcedureGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceProcedureGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWork_-Ingest-SPTM-Decision"/>
        <error to="MaintenanceWork_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceWork_-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceWork_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceWork__DoFull') eq 'true'}</case>
            <default to="MeasurementSetRequired-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWork_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceWork__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkID,WorkDone,Comments,LoginID,ModifiedDT,Reference1,Reference2,Reference3,Reference4,Reference5, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceWork_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceWork__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSetRequired-Ingest-SPTM-Decision"/>
        <error to="MeasurementSetRequired-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MeasurementSetRequired-Ingest-SPTM-Decision">
    	<switch>
			<case to="MeasurementSetRequired-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MeasurementSetRequired_DoFull') eq 'true'}</case>
            <default to="OPCDigital-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MeasurementSetRequired-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MeasurementSetRequired_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetRequiredID,EBATriggerID,AcquisitionContextID,MeasurementSetID,RfAcquisitionStatusID,SubmittedDT,DueDT,DeadlineDT,ExpiryDT,OwnerID,ActionID,JobID,PartID,AssignedLoginID,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MeasurementSetRequired WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MeasurementSetRequired_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCDigital-Ingest-SPTM-Decision"/>
        <error to="OPCDigital-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCDigital-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCDigital-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCDigital_DoFull') eq 'true'}</case>
            <default to="OPCParameter-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCDigital-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCDigital_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCDigitalID,OPCItemID,Description,Formula,VariableTypeID,HeadNo,SampleNo,PositionNo,ModifiedDT,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCDigital WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCDigital_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCParameter-Ingest-SPTM-Decision"/>
        <error to="OPCParameter-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCParameter-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCParameter-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCParameter_DoFull') eq 'true'}</case>
            <default to="PartClassification-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCParameter-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCParameter_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCParameterID,OPCItemID,Description,Scale,Offset,Formula,VariableTypeID,HeadNo,SampleNo,PositionNo,ModifiedDT,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCParameter WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCParameter_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartClassification-Ingest-SPTM-Decision"/>
        <error to="PartClassification-Ingest-SPTM-Decision"/>
    </action>

	<decision name="PartClassification-Ingest-SPTM-Decision">
    	<switch>
			<case to="PartClassification-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_PartClassification_DoFull') eq 'true'}</case>
            <default to="ProductionStop-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="PartClassification-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_PartClassification_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartClassificationID,PartClassification,RfPartClassificationID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.PartClassification WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_PartClassification_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductionStop-Ingest-SPTM-Decision"/>
        <error to="ProductionStop-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ProductionStop-Ingest-SPTM-Decision">
    	<switch>
			<case to="ProductionStop-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ProductionStop_DoFull') eq 'true'}</case>
            <default to="Scrap-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ProductionStop-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ProductionStop_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductionStopID,ProductionStopReasonID,JobID,FromDT,ToDT,LineID,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ProductionStop WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ProductionStop_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Scrap-Ingest-SPTM-Decision"/>
        <error to="Scrap-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Scrap-Ingest-SPTM-Decision">
    	<switch>
			<case to="Scrap-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Scrap_DoFull') eq 'true'}</case>
            <default to="SettingsPlantTimeWindows-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Scrap-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Scrap_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ScrapID,ScrapReasonID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Scrap WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Scrap_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SettingsPlantTimeWindows-Ingest-SPTM-Decision"/>
        <error to="SettingsPlantTimeWindows-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SettingsPlantTimeWindows-Ingest-SPTM-Decision">
    	<switch>
			<case to="SettingsPlantTimeWindows-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SettingsPlantTimeWindows_DoFull') eq 'true'}</case>
            <default to="SPCCalcStyle_CUS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SettingsPlantTimeWindows-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SettingsPlantTimeWindows_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SettingsPlantTimeWindowsID,JobHistory,ProductionSpoilageHistory,DowntimeHistory,InventoryHistory,InventoryLabelHistory,BuildRecordHistory,LineInfoHistory,QualityMeasurementHistory,ProcessParameterHistory,OPCItemHistoryHistory,InitialLineInfoHistory,MaintenanceProjectionPeriod,ShiftLookAheadDays,ForwardSchedulingWindow,DefaultMaxTrendRecallWindow,DefaultConcernDuePeriod, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SettingsPlantTimeWindows WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SettingsPlantTimeWindows_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCCalcStyle_CUS-Ingest-SPTM-Decision"/>
        <error to="SPCCalcStyle_CUS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCCalcStyle_CUS-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCCalcStyle_CUS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCCalcStyle_CUS_DoFull') eq 'true'}</case>
            <default to="SPCChartSetViewStyle_CUS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCCalcStyle_CUS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCCalcStyle_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCCalcStyleID,SPCCalcStyle,CmThreshold,CpThreshold,PpThreshold,CgThreshold,RnRThreshold,IsShowCpOnlyIfStable,CAMTarget,CpBasedOnID,CLBasedOnID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCCalcStyle_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCCalcStyle_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartSetViewStyle_CUS-Ingest-SPTM-Decision"/>
        <error to="SPCChartSetViewStyle_CUS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCChartSetViewStyle_CUS-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCChartSetViewStyle_CUS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCChartSetViewStyle_CUS_DoFull') eq 'true'}</case>
            <default to="Supplier-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartSetViewStyle_CUS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCChartSetViewStyle_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetViewStyleID,SPCChartSetViewStyle,IsSpecLimits,IsControlLimitZones,IsGrid,IsTimescaled,IsHAxis,IsVAxis,IsXChart,IsRsChart,IsRsWChart,IsDistribution,IsShowComments,IsXScatter,IsIncludeIgnored,IsOnlyOSOCCharts,SPCStatsStyleID,IsVerticalOverview,OverviewWidth,OverviewHeight,PageBreakRfCutByIDs,ChartWidth,ChartHeight,IsFixedScale,IsParetoCurve,IsLegend,IsHorizontalDistribution,IsSigmaLines,IsShowCAComments,IsShowUnAckAlarms,HorizontalOffset,IsShowLimitLabels,IsColourZones,IsSystem,IsOSHotCold,FixedScaleOverscaling,IsConstantTitleRow,IsShowStatCategories,IsOverlayEnvelope,IsGradientBackground,RunChartFont,DistributionFont,StatisticsFont,VAxisFont,HAxisFont,OverlayKeyFont,IsShowOverlayKey, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCChartSetViewStyle_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCChartSetViewStyle_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Supplier-Ingest-SPTM-Decision"/>
        <error to="Supplier-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Supplier-Ingest-SPTM-Decision">
    	<switch>
			<case to="Supplier-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Supplier_DoFull') eq 'true'}</case>
            <default to="TagMS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Supplier-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Supplier_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SupplierID,Supplier,SupplierCode,AddressID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Supplier WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Supplier_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagMS-Ingest-SPTM-Decision"/>
        <error to="TagMS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagMS-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagMS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagMS_DoFull') eq 'true'}</case>
            <default to="TagType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagMS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagMS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagMSID,MeasurementSetID,TagTypeID,TagValue,DT,TagTreeNodeID,X,Y, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagMS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagMS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagType-Ingest-SPTM-Decision"/>
        <error to="TagType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagType-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagType_DoFull') eq 'true'}</case>
            <default to="Tool_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagTypeID,RfDataTypeID,Name,TagTypeCode,ISSYSTEM,TAGVIEW, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool_-Ingest-SPTM-Decision"/>
        <error to="Tool_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Tool_-Ingest-SPTM-Decision">
    	<switch>
			<case to="Tool_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Tool__DoFull') eq 'true'}</case>
            <default to="ToolGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Tool_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Tool__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID,Supplier,Reference1,Reference2,Reference3,Reference4,Reference5,Ident, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Tool_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Tool__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolGroup-Ingest-SPTM-Decision"/>
        <error to="ToolGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolGroup_DoFull') eq 'true'}</case>
            <default to="UnitConversion-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolGroupID,ToolGroup,Description,ToolGroupCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitConversion-Ingest-SPTM-Decision"/>
        <error to="UnitConversion-Ingest-SPTM-Decision"/>
    </action>

	<decision name="UnitConversion-Ingest-SPTM-Decision">
    	<switch>
			<case to="UnitConversion-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_UnitConversion_DoFull') eq 'true'}</case>
            <default to="Variable-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="UnitConversion-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitConversion_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FromUnitID,ToUnitID,Multiplier,UnitConversionID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitConversion WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitConversion_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Variable-Ingest-SPTM-Decision"/>
        <error to="Variable-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Variable-Ingest-SPTM-Decision">
    	<switch>
			<case to="Variable-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Variable_DoFull') eq 'true'}</case>
            <default to="WO-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Variable-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Variable_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableID,VariableTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Variable WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Variable_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO-Ingest-SPTM-Decision"/>
        <error to="WO-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WO-Ingest-SPTM-Decision">
    	<switch>
			<case to="WO-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WO_DoFull') eq 'true'}</case>
            <default to="WorkInstructionStep-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="WO-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WO_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WOID,WONumber,RunNo,PartID,QuantityOrdered,RfJobStatusID,DeadlineDT,ActualStartDT,ActualEndDT,PlannedStartDT,PlannedEndDT,EstimatedStartDT,EstimatedEndDT,CustomerID,IsDiscrete,Reference1,Reference2,Reference3,Reference4,Reference5,WORefID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WO WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WO_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WorkInstructionStep-Ingest-SPTM-Decision"/>
        <error to="WorkInstructionStep-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WorkInstructionStep-Ingest-SPTM-Decision">
    	<switch>
			<case to="WorkInstructionStep-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WorkInstructionStep_DoFull') eq 'true'}</case>
            <default to="Part-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="WorkInstructionStep-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WorkInstructionStep_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WorkInstructionStepID,WorkInstructionStep,WorkInstructionProcedureID,OperationTypeID,StepOrder,RfSpecialActionTypeID,AcquisitionVariantID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WorkInstructionStep WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WorkInstructionStep_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Part-Ingest-SPMM-Decision"/>
        <error to="Part-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Part-Ingest-SPMM-Decision">
    	<switch>
			<case to="Part-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Part_DoFull') eq 'true'}</case>
            <default to="End-Full-16-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="Part-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Part_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Part.PartID, Part.PartNumber, Part.Description, Part.IsRetired, Part.BaseUnitID, Part.PartTypeID, Part.Reference1, Part.Reference2, Part.Reference3, Part.Reference4, Part.Reference5, Part.Variant1, Part.Variant2, Part.Variant3, Part.Variant4, Part.Variant5, Part.Variant6, Part.Variant7, Part.Variant8, Part.Variant9, Part.Variant10, Part.Variant11, Part.Variant12, Part.Variant13, Part.Variant14, Part.Variant15, Part.Variant16, Part.Variant17, Part.Variant18, Part.Variant19, Part.Variant20, Part_.TheoreticalSpeed, Part_.LabelsPerInventoryPack, Part_.ItemsPerInventoryPack, Part_.ItemsPerLayer, Part_.LayersPerInventoryPack, Part_.PackingCode, Part_.LabelTemplate, Part_.ProductionInstructions, Part_.QualityInstructions, Part_.CustomerPartNo, Part_.CustomerPartDescription, Part_.LabelText1, Part_.LabelText2, Part_.LabelText3, Part_.UnitPrice1, Part_.UnitPrice2, Part_.LegacyPartNo, Part_.CreateDT, Part_.ModifiedDT, Part_.LoginID, Part_.PartRevisionNo, Part_.PartClassificationID, Part_.LastPurchaseCost, Part_.AveragePurchaseCost, Part_.StandardPurchaseCost, Part_.StandardManufactureCost, Part_.StandardSaleCost, Part_.PartSubClassificationID, Part_.CreatedInvUseByPeriod, Part_.CreatedInvUseAfterPeriod, Part_custom.Txn_date, Part_custom.Inventory_Item_Id, Part_custom.Item_Type_Description,  2 as "org_id",  'SPMM' as "org_name" , (CASE WHEN Part.PartTypeID = 58 then '1' WHEN Part.parttypeid in (39, 63) and (Part.Description like '%T5%' COLLATE Latin1_General_BIN or variant1 = 'T5') THEN '96' WHEN Part.PartTypeID = 40 THEN SUBSTRING(SUBSTRING(Description,(PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)+1), (len(Part.description)-PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)) ) , 1,(PATINDEX('%[WB]%',SUBSTRING(Part.Description,(PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)+1), (len(Part.description)-PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)) ))) -1 ) ELSE Part.variant1 END) as "Cell_Count" , (CASE WHEN Part.parttypeid in (39, 63) then case when Part.description like '%COM%' COLLATE Latin1_General_BIN THEN 'Commercial' ELSE 'Residential' END else 'NA' end) as "Demand_Category" , (CASE WHEN Part.Parttypeid = 58 then variant8 when Part.parttypeid in (39, 40, 63) then case when Part.description like '%E60%' COLLATE Latin1_General_BIN or Part.Description like '%X20%' COLLATE Latin1_General_BIN or Part.description like '%X21%' COLLATE Latin1_General_BIN then 'GEN E160' else 'GEN C160' end else 'NA' end) as "Series"  FROM Part FULL JOIN Part_ ON (Part.PartID = Part_.PartID) FULL JOIN Part_custom ON (Part.PartID = Part_custom.PartID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Part_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-16-Ingest-Decision"/>
        <error to="End-Full-16-Ingest-Decision"/>
    </action>

	<end name="End-Full-16-Ingest-Decision"/>
</workflow-app>

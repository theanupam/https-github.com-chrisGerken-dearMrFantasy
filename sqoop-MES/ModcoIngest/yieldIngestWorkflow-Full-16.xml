<workflow-app name="Ingest-Full-16" xmlns="uri:oozie:workflow:0.1">

 	<start to="AcqCtxVarClass-Ingest-SPTT-Decision"/>


	<decision name="AcqCtxVarClass-Ingest-SPTT-Decision">
    	<switch>
			<case to="AcqCtxVarClass-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AcqCtxVarClass_DoFull') eq 'true'}</case>
            <default to="AcquisitionGroup-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AcqCtxVarClass-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AcqCtxVarClass_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcqCtxVarClassID,AcquisitionContextID,VariableTypeClassID,IsOS,IsOC, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AcqCtxVarClass WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AcqCtxVarClass_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionGroup-Ingest-SPTT-Decision"/>
        <error to="AcquisitionGroup-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AcquisitionGroup-Ingest-SPTT-Decision">
    	<switch>
			<case to="AcquisitionGroup-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AcquisitionGroup_DoFull') eq 'true'}</case>
            <default to="ActionPlan-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionGroup-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AcquisitionGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionGroupID,AcquisitionGroup,Description,AcquisitionGroupCode,LoginID,ModifiedDT, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AcquisitionGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AcquisitionGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionPlan-Ingest-SPTT-Decision"/>
        <error to="ActionPlan-Ingest-SPTT-Decision"/>
    </action>

	<decision name="ActionPlan-Ingest-SPTT-Decision">
    	<switch>
			<case to="ActionPlan-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_ActionPlan_DoFull') eq 'true'}</case>
            <default to="AssetCountType-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="ActionPlan-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_ActionPlan_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionPlanID,RfSpecialActionTypeID,ActionTypeID,ActionSubTypeID,ActionPlanCode,ActionName,Description,ActionPlanOrder,RfPriorityID,IsRetired,VariableTypeID,AttributeTypeID,IsCompulsory,SortOrder,IsOCApplicable,IsOSApplicable, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.ActionPlan WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_ActionPlan_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AssetCountType-Ingest-SPTT-Decision"/>
        <error to="AssetCountType-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AssetCountType-Ingest-SPTT-Decision">
    	<switch>
			<case to="AssetCountType-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AssetCountType_DoFull') eq 'true'}</case>
            <default to="AttributeTypeGroup-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AssetCountType-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AssetCountType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetCountTypeID,AssetCountType,Description, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AssetCountType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AssetCountType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AttributeTypeGroup-Ingest-SPTT-Decision"/>
        <error to="AttributeTypeGroup-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AttributeTypeGroup-Ingest-SPTT-Decision">
    	<switch>
			<case to="AttributeTypeGroup-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AttributeTypeGroup_DoFull') eq 'true'}</case>
            <default to="CauseAction-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AttributeTypeGroup-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AttributeTypeGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeGroupID,Name,Description,AttributeTypeGroupCode, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AttributeTypeGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AttributeTypeGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="CauseAction-Ingest-SPTT-Decision"/>
        <error to="CauseAction-Ingest-SPTT-Decision"/>
    </action>

	<decision name="CauseAction-Ingest-SPTT-Decision">
    	<switch>
			<case to="CauseAction-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_CauseAction_DoFull') eq 'true'}</case>
            <default to="ConcernType-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="CauseAction-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_CauseAction_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CauseActionID,MeasurementSetID,IsAttributes,IndividualDefectID,AttributeTypeID,Cause,Action,DT,VarChartOCID,RfIsOSID,VarMeasurementID,VariableTypeID,IsEdited,RevisionNo,ProductID,AcquisitionID,MachineStageID,RfAttributeClassID,HeadNo,SampleNo,PositionNo,RfAcquisitionClassID,SPCChartComponentID,SPCRuleID,RfCauseActionStateID,TAGMSVALUE1,TAGMSTYPE1ID,CreateDT,AcknowledgeDT,CloseDT, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.CauseAction WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_CauseAction_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ConcernType-Ingest-SPTT-Decision"/>
        <error to="ConcernType-Ingest-SPTT-Decision"/>
    </action>

	<decision name="ConcernType-Ingest-SPTT-Decision">
    	<switch>
			<case to="ConcernType-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_ConcernType_DoFull') eq 'true'}</case>
            <default to="Department-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ConcernType-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_ConcernType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernTypeID,ConcernType,Description,ConcernTypeCode,Format, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.ConcernType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_ConcernType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Department-Ingest-SPMM-Decision"/>
        <error to="Department-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Department-Ingest-SPMM-Decision">
    	<switch>
			<case to="Department-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Department_DoFull') eq 'true'}</case>
            <default to="FaultStatus-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Department-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Department_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DepartmentID,Name,DepartmentGroup,Classification1,PlantID,DepartmentCode,Description, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.Department WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Department_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="FaultStatus-Ingest-SPMM-Decision"/>
        <error to="FaultStatus-Ingest-SPMM-Decision"/>
    </action>

	<decision name="FaultStatus-Ingest-SPMM-Decision">
    	<switch>
			<case to="FaultStatus-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_FaultStatus_DoFull') eq 'true'}</case>
            <default to="InvIsolatedReason-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="FaultStatus-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_FaultStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FaultStatusID,FaultStatus,Description,RfFaultStatusID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.FaultStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_FaultStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvIsolatedReason-Ingest-SPTT-Decision"/>
        <error to="InvIsolatedReason-Ingest-SPTT-Decision"/>
    </action>

	<decision name="InvIsolatedReason-Ingest-SPTT-Decision">
    	<switch>
			<case to="InvIsolatedReason-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_InvIsolatedReason_DoFull') eq 'true'}</case>
            <default to="LineType-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="InvIsolatedReason-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InvIsolatedReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvIsolatedReasonID,PartTypeID,IsolatedReason,InvStateID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.InvIsolatedReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InvIsolatedReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineType-Ingest-SPMM-Decision"/>
        <error to="LineType-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LineType-Ingest-SPMM-Decision">
    	<switch>
			<case to="LineType-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LineType_DoFull') eq 'true'}</case>
            <default to="LkConcernDocument-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LineType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LineType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineTypeID,LineType,Description,IsRetired,LineInfoPrecedence,BudgetChangeOver,BudgetEfficiency, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LineType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LineType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkConcernDocument-Ingest-SPMM-Decision"/>
        <error to="LkConcernDocument-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkConcernDocument-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkConcernDocument-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkConcernDocument_DoFull') eq 'true'}</case>
            <default to="LkDocumentInvPack-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkConcernDocument-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkConcernDocument_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernID,DocumentID,LKConcernDocumentID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkConcernDocument WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkConcernDocument_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentInvPack-Ingest-SPMM-Decision"/>
        <error to="LkDocumentInvPack-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkDocumentInvPack-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkDocumentInvPack-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkDocumentInvPack_DoFull') eq 'true'}</case>
            <default to="LkLineLineGroup-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentInvPack-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkDocumentInvPack_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentInvPackID,DocumentID,InventoryPackID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkDocumentInvPack WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkDocumentInvPack_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkLineLineGroup-Ingest-SPTT-Decision"/>
        <error to="LkLineLineGroup-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkLineLineGroup-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkLineLineGroup-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkLineLineGroup_DoFull') eq 'true'}</case>
            <default to="LkMPGMP-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkLineLineGroup-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkLineLineGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkLineLineGroupID,LineGroupID,LineID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkLineLineGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkLineLineGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMPGMP-Ingest-SPTT-Decision"/>
        <error to="LkMPGMP-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkMPGMP-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkMPGMP-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkMPGMP_DoFull') eq 'true'}</case>
            <default to="LkPartSupplier-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="LkMPGMP-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkMPGMP_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkMPGMPID,MaintenanceProcedureGroupID,MaintenanceProcedureID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkMPGMP WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkMPGMP_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartSupplier-Ingest-SPMX-Decision"/>
        <error to="LkPartSupplier-Ingest-SPMX-Decision"/>
    </action>

	<decision name="LkPartSupplier-Ingest-SPMX-Decision">
    	<switch>
			<case to="LkPartSupplier-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_LkPartSupplier_DoFull') eq 'true'}</case>
            <default to="LkSRGSR-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartSupplier-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkPartSupplier_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartSupplierID,PartID,SupplierID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkPartSupplier WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkPartSupplier_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkSRGSR-Ingest-SPTM-Decision"/>
        <error to="LkSRGSR-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkSRGSR-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkSRGSR-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkSRGSR_DoFull') eq 'true'}</case>
            <default to="LkVTVTG-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkSRGSR-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkSRGSR_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkSRGSRID,ScrapReasonGroupID,ScrapReasonID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkSRGSR WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkSRGSR_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkVTVTG-Ingest-SPTM-Decision"/>
        <error to="LkVTVTG-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkVTVTG-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkVTVTG-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkVTVTG_DoFull') eq 'true'}</case>
            <default to="MachineStageEventType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkVTVTG-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkVTVTG_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeGroupID,VariableTypeID,LkVTVTGID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkVTVTG WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkVTVTG_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageEventType-Ingest-SPTM-Decision"/>
        <error to="MachineStageEventType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStageEventType-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStageEventType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStageEventType_DoFull') eq 'true'}</case>
            <default to="MaintenanceManHourPlanned-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageEventType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStageEventType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageEventTypeID,MachineStageEventType,Description,MachineStageTypeID,MachineStageEventTypeCode,IsAlarm,AlarmText, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStageEventType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStageEventType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceManHourPlanned-Ingest-SPTM-Decision"/>
        <error to="MaintenanceManHourPlanned-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceManHourPlanned-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceManHourPlanned-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceManHourPlanned_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedureResult-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceManHourPlanned-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceManHourPlanned_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceManHourPlannedID,MaintenanceProcedureID,PlannedManHours,PersonnelGroupID,SupplierID,SupplierCost, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceManHourPlanned WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceManHourPlanned_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedureResult-Ingest-SPTM-Decision"/>
        <error to="MaintenanceProcedureResult-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceProcedureResult-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceProcedureResult-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceProcedureResult_DoFull') eq 'true'}</case>
            <default to="MaintenanceWorkStatus-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedureResult-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceProcedureResult_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureResultID,MaintenanceProcedureStepID,MaintenanceWorkID,Result,ResultPassFail,Comments,DT,CheckedByLoginID,MaintenanceProcedureStep,StepOrder,SubPartID,Component,RfMaintenanceCheckTypeID,RfSpecialActionTypeID,Test,USL,LSL,PersonnelGroupID,SupplierID,Nom,Units,DecPlaces, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceProcedureResult WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceProcedureResult_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWorkStatus-Ingest-SPTM-Decision"/>
        <error to="MaintenanceWorkStatus-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceWorkStatus-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceWorkStatus-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceWorkStatus_DoFull') eq 'true'}</case>
            <default to="OPCClient-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWorkStatus-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceWorkStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkStatusID,MaintenanceWorkStatus,Description,RfMaintenanceWorkStatusID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceWorkStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceWorkStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCClient-Ingest-SPTM-Decision"/>
        <error to="OPCClient-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCClient-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCClient-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCClient_DoFull') eq 'true'}</case>
            <default to="OPCItemHistory-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCClient-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCClient_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCClientID,OPCClient,ComputerID,ModifiedDT,LastUpdateDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCClient WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCClient_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCItemHistory-Ingest-SPTM-Decision"/>
        <error to="OPCItemHistory-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCItemHistory-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCItemHistory-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCItemHistory_DoFull') eq 'true'}</case>
            <default to="OPCText-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCItemHistory-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCItemHistory_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCItemHistoryID,OPCItemID,UpdatedDT,RawValue,Value,Quality,CommittedDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCItemHistory WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCItemHistory_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCText-Ingest-SPTM-Decision"/>
        <error to="OPCText-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCText-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCText-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCText_DoFull') eq 'true'}</case>
            <default to="Product-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="OPCText-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCText_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCTextID,OPCItemID,Description,ModifiedDT,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCText WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCText_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Product-Ingest-SPMX-Decision"/>
        <error to="Product-Ingest-SPMX-Decision"/>
    </action>

	<decision name="Product-Ingest-SPMX-Decision">
    	<switch>
			<case to="Product-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Product_DoFull') eq 'true'}</case>
            <default to="RootCauseType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Product-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Product_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductID,ProductTypeID,Name,Description,IsRetired,PartID,Variant1,Variant2,Variant3,Variant4,Variant5,Variant6,Variant7,Variant8,Variant9,Variant10,Variant11,Variant12,Variant13,Variant14,Variant15,Variant16,Variant17,Variant18,Variant19,Variant20, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Product WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Product_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="RootCauseType-Ingest-SPTM-Decision"/>
        <error to="RootCauseType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="RootCauseType-Ingest-SPTM-Decision">
    	<switch>
			<case to="RootCauseType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_RootCauseType_DoFull') eq 'true'}</case>
            <default to="SettingsPlantNameTemplates-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="RootCauseType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_RootCauseType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RootCauseTypeID,RootCauseType,Description,RootCauseTypeCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.RootCauseType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_RootCauseType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SettingsPlantNameTemplates-Ingest-SPTM-Decision"/>
        <error to="SettingsPlantNameTemplates-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SettingsPlantNameTemplates-Ingest-SPTM-Decision">
    	<switch>
			<case to="SettingsPlantNameTemplates-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SettingsPlantNameTemplates_DoFull') eq 'true'}</case>
            <default to="ShiftType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SettingsPlantNameTemplates-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SettingsPlantNameTemplates_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SettingsPlantNameTemplatesID,CreateInvPackNoTemplate,CustomerUniqueKeyTemplate,InventoryPackNameTemplate,WONumberTemplate,ReceiveInvPackNoTemplate,BOMVariantTemplate, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SettingsPlantNameTemplates WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SettingsPlantNameTemplates_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftType-Ingest-SPTM-Decision"/>
        <error to="ShiftType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ShiftType-Ingest-SPTM-Decision">
    	<switch>
			<case to="ShiftType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ShiftType_DoFull') eq 'true'}</case>
            <default to="SPCChartSetView-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ShiftType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ShiftType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftTypeID,Name,Description,IsNonWorking, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ShiftType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ShiftType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartSetView-Ingest-SPTM-Decision"/>
        <error to="SPCChartSetView-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCChartSetView-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCChartSetView-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCChartSetView_DoFull') eq 'true'}</case>
            <default to="SPCVarChart-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartSetView-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCChartSetView_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetViewID,SPCChartSetView,Sequence,SPCChartSetID,RfChartSetViewTypeID,NoCols,NoRows,Caption,Tooltip,IsAggregated,RfCutByIDs,IsPanelled,ImageURI,GridImageRender,ParetoXAxis,ParetoStackBy,SPCChartSetViewStyleID,IsAutoFit,OverlayFlags, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCChartSetView WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCChartSetView_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCVarChart-Ingest-SPTM-Decision"/>
        <error to="SPCVarChart-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCVarChart-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCVarChart-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCVarChart_DoFull') eq 'true'}</case>
            <default to="TagPartInstance-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCVarChart-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCVarChart_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCVarChartID,SPCRuleID,ProductID,AcquisitionID,MachineStageID,VariableTypeID,RfAttributeClassID,HeadNo,RfAcquisitionClassID,TrendStartMSID,TAGMSTYPE1ID,ATTRIBUTETYPEID,TAGMSVALUE1,CreateDT,LoginID,IsMsetInsert, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCVarChart WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCVarChart_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagPartInstance-Ingest-SPTM-Decision"/>
        <error to="TagPartInstance-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagPartInstance-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagPartInstance-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagPartInstance_DoFull') eq 'true'}</case>
            <default to="TagTypeInTagProfile-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagPartInstance-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagPartInstance_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagPartInstanceID,PartInstanceID,TagTypeID,TagValue,DT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagPartInstance WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagPartInstance_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagTypeInTagProfile-Ingest-SPTM-Decision"/>
        <error to="TagTypeInTagProfile-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagTypeInTagProfile-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagTypeInTagProfile-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagTypeInTagProfile_DoFull') eq 'true'}</case>
            <default to="Tool_Custom-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagTypeInTagProfile-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagTypeInTagProfile_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagProfileID,TagTypeID,EntryOrder,CompulsoryConditions,IsDefaulted,IsEncrypted,TagListID,IsReadOnly,RptQueryID,TagTypeInTagProfileID,TagTreeID,RfTagDataSourceID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagTypeInTagProfile WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagTypeInTagProfile_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool_Custom-Ingest-SPTM-Decision"/>
        <error to="Tool_Custom-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Tool_Custom-Ingest-SPTM-Decision">
    	<switch>
			<case to="Tool_Custom-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Tool_Custom_DoFull') eq 'true'}</case>
            <default to="ToolState-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Tool_Custom-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Tool_Custom_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Tool_Custom WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Tool_Custom_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolState-Ingest-SPTM-Decision"/>
        <error to="ToolState-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolState-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolState-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolState_DoFull') eq 'true'}</case>
            <default to="UnitCountType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolState-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolState_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolStateID,ToolID,FromDT,ToDT,RfToolStatusID,LoginID,Comments,OpenedDT,SavedDT,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolState WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolState_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCountType-Ingest-SPTM-Decision"/>
        <error to="UnitCountType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="UnitCountType-Ingest-SPTM-Decision">
    	<switch>
			<case to="UnitCountType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_UnitCountType_DoFull') eq 'true'}</case>
            <default to="VariableTypeGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="UnitCountType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitCountType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountTypeID,UnitCountType,Description,MachineStageTypeID,DefaultUnitID,IsQuantityIn,IsQuantityOut,IsMaintenanceCount,IsConvertableToBaseUnits,AssetCountTypeID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitCountType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitCountType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VariableTypeGroup-Ingest-SPTM-Decision"/>
        <error to="VariableTypeGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="VariableTypeGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="VariableTypeGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_VariableTypeGroup_DoFull') eq 'true'}</case>
            <default to="WorkInstructionResult-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="VariableTypeGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VariableTypeGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeGroupID,Name,Description,VariableTypeGroupCode,IsSmartGroup,SmartGroupPattern, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VariableTypeGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VariableTypeGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WorkInstructionResult-Ingest-SPTM-Decision"/>
        <error to="WorkInstructionResult-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WorkInstructionResult-Ingest-SPTM-Decision">
    	<switch>
			<case to="WorkInstructionResult-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WorkInstructionResult_DoFull') eq 'true'}</case>
            <default to="Part-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="WorkInstructionResult-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WorkInstructionResult_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WorkInstructionResultID,WorkInstructionStepID,OperationID,DT,Comments,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WorkInstructionResult WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WorkInstructionResult_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Part-Ingest-SPDV-Decision"/>
        <error to="Part-Ingest-SPDV-Decision"/>
    </action>

	<decision name="Part-Ingest-SPDV-Decision">
    	<switch>
			<case to="Part-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_Part_DoFull') eq 'true'}</case>
            <default to="End-Full-16-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="Part-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_Part_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Part.PartID, Part.PartNumber, Part.Description, Part.IsRetired, Part.BaseUnitID, Part.PartTypeID, Part.Reference1, Part.Reference2, Part.Reference3, Part.Reference4, Part.Reference5, Part.Variant1, Part.Variant2, Part.Variant3, Part.Variant4, Part.Variant5, Part.Variant6, Part.Variant7, Part.Variant8, Part.Variant9, Part.Variant10, Part.Variant11, Part.Variant12, Part.Variant13, Part.Variant14, Part.Variant15, Part.Variant16, Part.Variant17, Part.Variant18, Part.Variant19, Part.Variant20, Part_.TheoreticalSpeed, Part_.LabelsPerInventoryPack, Part_.ItemsPerInventoryPack, Part_.ItemsPerLayer, Part_.LayersPerInventoryPack, Part_.PackingCode, Part_.LabelTemplate, Part_.ProductionInstructions, Part_.QualityInstructions, Part_.CustomerPartNo, Part_.CustomerPartDescription, Part_.LabelText1, Part_.LabelText2, Part_.LabelText3, Part_.UnitPrice1, Part_.UnitPrice2, Part_.LegacyPartNo, Part_.CreateDT, Part_.ModifiedDT, Part_.LoginID, Part_.PartRevisionNo, Part_.PartClassificationID, Part_.LastPurchaseCost, Part_.AveragePurchaseCost, Part_.StandardPurchaseCost, Part_.StandardManufactureCost, Part_.StandardSaleCost, Part_.PartSubClassificationID, Part_.CreatedInvUseByPeriod, Part_.CreatedInvUseAfterPeriod, Part_custom.Txn_date, Part_custom.Inventory_Item_Id, Part_custom.Item_Type_Description,  3 as "org_id",  'SPDV' as "org_name" , (CASE WHEN Part.PartTypeID = 58 then '1' WHEN Part.parttypeid in (39, 63) and (Part.Description like '%T5%' COLLATE Latin1_General_BIN or variant1 = 'T5') THEN '96' WHEN Part.PartTypeID = 40 THEN SUBSTRING(SUBSTRING(Description,(PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)+1), (len(Part.description)-PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)) ) , 1,(PATINDEX('%[WB]%',SUBSTRING(Part.Description,(PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)+1), (len(Part.description)-PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)) ))) -1 ) ELSE Part.variant1 END) as "Cell_Count" , (CASE WHEN Part.parttypeid in (39, 63) then case when Part.description like '%COM%' COLLATE Latin1_General_BIN THEN 'Commercial' ELSE 'Residential' END else 'NA' end) as "Demand_Category" , (CASE WHEN Part.Parttypeid = 58 then variant8 when Part.parttypeid in (39, 40, 63) then case when Part.description like '%E60%' COLLATE Latin1_General_BIN or Part.Description like '%X20%' COLLATE Latin1_General_BIN or Part.description like '%X21%' COLLATE Latin1_General_BIN then 'GEN E160' else 'GEN C160' end else 'NA' end) as "Series"  FROM Part FULL JOIN Part_ ON (Part.PartID = Part_.PartID) FULL JOIN Part_custom ON (Part.PartID = Part_custom.PartID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_Part_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-16-Ingest-Decision"/>
        <error to="End-Full-16-Ingest-Decision"/>
    </action>

	<end name="End-Full-16-Ingest-Decision"/>
</workflow-app>

<workflow-app name="Ingest-Full-18" xmlns="uri:oozie:workflow:0.1">

 	<start to="Acquisition-Ingest-SPMX-Decision"/>


	<decision name="Acquisition-Ingest-SPMX-Decision">
    	<switch>
			<case to="Acquisition-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Acquisition_DoFull') eq 'true'}</case>
            <default to="AcquisitionVariableType-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="Acquisition-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Acquisition_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionID,Acquisition,AcquisitionCode,Description, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Acquisition WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Acquisition_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionVariableType-Ingest-SPMX-Decision"/>
        <error to="AcquisitionVariableType-Ingest-SPMX-Decision"/>
    </action>

	<decision name="AcquisitionVariableType-Ingest-SPMX-Decision">
    	<switch>
			<case to="AcquisitionVariableType-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_AcquisitionVariableType_DoFull') eq 'true'}</case>
            <default to="ActionStatus-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionVariableType-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_AcquisitionVariableType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionVariableTypeID,AcquisitionVariantID,VariableTypeID,NoHeads,NoSamples,NoPositions,EntryOrder,Formula, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.AcquisitionVariableType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_AcquisitionVariableType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionStatus-Ingest-SPMX-Decision"/>
        <error to="ActionStatus-Ingest-SPMX-Decision"/>
    </action>

	<decision name="ActionStatus-Ingest-SPMX-Decision">
    	<switch>
			<case to="ActionStatus-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_ActionStatus_DoFull') eq 'true'}</case>
            <default to="AssetCycleCount-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="ActionStatus-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_ActionStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionStatusID,ActionStatus,ConditionalFormat,IsClosedState, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.ActionStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_ActionStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AssetCycleCount-Ingest-SPMX-Decision"/>
        <error to="AssetCycleCount-Ingest-SPMX-Decision"/>
    </action>

	<decision name="AssetCycleCount-Ingest-SPMX-Decision">
    	<switch>
			<case to="AssetCycleCount-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_AssetCycleCount_DoFull') eq 'true'}</case>
            <default to="AVAttribute-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="AssetCycleCount-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_AssetCycleCount_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetCycleCountID,AssetID,RfDayPeriodID,Count,AssetCountTypeID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.AssetCycleCount WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_AssetCycleCount_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AVAttribute-Ingest-SPMX-Decision"/>
        <error to="AVAttribute-Ingest-SPMX-Decision"/>
    </action>

	<decision name="AVAttribute-Ingest-SPMX-Decision">
    	<switch>
			<case to="AVAttribute-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_AVAttribute_DoFull') eq 'true'}</case>
            <default to="CauseAction_-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="AVAttribute-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_AVAttribute_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionVariantID,TargetSampleSize,RfAttrStudyTypeID,Instructions,ImageURI,NoHeads,RfSourceID,DataDeviceID,DeviceArgs,DeviceOutput, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.AVAttribute WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_AVAttribute_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="CauseAction_-Ingest-SPMX-Decision"/>
        <error to="CauseAction_-Ingest-SPMX-Decision"/>
    </action>

	<decision name="CauseAction_-Ingest-SPMX-Decision">
    	<switch>
			<case to="CauseAction_-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_CauseAction__DoFull') eq 'true'}</case>
            <default to="CostCentre-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="CauseAction_-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_CauseAction__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CauseActionID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedCauseActionID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.CauseAction_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_CauseAction__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="CostCentre-Ingest-SPMX-Decision"/>
        <error to="CostCentre-Ingest-SPMX-Decision"/>
    </action>

	<decision name="CostCentre-Ingest-SPMX-Decision">
    	<switch>
			<case to="CostCentre-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_CostCentre_DoFull') eq 'true'}</case>
            <default to="Department-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="CostCentre-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_CostCentre_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CostCentreID,CostCentre,Description, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.CostCentre WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_CostCentre_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Department-Ingest-SPTT-Decision"/>
        <error to="Department-Ingest-SPTT-Decision"/>
    </action>

	<decision name="Department-Ingest-SPTT-Decision">
    	<switch>
			<case to="Department-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_Department_DoFull') eq 'true'}</case>
            <default to="FaultStatus-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="Department-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_Department_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DepartmentID,Name,DepartmentGroup,Classification1,PlantID,DepartmentCode,Description, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.Department WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_Department_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="FaultStatus-Ingest-SPTT-Decision"/>
        <error to="FaultStatus-Ingest-SPTT-Decision"/>
    </action>

	<decision name="FaultStatus-Ingest-SPTT-Decision">
    	<switch>
			<case to="FaultStatus-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_FaultStatus_DoFull') eq 'true'}</case>
            <default to="InvState-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="FaultStatus-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_FaultStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FaultStatusID,FaultStatus,Description,RfFaultStatusID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.FaultStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_FaultStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvState-Ingest-SPMX-Decision"/>
        <error to="InvState-Ingest-SPMX-Decision"/>
    </action>

	<decision name="InvState-Ingest-SPMX-Decision">
    	<switch>
			<case to="InvState-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_InvState_DoFull') eq 'true'}</case>
            <default to="LineType-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="InvState-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InvState_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvStateID,InvState,Description,RfInvStateID,InvStateCode,IsAddToProduction,IsAddToHFI,IsDefault, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.InvState WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InvState_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineType-Ingest-SPTT-Decision"/>
        <error to="LineType-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LineType-Ingest-SPTT-Decision">
    	<switch>
			<case to="LineType-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LineType_DoFull') eq 'true'}</case>
            <default to="LkConcernDocument-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LineType-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LineType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineTypeID,LineType,Description,IsRetired,LineInfoPrecedence,BudgetChangeOver,BudgetEfficiency, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LineType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LineType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkConcernDocument-Ingest-SPTT-Decision"/>
        <error to="LkConcernDocument-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkConcernDocument-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkConcernDocument-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkConcernDocument_DoFull') eq 'true'}</case>
            <default to="LkDocumentInvPack-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkConcernDocument-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkConcernDocument_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernID,DocumentID,LKConcernDocumentID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkConcernDocument WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkConcernDocument_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentInvPack-Ingest-SPTT-Decision"/>
        <error to="LkDocumentInvPack-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkDocumentInvPack-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkDocumentInvPack-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkDocumentInvPack_DoFull') eq 'true'}</case>
            <default to="LkLLS-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentInvPack-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkDocumentInvPack_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentInvPackID,DocumentID,InventoryPackID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkDocumentInvPack WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkDocumentInvPack_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkLLS-Ingest-SPMX-Decision"/>
        <error to="LkLLS-Ingest-SPMX-Decision"/>
    </action>

	<decision name="LkLLS-Ingest-SPMX-Decision">
    	<switch>
			<case to="LkLLS-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_LkLLS_DoFull') eq 'true'}</case>
            <default to="LkMSRGMSR-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="LkLLS-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkLLS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineID,LineSectionID,LkLLSID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkLLS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkLLS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMSRGMSR-Ingest-SPMX-Decision"/>
        <error to="LkMSRGMSR-Ingest-SPMX-Decision"/>
    </action>

	<decision name="LkMSRGMSR-Ingest-SPMX-Decision">
    	<switch>
			<case to="LkMSRGMSR-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_LkMSRGMSR_DoFull') eq 'true'}</case>
            <default to="LkPartSupplier-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="LkMSRGMSR-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkMSRGMSR_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonGroupID,MachineStopReasonID,LkMSRGMSRID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkMSRGMSR WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkMSRGMSR_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartSupplier-Ingest-SPDV-Decision"/>
        <error to="LkPartSupplier-Ingest-SPDV-Decision"/>
    </action>

	<decision name="LkPartSupplier-Ingest-SPDV-Decision">
    	<switch>
			<case to="LkPartSupplier-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_LkPartSupplier_DoFull') eq 'true'}</case>
            <default to="LkToolTypeOpType-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartSupplier-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_LkPartSupplier_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartSupplierID,PartID,SupplierID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.LkPartSupplier WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_LkPartSupplier_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkToolTypeOpType-Ingest-SPMM-Decision"/>
        <error to="LkToolTypeOpType-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkToolTypeOpType-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkToolTypeOpType-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkToolTypeOpType_DoFull') eq 'true'}</case>
            <default to="LkWIRBuildRecord-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkToolTypeOpType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkToolTypeOpType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolTypeID,OperationTypeID,MaxNoTools,LkToolTypeOpTypeID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkToolTypeOpType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkToolTypeOpType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkWIRBuildRecord-Ingest-SPMM-Decision"/>
        <error to="LkWIRBuildRecord-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkWIRBuildRecord-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkWIRBuildRecord-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkWIRBuildRecord_DoFull') eq 'true'}</case>
            <default to="MachineStageInvPosition-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkWIRBuildRecord-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkWIRBuildRecord_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkWIRBuildRecordID,WorkInstructionResultID,BuildRecordID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkWIRBuildRecord WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkWIRBuildRecord_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageInvPosition-Ingest-SPMM-Decision"/>
        <error to="MachineStageInvPosition-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MachineStageInvPosition-Ingest-SPMM-Decision">
    	<switch>
			<case to="MachineStageInvPosition-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MachineStageInvPosition_DoFull') eq 'true'}</case>
            <default to="MaintenanceManHours-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageInvPosition-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MachineStageInvPosition_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageInvPositionId,MachineStageId,Position,PositionNumber, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MachineStageInvPosition WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MachineStageInvPosition_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceManHours-Ingest-SPMM-Decision"/>
        <error to="MaintenanceManHours-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MaintenanceManHours-Ingest-SPMM-Decision">
    	<switch>
			<case to="MaintenanceManHours-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MaintenanceManHours_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedureRevision-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceManHours-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MaintenanceManHours_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceManHoursID,MaintenanceWorkID,WorkerLoginID,ActualManHours,RevisionNo,IsEdited,ModifiedDT,SupplierID,SupplierCost,PersonnelGroupID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MaintenanceManHours WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MaintenanceManHours_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedureRevision-Ingest-SPMM-Decision"/>
        <error to="MaintenanceProcedureRevision-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MaintenanceProcedureRevision-Ingest-SPMM-Decision">
    	<switch>
			<case to="MaintenanceProcedureRevision-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MaintenanceProcedureRevision_DoFull') eq 'true'}</case>
            <default to="MaintProcScheduleOnAsset-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedureRevision-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MaintenanceProcedureRevision_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureRevisionID,MaintenanceProcedureID,FromDT,ToDT,IsEdited,RevisionNo,LoginID,ModifiedDT,RevisedMaintProcID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MaintenanceProcedureRevision WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MaintenanceProcedureRevision_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintProcScheduleOnAsset-Ingest-SPMM-Decision"/>
        <error to="MaintProcScheduleOnAsset-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MaintProcScheduleOnAsset-Ingest-SPMM-Decision">
    	<switch>
			<case to="MaintProcScheduleOnAsset-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MaintProcScheduleOnAsset_DoFull') eq 'true'}</case>
            <default to="OPCConstant-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MaintProcScheduleOnAsset-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MaintProcScheduleOnAsset_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintProcScheduleOnAssetID,MaintenanceProcedureID,AssetID,RfPeriodTypeID,StartDate,AssetCountTypeID,EBAReference,IsEdited,LoginID,ModifiedDT,CalendarN1,CalendarN2,CalendarN3,CounterThreshold1,CounterThreshold2,CounterThreshold3,EstimatedCountPerDay,RunHourThreshold1,RunHourThreshold2,RunHourThreshold3,EstimatedRunHoursPerDay,EstimatedEventsPerDay,RevisionNo,IsRetired,PriorExecutions, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MaintProcScheduleOnAsset WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MaintProcScheduleOnAsset_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCConstant-Ingest-SPMM-Decision"/>
        <error to="OPCConstant-Ingest-SPMM-Decision"/>
    </action>

	<decision name="OPCConstant-Ingest-SPMM-Decision">
    	<switch>
			<case to="OPCConstant-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_OPCConstant_DoFull') eq 'true'}</case>
            <default to="OPCMachineEvent-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="OPCConstant-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_OPCConstant_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCConstantID,OPCItemID,Description,Constant,Formula,ModifiedDT,LoginID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.OPCConstant WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_OPCConstant_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCMachineEvent-Ingest-SPMM-Decision"/>
        <error to="OPCMachineEvent-Ingest-SPMM-Decision"/>
    </action>

	<decision name="OPCMachineEvent-Ingest-SPMM-Decision">
    	<switch>
			<case to="OPCMachineEvent-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_OPCMachineEvent_DoFull') eq 'true'}</case>
            <default to="Operation-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="OPCMachineEvent-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_OPCMachineEvent_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCMachineEventID,OPCItemID,Description,Formula,ModifiedDT,LoginID,RfMachineStopRecordModeID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.OPCMachineEvent WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_OPCMachineEvent_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Operation-Ingest-SPDV-Decision"/>
        <error to="Operation-Ingest-SPDV-Decision"/>
    </action>

	<decision name="Operation-Ingest-SPDV-Decision">
    	<switch>
			<case to="Operation-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_Operation_DoFull') eq 'true'}</case>
            <default to="Product-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="Operation-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_Operation_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OperationID,OperationTypeID,MachineStageID,JobID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.Operation WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_Operation_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Product-Ingest-SPDV-Decision"/>
        <error to="Product-Ingest-SPDV-Decision"/>
    </action>

	<decision name="Product-Ingest-SPDV-Decision">
    	<switch>
			<case to="Product-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_Product_DoFull') eq 'true'}</case>
            <default to="Scrap-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Product-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_Product_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductID,ProductTypeID,Name,Description,IsRetired,PartID,Variant1,Variant2,Variant3,Variant4,Variant5,Variant6,Variant7,Variant8,Variant9,Variant10,Variant11,Variant12,Variant13,Variant14,Variant15,Variant16,Variant17,Variant18,Variant19,Variant20, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.Product WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_Product_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Scrap-Ingest-SPMM-Decision"/>
        <error to="Scrap-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Scrap-Ingest-SPMM-Decision">
    	<switch>
			<case to="Scrap-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Scrap_DoFull') eq 'true'}</case>
            <default to="SettingsPlantTimeWindows-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Scrap-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Scrap_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ScrapID,ScrapReasonID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.Scrap WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Scrap_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SettingsPlantTimeWindows-Ingest-SPMM-Decision"/>
        <error to="SettingsPlantTimeWindows-Ingest-SPMM-Decision"/>
    </action>

	<decision name="SettingsPlantTimeWindows-Ingest-SPMM-Decision">
    	<switch>
			<case to="SettingsPlantTimeWindows-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_SettingsPlantTimeWindows_DoFull') eq 'true'}</case>
            <default to="SPCCalcStyle_CUS-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="SettingsPlantTimeWindows-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_SettingsPlantTimeWindows_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SettingsPlantTimeWindowsID,JobHistory,ProductionSpoilageHistory,DowntimeHistory,InventoryHistory,InventoryLabelHistory,BuildRecordHistory,LineInfoHistory,QualityMeasurementHistory,ProcessParameterHistory,OPCItemHistoryHistory,InitialLineInfoHistory,MaintenanceProjectionPeriod,ShiftLookAheadDays,ForwardSchedulingWindow,DefaultMaxTrendRecallWindow,DefaultConcernDuePeriod, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.SettingsPlantTimeWindows WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_SettingsPlantTimeWindows_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCCalcStyle_CUS-Ingest-SPMM-Decision"/>
        <error to="SPCCalcStyle_CUS-Ingest-SPMM-Decision"/>
    </action>

	<decision name="SPCCalcStyle_CUS-Ingest-SPMM-Decision">
    	<switch>
			<case to="SPCCalcStyle_CUS-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_SPCCalcStyle_CUS_DoFull') eq 'true'}</case>
            <default to="SPCChartSetViewStyle_CUS-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="SPCCalcStyle_CUS-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_SPCCalcStyle_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCCalcStyleID,SPCCalcStyle,CmThreshold,CpThreshold,PpThreshold,CgThreshold,RnRThreshold,IsShowCpOnlyIfStable,CAMTarget,CpBasedOnID,CLBasedOnID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.SPCCalcStyle_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_SPCCalcStyle_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartSetViewStyle_CUS-Ingest-SPMM-Decision"/>
        <error to="SPCChartSetViewStyle_CUS-Ingest-SPMM-Decision"/>
    </action>

	<decision name="SPCChartSetViewStyle_CUS-Ingest-SPMM-Decision">
    	<switch>
			<case to="SPCChartSetViewStyle_CUS-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_SPCChartSetViewStyle_CUS_DoFull') eq 'true'}</case>
            <default to="Supplier-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartSetViewStyle_CUS-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_SPCChartSetViewStyle_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetViewStyleID,SPCChartSetViewStyle,IsSpecLimits,IsControlLimitZones,IsGrid,IsTimescaled,IsHAxis,IsVAxis,IsXChart,IsRsChart,IsRsWChart,IsDistribution,IsShowComments,IsXScatter,IsIncludeIgnored,IsOnlyOSOCCharts,SPCStatsStyleID,IsVerticalOverview,OverviewWidth,OverviewHeight,PageBreakRfCutByIDs,ChartWidth,ChartHeight,IsFixedScale,IsParetoCurve,IsLegend,IsHorizontalDistribution,IsSigmaLines,IsShowCAComments,IsShowUnAckAlarms,HorizontalOffset,IsShowLimitLabels,IsColourZones,IsSystem,IsOSHotCold,FixedScaleOverscaling,IsConstantTitleRow,IsShowStatCategories,IsOverlayEnvelope,IsGradientBackground,RunChartFont,DistributionFont,StatisticsFont,VAxisFont,HAxisFont,OverlayKeyFont,IsShowOverlayKey, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.SPCChartSetViewStyle_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_SPCChartSetViewStyle_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Supplier-Ingest-SPMM-Decision"/>
        <error to="Supplier-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Supplier-Ingest-SPMM-Decision">
    	<switch>
			<case to="Supplier-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Supplier_DoFull') eq 'true'}</case>
            <default to="TagProfile-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Supplier-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Supplier_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SupplierID,Supplier,SupplierCode,AddressID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.Supplier WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Supplier_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagProfile-Ingest-SPMM-Decision"/>
        <error to="TagProfile-Ingest-SPMM-Decision"/>
    </action>

	<decision name="TagProfile-Ingest-SPMM-Decision">
    	<switch>
			<case to="TagProfile-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_TagProfile_DoFull') eq 'true'}</case>
            <default to="TMP_Checks_Done-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="TagProfile-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_TagProfile_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagProfileID,Name, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.TagProfile WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_TagProfile_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TMP_Checks_Done-Ingest-SPMM-Decision"/>
        <error to="TMP_Checks_Done-Ingest-SPMM-Decision"/>
    </action>

	<decision name="TMP_Checks_Done-Ingest-SPMM-Decision">
    	<switch>
			<case to="TMP_Checks_Done-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_TMP_Checks_Done_DoFull') eq 'true'}</case>
            <default to="ToolAtLocation-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="TMP_Checks_Done-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_TMP_Checks_Done_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftID,JobID,AcquisitionContextID,Checks_Done, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.TMP_Checks_Done WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_TMP_Checks_Done_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolAtLocation-Ingest-SPMM-Decision"/>
        <error to="ToolAtLocation-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ToolAtLocation-Ingest-SPMM-Decision">
    	<switch>
			<case to="ToolAtLocation-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ToolAtLocation_DoFull') eq 'true'}</case>
            <default to="ToolType-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ToolAtLocation-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ToolAtLocation_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolAtLocationID,LocationID,ToolID,FromDT,ToDT,IsEdited,RevisionNo,EditedToolAtLocationID,MovedByLoginID,ModifiedDT,Reference1,Reference2,Reference3, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ToolAtLocation WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ToolAtLocation_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolType-Ingest-SPMM-Decision"/>
        <error to="ToolType-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ToolType-Ingest-SPMM-Decision">
    	<switch>
			<case to="ToolType-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ToolType_DoFull') eq 'true'}</case>
            <default to="UnitCountTypeGroup-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ToolType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ToolType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolTypeID,ToolType,ToolTypeCode,Description,Variant1TagListID,Variant2TagListID,Variant3TagListID,Variant4TagListID,Variant5TagListID,Variant6TagListID,Variant7TagListID,Variant8TagListID,Variant9TagListID,Variant10TagListID,Variant11TagListID,Variant12TagListID,Variant13TagListID,Variant14TagListID,Variant15TagListID,Variant16TagListID,Variant17TagListID,Variant18TagListID,Variant19TagListID,Variant20TagListID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ToolType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ToolType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCountTypeGroup-Ingest-SPMM-Decision"/>
        <error to="UnitCountTypeGroup-Ingest-SPMM-Decision"/>
    </action>

	<decision name="UnitCountTypeGroup-Ingest-SPMM-Decision">
    	<switch>
			<case to="UnitCountTypeGroup-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_UnitCountTypeGroup_DoFull') eq 'true'}</case>
            <default to="WO-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="UnitCountTypeGroup-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_UnitCountTypeGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountTypeGroupID,UnitCountTypeGroup,Description, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.UnitCountTypeGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_UnitCountTypeGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO-Ingest-SPMM-Decision"/>
        <error to="WO-Ingest-SPMM-Decision"/>
    </action>

	<decision name="WO-Ingest-SPMM-Decision">
    	<switch>
			<case to="WO-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_WO_DoFull') eq 'true'}</case>
            <default to="WorkInstructionStep-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="WO-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_WO_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WOID,WONumber,RunNo,PartID,QuantityOrdered,RfJobStatusID,DeadlineDT,ActualStartDT,ActualEndDT,PlannedStartDT,PlannedEndDT,EstimatedStartDT,EstimatedEndDT,CustomerID,IsDiscrete,Reference1,Reference2,Reference3,Reference4,Reference5,WORefID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.WO WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_WO_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WorkInstructionStep-Ingest-SPMM-Decision"/>
        <error to="WorkInstructionStep-Ingest-SPMM-Decision"/>
    </action>

	<decision name="WorkInstructionStep-Ingest-SPMM-Decision">
    	<switch>
			<case to="WorkInstructionStep-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_WorkInstructionStep_DoFull') eq 'true'}</case>
            <default to="Part-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="WorkInstructionStep-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_WorkInstructionStep_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WorkInstructionStepID,WorkInstructionStep,WorkInstructionProcedureID,OperationTypeID,StepOrder,RfSpecialActionTypeID,AcquisitionVariantID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.WorkInstructionStep WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_WorkInstructionStep_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Part-Ingest-SPTT-Decision"/>
        <error to="Part-Ingest-SPTT-Decision"/>
    </action>

	<decision name="Part-Ingest-SPTT-Decision">
    	<switch>
			<case to="Part-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_Part_DoFull') eq 'true'}</case>
            <default to="End-Full-18-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="Part-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_Part_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Part.PartID, Part.PartNumber, Part.Description, Part.IsRetired, Part.BaseUnitID, Part.PartTypeID, Part.Reference1, Part.Reference2, Part.Reference3, Part.Reference4, Part.Reference5, Part.Variant1, Part.Variant2, Part.Variant3, Part.Variant4, Part.Variant5, Part.Variant6, Part.Variant7, Part.Variant8, Part.Variant9, Part.Variant10, Part.Variant11, Part.Variant12, Part.Variant13, Part.Variant14, Part.Variant15, Part.Variant16, Part.Variant17, Part.Variant18, Part.Variant19, Part.Variant20, Part_.TheoreticalSpeed, Part_.LabelsPerInventoryPack, Part_.ItemsPerInventoryPack, Part_.ItemsPerLayer, Part_.LayersPerInventoryPack, Part_.PackingCode, Part_.LabelTemplate, Part_.ProductionInstructions, Part_.QualityInstructions, Part_.CustomerPartNo, Part_.CustomerPartDescription, Part_.LabelText1, Part_.LabelText2, Part_.LabelText3, Part_.UnitPrice1, Part_.UnitPrice2, Part_.LegacyPartNo, Part_.CreateDT, Part_.ModifiedDT, Part_.LoginID, Part_.PartRevisionNo, Part_.PartClassificationID, Part_.LastPurchaseCost, Part_.AveragePurchaseCost, Part_.StandardPurchaseCost, Part_.StandardManufactureCost, Part_.StandardSaleCost, Part_.PartSubClassificationID, Part_.CreatedInvUseByPeriod, Part_.CreatedInvUseAfterPeriod, Part_custom.Txn_date, Part_custom.Inventory_Item_Id, Part_custom.Item_Type_Description,  4 as "org_id",  'SPTT' as "org_name" , (CASE WHEN Part.PartTypeID = 58 then '1' WHEN Part.parttypeid in (39, 63) and (Part.Description like '%T5%' COLLATE Latin1_General_BIN or variant1 = 'T5') THEN '96' WHEN Part.PartTypeID = 40 THEN SUBSTRING(SUBSTRING(Description,(PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)+1), (len(Part.description)-PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)) ) , 1,(PATINDEX('%[WB]%',SUBSTRING(Part.Description,(PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)+1), (len(Part.description)-PATINDEX('%[ "-][0-9]%[BW][ "-]%',Part.Description)) ))) -1 ) ELSE Part.variant1 END) as "Cell_Count" , (CASE WHEN Part.parttypeid in (39, 63) then case when Part.description like '%COM%' COLLATE Latin1_General_BIN THEN 'Commercial' ELSE 'Residential' END else 'NA' end) as "Demand_Category" , (CASE WHEN Part.Parttypeid = 58 then variant8 when Part.parttypeid in (39, 40, 63) then case when Part.description like '%E60%' COLLATE Latin1_General_BIN or Part.Description like '%X20%' COLLATE Latin1_General_BIN or Part.description like '%X21%' COLLATE Latin1_General_BIN then 'GEN E160' else 'GEN C160' end else 'NA' end) as "Series"  FROM Part FULL JOIN Part_ ON (Part.PartID = Part_.PartID) FULL JOIN Part_custom ON (Part.PartID = Part_custom.PartID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_Part_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-18-Ingest-Decision"/>
        <error to="End-Full-18-Ingest-Decision"/>
    </action>

	<end name="End-Full-18-Ingest-Decision"/>
</workflow-app>

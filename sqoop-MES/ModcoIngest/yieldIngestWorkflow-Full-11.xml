<workflow-app name="Ingest-Full-11" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SP_PalletLabel-Ingest-SPTT-Decision"/>


	<decision name="_SP_PalletLabel-Ingest-SPTT-Decision">
    	<switch>
			<case to="_SP_PalletLabel-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER__SP_PalletLabel_DoFull') eq 'true'}</case>
            <default to="AcquisitionDevice-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="_SP_PalletLabel-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER__SP_PalletLabel_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT _SP_PalletLabelID,PalletID,MachineStage,PartNumber,InvState,PalletNo,CreatedDT,CompleteDT,Quantity,LabelTemplate,PrinterURL,PrintedDT,ScannedDT,IsCancelled,IsReprint,PartDescription,LabelSaveDirectory,IsPrintLandscape,NoCopies,LabelsPerInventoryPack, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo._SP_PalletLabel WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER__SP_PalletLabel_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionDevice-Ingest-SPTT-Decision"/>
        <error to="AcquisitionDevice-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AcquisitionDevice-Ingest-SPTT-Decision">
    	<switch>
			<case to="AcquisitionDevice-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AcquisitionDevice_DoFull') eq 'true'}</case>
            <default to="ActionNote-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionDevice-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AcquisitionDevice_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionDeviceID,AcquisitionVariableTypeID,WorkstationConfigID,Instructions,ImageURI,RfSourceID,DataDeviceID,DeviceArgs,DeviceOutput,FillMode,Preset,Multiplier,PreprocessingFunction,IsManualTrigger,IsManualConfirm, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AcquisitionDevice WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AcquisitionDevice_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionNote-Ingest-SPTT-Decision"/>
        <error to="ActionNote-Ingest-SPTT-Decision"/>
    </action>

	<decision name="ActionNote-Ingest-SPTT-Decision">
    	<switch>
			<case to="ActionNote-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_ActionNote_DoFull') eq 'true'}</case>
            <default to="Asset-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="ActionNote-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_ActionNote_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionNoteID,ActionID,Note,Comments,NoteDT,LoginID,Reference1,Reference2,Reference3, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.ActionNote WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_ActionNote_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Asset-Ingest-SPTT-Decision"/>
        <error to="Asset-Ingest-SPTT-Decision"/>
    </action>

	<decision name="Asset-Ingest-SPTT-Decision">
    	<switch>
			<case to="Asset-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_Asset_DoFull') eq 'true'}</case>
            <default to="AttributeType-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="Asset-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_Asset_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetID,AssetName,RfAssetTypeID,LineID,MachineStageID,ToolID,GaugeID,PartID,InventoryPackID,LocationID,IsRetired,CostCentreID,ManufacturerID,SupplierID,AcquiredDT,PONumber,OrderedDT,ExpectedDeliveryDT,ExpectedFirstUseDT,EndUseDT,EndUseReason,PurchaseCost,DefaultLocationID,Comments, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.Asset WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_Asset_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AttributeType-Ingest-SPTT-Decision"/>
        <error to="AttributeType-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AttributeType-Ingest-SPTT-Decision">
    	<switch>
			<case to="AttributeType-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AttributeType_DoFull') eq 'true'}</case>
            <default to="BOMVariant-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AttributeType-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AttributeType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeID,ProductTypeID,Name,Description,ImageURI,RfAttributeClassID,IsPassFail,IsRaiseCA,LikelyCauses,Impact,Weighting,Reference1,Reference2,Reference3,Reference4,Reference5,AttributeTypeCode, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AttributeType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AttributeType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BOMVariant-Ingest-SPTT-Decision"/>
        <error to="BOMVariant-Ingest-SPTT-Decision"/>
    </action>

	<decision name="BOMVariant-Ingest-SPTT-Decision">
    	<switch>
			<case to="BOMVariant-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_BOMVariant_DoFull') eq 'true'}</case>
            <default to="ConcernStatus-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="BOMVariant-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_BOMVariant_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BOMVariantID,BOMVariant,PartID,IsDefault,BOMVariantIndex,IsRetired,LoginID,DT, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.BOMVariant WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_BOMVariant_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ConcernStatus-Ingest-SPTT-Decision"/>
        <error to="ConcernStatus-Ingest-SPTT-Decision"/>
    </action>

	<decision name="ConcernStatus-Ingest-SPTT-Decision">
    	<switch>
			<case to="ConcernStatus-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_ConcernStatus_DoFull') eq 'true'}</case>
            <default to="DefectCountP-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ConcernStatus-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_ConcernStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernStatusID,ConcernStatus,ConditionalFormat,IsClosedState, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.ConcernStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_ConcernStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCountP-Ingest-SPMM-Decision"/>
        <error to="DefectCountP-Ingest-SPMM-Decision"/>
    </action>

	<decision name="DefectCountP-Ingest-SPMM-Decision">
    	<switch>
			<case to="DefectCountP-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_DefectCountP_DoFull') eq 'true'}</case>
            <default to="FaultState-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="DefectCountP-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_DefectCountP_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountPID,MeasurementSetPID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.DefectCountP WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_DefectCountP_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="FaultState-Ingest-SPMM-Decision"/>
        <error to="FaultState-Ingest-SPMM-Decision"/>
    </action>

	<decision name="FaultState-Ingest-SPMM-Decision">
    	<switch>
			<case to="FaultState-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_FaultState_DoFull') eq 'true'}</case>
            <default to="InventoryUsage_-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="FaultState-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_FaultState_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FaultStateID,FaultID,FromDT,ToDT,FaultStatusID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedFaultStateID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.FaultState WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_FaultState_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryUsage_-Ingest-SPTT-Decision"/>
        <error to="InventoryUsage_-Ingest-SPTT-Decision"/>
    </action>

	<decision name="InventoryUsage_-Ingest-SPTT-Decision">
    	<switch>
			<case to="InventoryUsage_-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_InventoryUsage__DoFull') eq 'true'}</case>
            <default to="LineSection-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="InventoryUsage_-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InventoryUsage__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryUsageID,StartUsingComments,StopUsingComments,StartLoginID,StopLoginID,OpenedStartDT,OpenedEndDT,SavedStartDT,SavedEndDT,OriginalLoginID,EditedInventoryUsageID,Reference1,Reference2,Reference3,Reference4,Reference5, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.InventoryUsage_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InventoryUsage__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineSection-Ingest-SPMM-Decision"/>
        <error to="LineSection-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LineSection-Ingest-SPMM-Decision">
    	<switch>
			<case to="LineSection-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LineSection_DoFull') eq 'true'}</case>
            <default to="LkConcernAction-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LineSection-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LineSection_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineSectionID,LineSection,Description,IsRetired, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LineSection WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LineSection_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkConcernAction-Ingest-SPMM-Decision"/>
        <error to="LkConcernAction-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkConcernAction-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkConcernAction-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkConcernAction_DoFull') eq 'true'}</case>
            <default to="LkDocumentAsset-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkConcernAction-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkConcernAction_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LKConcernActionID,ConcernID,ActionID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkConcernAction WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkConcernAction_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentAsset-Ingest-SPMM-Decision"/>
        <error to="LkDocumentAsset-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkDocumentAsset-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkDocumentAsset-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkDocumentAsset_DoFull') eq 'true'}</case>
            <default to="LkInvPackInvPack-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentAsset-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkDocumentAsset_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentAssetID,DocumentID,AssetID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkDocumentAsset WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkDocumentAsset_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkInvPackInvPack-Ingest-SPTT-Decision"/>
        <error to="LkInvPackInvPack-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkInvPackInvPack-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkInvPackInvPack-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkInvPackInvPack_DoFull') eq 'true'}</case>
            <default to="LkMGMS-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkInvPackInvPack-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkInvPackInvPack_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkInvPackInvPackID,InventoryPackFromID,InventoryPackToID,RfInventoryLinkTypeID,LoginID,ModifiedDT, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkInvPackInvPack WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkInvPackInvPack_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMGMS-Ingest-SPTT-Decision"/>
        <error to="LkMGMS-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkMGMS-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkMGMS-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkMGMS_DoFull') eq 'true'}</case>
            <default to="LkPartDocument-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkMGMS-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkMGMS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageID,MachineGroupID,LkMGMSID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkMGMS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkMGMS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartDocument-Ingest-SPTT-Decision"/>
        <error to="LkPartDocument-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkPartDocument-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkPartDocument-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkPartDocument_DoFull') eq 'true'}</case>
            <default to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartDocument-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkPartDocument_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartDocumentID,PartID,DocumentID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkPartDocument WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkPartDocument_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision"/>
        <error to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM-Decision">
    	<switch>
			<case to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFull') eq 'true'}</case>
            <default to="LkVCOCVRule-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RfSPCStatID,SPCStatsStyleID,LkSPCStatsStyleRfSPCStatID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LKSPCStatsStyleRfSPCStat_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkVCOCVRule-Ingest-SPTM-Decision"/>
        <error to="LkVCOCVRule-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkVCOCVRule-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkVCOCVRule-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkVCOCVRule_DoFull') eq 'true'}</case>
            <default to="MachineStageEvent-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkVCOCVRule-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkVCOCVRule_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarChartOCID,RfViolationRuleID,LkVCOCVRuleID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkVCOCVRule WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkVCOCVRule_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageEvent-Ingest-SPTM-Decision"/>
        <error to="MachineStageEvent-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStageEvent-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStageEvent-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStageEvent_DoFull') eq 'true'}</case>
            <default to="MachineStopReasonGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageEvent-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStageEvent_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageEventID,LoginID,DT,MachineStageID,MachineStageEventTypeID,Comments, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStageEvent WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStageEvent_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopReasonGroup-Ingest-SPTM-Decision"/>
        <error to="MachineStopReasonGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStopReasonGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStopReasonGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStopReasonGroup_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedureGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStopReasonGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStopReasonGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonGroupID,MachineStopReasonGroup,Description,MachineStopReasonGroupCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStopReasonGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStopReasonGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedureGroup-Ingest-SPTM-Decision"/>
        <error to="MaintenanceProcedureGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceProcedureGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceProcedureGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceProcedureGroup_DoFull') eq 'true'}</case>
            <default to="MaintenanceWork_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedureGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceProcedureGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureGroupID,MaintenanceProcedureGroup,Description, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceProcedureGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceProcedureGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWork_-Ingest-SPTM-Decision"/>
        <error to="MaintenanceWork_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceWork_-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceWork_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceWork__DoFull') eq 'true'}</case>
            <default to="ModulePackedDateTime_Buffer-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWork_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceWork__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkID,WorkDone,Comments,LoginID,ModifiedDT,Reference1,Reference2,Reference3,Reference4,Reference5, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceWork_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceWork__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ModulePackedDateTime_Buffer-Ingest-SPTM-Decision"/>
        <error to="ModulePackedDateTime_Buffer-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ModulePackedDateTime_Buffer-Ingest-SPTM-Decision">
    	<switch>
			<case to="ModulePackedDateTime_Buffer-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ModulePackedDateTime_Buffer_DoFull') eq 'true'}</case>
            <default to="OPCItem-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ModulePackedDateTime_Buffer-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ModulePackedDateTime_Buffer_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SerialNo,TimePacked,IMS_No, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ModulePackedDateTime_Buffer WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ModulePackedDateTime_Buffer_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCItem-Ingest-SPTM-Decision"/>
        <error to="OPCItem-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCItem-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCItem-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCItem_DoFull') eq 'true'}</case>
            <default to="OPCSpeed-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCItem-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCItem_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCItemID,OPCServerID,OPCGroupID,TagName,TagAddress,RfOPCItemTypeID,IsNotify,RawValue,UpdatedDT,Quality,Value,LastRawValue,LastUpdatedDT,LastQuality,LastValue,MachineStageID,ChangeAction,PLCID,IsDatedOnServer,IsStoredAsArray,IsActive,MachineStageEventTypeID,RfTransitionTypeID,TransitionToValue, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCItem WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCItem_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCSpeed-Ingest-SPTM-Decision"/>
        <error to="OPCSpeed-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCSpeed-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCSpeed-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCSpeed_DoFull') eq 'true'}</case>
            <default to="PLC-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="OPCSpeed-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCSpeed_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCSpeedID,OPCItemID,Description,Scale,Formula,ModifiedDT,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCSpeed WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCSpeed_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PLC-Ingest-SPMX-Decision"/>
        <error to="PLC-Ingest-SPMX-Decision"/>
    </action>

	<decision name="PLC-Ingest-SPMX-Decision">
    	<switch>
			<case to="PLC-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_PLC_DoFull') eq 'true'}</case>
            <default to="RootCause-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="PLC-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_PLC_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PLCID,PLC,Description, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.PLC WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_PLC_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="RootCause-Ingest-SPTM-Decision"/>
        <error to="RootCause-Ingest-SPTM-Decision"/>
    </action>

	<decision name="RootCause-Ingest-SPTM-Decision">
    	<switch>
			<case to="RootCause-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_RootCause_DoFull') eq 'true'}</case>
            <default to="SettingsPlantDefaults-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="RootCause-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_RootCause_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RootCauseID,RootCause,Comments,RootCauseTypeID,LineTypeID,MachineStageTypeID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.RootCause WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_RootCause_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SettingsPlantDefaults-Ingest-SPTM-Decision"/>
        <error to="SettingsPlantDefaults-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SettingsPlantDefaults-Ingest-SPTM-Decision">
    	<switch>
			<case to="SettingsPlantDefaults-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SettingsPlantDefaults_DoFull') eq 'true'}</case>
            <default to="ShiftSequence-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SettingsPlantDefaults-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SettingsPlantDefaults_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SettingsPlantDefaultsID,StartOfDay,StartOfWeek,StartOfYear,RfLocaleID,RfDefaultCurrencyID,DataEntryDefaultURI,OnDataCommitGoTo,ChainToStopped,ColourStagesForCurrentJob,UnAckAlarmsPeriod,ShowOverdueIcon,ShowAlarmIcon,WONumberModeID,IsShowVarClassCombo,IsShowAcqClassCombo,RfMachineStopRecordModeID,IsAutoCreateProductsForParts,IsAutoCreateProductTypeForPart,EnforceClosedAlarms,ColourOrder,IsAutoReleaseJob,JobClose,IsAllowDuplicateWONumbers,WoClose,IsOverdueRefToJob,DefaultSPCCalcStyleID,IsAllowInventoryInserts, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SettingsPlantDefaults WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SettingsPlantDefaults_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftSequence-Ingest-SPTM-Decision"/>
        <error to="ShiftSequence-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ShiftSequence-Ingest-SPTM-Decision">
    	<switch>
			<case to="ShiftSequence-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ShiftSequence_DoFull') eq 'true'}</case>
            <default to="SPCChartSet-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ShiftSequence-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ShiftSequence_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftSequenceID,ShiftPatternID,ShiftTypeID,Sequence,ShiftStartTime,ShiftEndTime, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ShiftSequence WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ShiftSequence_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartSet-Ingest-SPTM-Decision"/>
        <error to="SPCChartSet-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCChartSet-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCChartSet-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCChartSet_DoFull') eq 'true'}</case>
            <default to="SPCStatsStyle_CUS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartSet-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCChartSet_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetID,SPCChartSet,AcquisitionID,SPCURI,RfDataBandID,NPeriods,SpecTypeID,IsRunningProductOnly,LHSessionID,MaxTrendRecallWindow, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCChartSet WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCChartSet_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCStatsStyle_CUS-Ingest-SPTM-Decision"/>
        <error to="SPCStatsStyle_CUS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCStatsStyle_CUS-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCStatsStyle_CUS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCStatsStyle_CUS_DoFull') eq 'true'}</case>
            <default to="TagListValue-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCStatsStyle_CUS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCStatsStyle_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCStatsStyleID,SPCStatsStyle,IsSystem, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCStatsStyle_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCStatsStyle_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagListValue-Ingest-SPTM-Decision"/>
        <error to="TagListValue-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagListValue-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagListValue-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagListValue_DoFull') eq 'true'}</case>
            <default to="TagType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagListValue-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagListValue_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagListValueID,TagListID,TagListValue,DisplayOrder,IsRetired, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagListValue WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagListValue_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagType-Ingest-SPTM-Decision"/>
        <error to="TagType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagType-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagType_DoFull') eq 'true'}</case>
            <default to="Tool_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagTypeID,RfDataTypeID,Name,TagTypeCode,ISSYSTEM,TAGVIEW, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool_-Ingest-SPTM-Decision"/>
        <error to="Tool_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Tool_-Ingest-SPTM-Decision">
    	<switch>
			<case to="Tool_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Tool__DoFull') eq 'true'}</case>
            <default to="ToolGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Tool_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Tool__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID,Supplier,Reference1,Reference2,Reference3,Reference4,Reference5,Ident, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Tool_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Tool__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolGroup-Ingest-SPTM-Decision"/>
        <error to="ToolGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolGroup_DoFull') eq 'true'}</case>
            <default to="UnitConversion-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolGroupID,ToolGroup,Description,ToolGroupCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitConversion-Ingest-SPTM-Decision"/>
        <error to="UnitConversion-Ingest-SPTM-Decision"/>
    </action>

	<decision name="UnitConversion-Ingest-SPTM-Decision">
    	<switch>
			<case to="UnitConversion-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_UnitConversion_DoFull') eq 'true'}</case>
            <default to="VariableTypeClass-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="UnitConversion-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitConversion_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FromUnitID,ToUnitID,Multiplier,UnitConversionID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitConversion WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitConversion_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VariableTypeClass-Ingest-SPTM-Decision"/>
        <error to="VariableTypeClass-Ingest-SPTM-Decision"/>
    </action>

	<decision name="VariableTypeClass-Ingest-SPTM-Decision">
    	<switch>
			<case to="VariableTypeClass-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_VariableTypeClass_DoFull') eq 'true'}</case>
            <default to="WorkInstructionProcedure-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="VariableTypeClass-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VariableTypeClass_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeClassID,VariableTypeClass,Description,Priority, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VariableTypeClass WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VariableTypeClass_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WorkInstructionProcedure-Ingest-SPTM-Decision"/>
        <error to="WorkInstructionProcedure-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WorkInstructionProcedure-Ingest-SPTM-Decision">
    	<switch>
			<case to="WorkInstructionProcedure-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WorkInstructionProcedure_DoFull') eq 'true'}</case>
            <default to="MachineStop-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="WorkInstructionProcedure-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WorkInstructionProcedure_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WorkInstructionProcedureID,WorkInstructionProcedure,WorkInstructionRef,PartID,IsEdited,FromDT,ToDT,RevisionNo,LoginID,ModifiedDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WorkInstructionProcedure WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WorkInstructionProcedure_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStop-Ingest-SPMM-Decision"/>
        <error to="MachineStop-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MachineStop-Ingest-SPMM-Decision">
    	<switch>
			<case to="MachineStop-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MachineStop_DoFull') eq 'true'}</case>
            <default to="End-Full-11-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="MachineStop-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MachineStop_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStop.MachineStopID, MachineStop.MachineStopReasonID, MachineStop.FromDT, MachineStop.ToDT, MachineStop.MachineStageID, MachineStop.IsEdited, MachineStop.RevisionNo, MachineStop_.StopComments, MachineStop_.StartComments, MachineStop_.StartLoginID, MachineStop_.StopLoginID, MachineStop_.OpenedStopDT, MachineStop_.SavedStopDT, MachineStop_.OpenedStartDT, MachineStop_.SavedStartDT, MachineStop_.OriginalLoginID, MachineStop_.EditedMachineStopID,  2 as "org_id",  'SPMM' as "org_name"  FROM MachineStop FULL JOIN MachineStop_ ON (MachineStop.MachineStopID = MachineStop_.MachineStopID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MachineStop_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-11-Ingest-Decision"/>
        <error to="End-Full-11-Ingest-Decision"/>
    </action>

	<end name="End-Full-11-Ingest-Decision"/>
</workflow-app>

<workflow-app name="Ingest-Full-11" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SP_PalletLabel-Ingest-SPMM-Decision"/>


	<decision name="_SP_PalletLabel-Ingest-SPMM-Decision">
    	<switch>
			<case to="_SP_PalletLabel-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER__SP_PalletLabel_DoFull') eq 'true'}</case>
            <default to="AcquisitionContext-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="_SP_PalletLabel-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER__SP_PalletLabel_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT _SP_PalletLabelID,PalletID,MachineStage,PartNumber,InvState,PalletNo,CreatedDT,CompleteDT,Quantity,LabelTemplate,PrinterURL,PrintedDT,ScannedDT,IsCancelled,IsReprint,PartDescription,LabelSaveDirectory,IsPrintLandscape,NoCopies,LabelsPerInventoryPack, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo._SP_PalletLabel WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER__SP_PalletLabel_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionContext-Ingest-SPTM-Decision"/>
        <error to="AcquisitionContext-Ingest-SPTM-Decision"/>
    </action>

	<decision name="AcquisitionContext-Ingest-SPTM-Decision">
    	<switch>
			<case to="AcquisitionContext-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AcquisitionContext_DoFull') eq 'true'}</case>
            <default to="Action-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionContext-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AcquisitionContext_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageID,AcquisitionVariantID,LastMeasurementSetID,AcquisitionContextID,LastDoneDT,IsAttrOC,IsCriticalDefect, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AcquisitionContext WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AcquisitionContext_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Action-Ingest-SPTM-Decision"/>
        <error to="Action-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Action-Ingest-SPTM-Decision">
    	<switch>
			<case to="Action-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Action_DoFull') eq 'true'}</case>
            <default to="Address-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Action-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Action_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionID,RfSpecialActionTypeID,ActionTypeID,ActionSubTypeID,ActionPlanID,ActionPlanCode,ActionName,Description,ActionOrder,RfPriorityID,SubmitterID,SubmittedDT,OwnerID,ActionStatusID,ClosedDT,ModifiedDT,LoginID,IsEdited,RevisionNo,DueDT,DeadlineDT,ExpiryDT,SortOrder, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Action WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Action_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Address-Ingest-SPTM-Decision"/>
        <error to="Address-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Address-Ingest-SPTM-Decision">
    	<switch>
			<case to="Address-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Address_DoFull') eq 'true'}</case>
            <default to="Attribute-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Address-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Address_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AddressID,Address1,Address2,City,County,PostCode,Country, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Address WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Address_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Attribute-Ingest-SPTM-Decision"/>
        <error to="Attribute-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Attribute-Ingest-SPTM-Decision">
    	<switch>
			<case to="Attribute-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Attribute_DoFull') eq 'true'}</case>
            <default to="BOMItem-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Attribute-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Attribute_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeID,AttributeTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Attribute WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Attribute_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BOMItem-Ingest-SPTM-Decision"/>
        <error to="BOMItem-Ingest-SPTM-Decision"/>
    </action>

	<decision name="BOMItem-Ingest-SPTM-Decision">
    	<switch>
			<case to="BOMItem-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_BOMItem_DoFull') eq 'true'}</case>
            <default to="Concern-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="BOMItem-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_BOMItem_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BOMItemID,BOMVariantID,PartID,SubPartID,SubPartQuantity,SubPartUnitID,RfInvPackTraceabilityID,Sequence,Instructions,RfBOMItemTypeID,IsDefault,IsAllowExceedBOMQty,Reference1,Reference2,Reference3,Reference4,Reference5, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.BOMItem WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_BOMItem_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Concern-Ingest-SPTM-Decision"/>
        <error to="Concern-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Concern-Ingest-SPTM-Decision">
    	<switch>
			<case to="Concern-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Concern_DoFull') eq 'true'}</case>
            <default to="Customer-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Concern-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Concern_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernID,ConcernStatusID,ConcernTypeID,RaisedDT,ClosedDT,SeverityID,DueDate,ConcernOwnerID,DepartmentOwnerID,CustomerID,CustomerContact,CustomerReference,AffectOnCustomer,PartTypeID,PartID,WOID,LineID,ProductionFromDT,ShiftID,QuantityAffected,QuantityUsed,InvIsolatedReasonID,Cost,LoginID,ModifiedDT,Concern,SubmitterLoginID,CustomerProduct,RfCurrencyID,MachineStageID,Reference1,Reference2,Reference3,RfConcernApplicationTypeID,HeadNo,ProductionToDT,QuantityFound,QuantityReturned,QuantityScrapped,QuantitySorted,SupplierID,ToolID,VariableTypeID,AttributeTypeID,ClosedByLoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Concern WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Concern_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Customer-Ingest-SPTM-Decision"/>
        <error to="Customer-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Customer-Ingest-SPTM-Decision">
    	<switch>
			<case to="Customer-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Customer_DoFull') eq 'true'}</case>
            <default to="dtproperties-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Customer-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Customer_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CustomerID,Customer,CustomerCode,AddressID,RfLanguageID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Customer WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Customer_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="dtproperties-Ingest-SPTM-Decision"/>
        <error to="dtproperties-Ingest-SPTM-Decision"/>
    </action>

	<decision name="dtproperties-Ingest-SPTM-Decision">
    	<switch>
			<case to="dtproperties-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_dtproperties_DoFull') eq 'true'}</case>
            <default to="GaugeType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="dtproperties-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_dtproperties_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT id,objectid,property,value,uvalue,lvalue,version, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.dtproperties WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_dtproperties_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="GaugeType-Ingest-SPTM-Decision"/>
        <error to="GaugeType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="GaugeType-Ingest-SPTM-Decision">
    	<switch>
			<case to="GaugeType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_GaugeType_DoFull') eq 'true'}</case>
            <default to="InvState-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="GaugeType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_GaugeType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT GaugeTypeID,GaugeType, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.GaugeType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_GaugeType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvState-Ingest-SPTT-Decision"/>
        <error to="InvState-Ingest-SPTT-Decision"/>
    </action>

	<decision name="InvState-Ingest-SPTT-Decision">
    	<switch>
			<case to="InvState-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_InvState_DoFull') eq 'true'}</case>
            <default to="LineSection-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="InvState-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InvState_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvStateID,InvState,Description,RfInvStateID,InvStateCode,IsAddToProduction,IsAddToHFI,IsDefault, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.InvState WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InvState_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineSection-Ingest-SPTM-Decision"/>
        <error to="LineSection-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LineSection-Ingest-SPTM-Decision">
    	<switch>
			<case to="LineSection-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LineSection_DoFull') eq 'true'}</case>
            <default to="LkConcernAction-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LineSection-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LineSection_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineSectionID,LineSection,Description,IsRetired, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LineSection WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LineSection_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkConcernAction-Ingest-SPTM-Decision"/>
        <error to="LkConcernAction-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkConcernAction-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkConcernAction-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkConcernAction_DoFull') eq 'true'}</case>
            <default to="LkDocumentAsset-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkConcernAction-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkConcernAction_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LKConcernActionID,ConcernID,ActionID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkConcernAction WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkConcernAction_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentAsset-Ingest-SPTM-Decision"/>
        <error to="LkDocumentAsset-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkDocumentAsset-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkDocumentAsset-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkDocumentAsset_DoFull') eq 'true'}</case>
            <default to="LkInvPackInvPack-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentAsset-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkDocumentAsset_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentAssetID,DocumentID,AssetID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkDocumentAsset WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkDocumentAsset_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkInvPackInvPack-Ingest-SPTM-Decision"/>
        <error to="LkInvPackInvPack-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkInvPackInvPack-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkInvPackInvPack-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkInvPackInvPack_DoFull') eq 'true'}</case>
            <default to="LkMGMS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkInvPackInvPack-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkInvPackInvPack_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkInvPackInvPackID,InventoryPackFromID,InventoryPackToID,RfInventoryLinkTypeID,LoginID,ModifiedDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkInvPackInvPack WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkInvPackInvPack_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMGMS-Ingest-SPTM-Decision"/>
        <error to="LkMGMS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkMGMS-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkMGMS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkMGMS_DoFull') eq 'true'}</case>
            <default to="LkPartDocument-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkMGMS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkMGMS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageID,MachineGroupID,LkMGMSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkMGMS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkMGMS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartDocument-Ingest-SPTM-Decision"/>
        <error to="LkPartDocument-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkPartDocument-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkPartDocument-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkPartDocument_DoFull') eq 'true'}</case>
            <default to="LkSPCCSVR-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartDocument-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkPartDocument_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartDocumentID,PartID,DocumentID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkPartDocument WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkPartDocument_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkSPCCSVR-Ingest-SPTM-Decision"/>
        <error to="LkSPCCSVR-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkSPCCSVR-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkSPCCSVR-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkSPCCSVR_DoFull') eq 'true'}</case>
            <default to="LkUCTGUCT-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkSPCCSVR-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkSPCCSVR_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCCalcStyleID,RfViolationRuleID,RfChartComponentID,LkSPCCSVRID,RuleRange,RuleGroup, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkSPCCSVR WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkSPCCSVR_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkUCTGUCT-Ingest-SPTM-Decision"/>
        <error to="LkUCTGUCT-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkUCTGUCT-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkUCTGUCT-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkUCTGUCT_DoFull') eq 'true'}</case>
            <default to="MachineStageCell-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkUCTGUCT-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkUCTGUCT_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkUCTGUCTID,UnitCountTypeGroupID,UnitCountTypeID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkUCTGUCT WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkUCTGUCT_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageCell-Ingest-SPTM-Decision"/>
        <error to="MachineStageCell-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStageCell-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStageCell-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStageCell_DoFull') eq 'true'}</case>
            <default to="MachineStopReason-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageCell-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStageCell_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageCellID,MachineStageID,IsCreator,IsConsumer,IsLabeller,IsAutoBatchNo,IsPackConsumer,IsResortConsumer,IsNonJob,IsToolShowCavities,IsInvPackPackNo,IsInvPackPartNo,IsInvPackPartDesc,IsInvPackPartType,IsInvPackQty,IsInvPackHeader,IsInvPackRows,IsInvPackState,IsInvPackReason,IsAcqDblck,AcqGrid,CustomPage,IsClickable,IsDrillable, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStageCell WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStageCell_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopReason-Ingest-SPTM-Decision"/>
        <error to="MachineStopReason-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStopReason-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStopReason-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStopReason_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedure-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStopReason-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStopReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonID,StopReason,Description,MachineStageTypeID,IsPlanned,StopCode,RfMachineStopClassID,RfLineStopReasonTypeID,MachineStopCategoryID,IsRetired, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStopReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStopReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedure-Ingest-SPTM-Decision"/>
        <error to="MaintenanceProcedure-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceProcedure-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceProcedure-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceProcedure_DoFull') eq 'true'}</case>
            <default to="MaintenanceWork-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedure-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceProcedure_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureID,MaintenanceProcedure,PartID,ResponsibleDepartmentID,BudgetWorkDone,PlannedManHours,PlannedDuration,MaintenanceProcedureCode,AdvanceWarningPeriod,SchedulingWindow,PlannedMachineStageDowntime,PlannedLineDowntime,SubPartID,CreatedDT,CreatedLoginID,RfMaintenanceWorkTypeID,CostCentreID,IsAutoAuthoriseWork,IsRetired,IsToolTakenOutOfService, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceProcedure WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceProcedure_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWork-Ingest-SPTM-Decision"/>
        <error to="MaintenanceWork-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceWork-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceWork-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceWork_DoFull') eq 'true'}</case>
            <default to="MeasurementSetP-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWork-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceWork_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkID,MaintenanceWO,AssetID,MaintenanceProcedureID,MaintenanceProcedureRevisionID,MaintProcScheduleOnAssetID,RfMaintenanceWorkTypeID,AdhocWorkToDo,MaintProcScheduleOnAssetNo,MaintenanceWorkStatusID,ActualStartDT,ActualEndDT,ActualManHours,PlannedStartDT,PlannedEndDT,PlannedManHours,OwnerLoginID,ActualLabourCost,PlannedLabourCost,RfCurrencyID,PartsCost,LineDownCost,Priority,MaintenanceReasonID,IsPlannedDateLockedByUser,EBATriggerID,PeriodDueDT,RunHoursDueDT,PartsBasedDueDT,EventDueDT,ReleasedDT,ReleasedLoginID,IsEdited,RevisionNo,AbsoluteCounterThreshold, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceWork WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceWork_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSetP-Ingest-SPTM-Decision"/>
        <error to="MeasurementSetP-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MeasurementSetP-Ingest-SPTM-Decision">
    	<switch>
			<case to="MeasurementSetP-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MeasurementSetP_DoFull') eq 'true'}</case>
            <default to="OPCCounter-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MeasurementSetP-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MeasurementSetP_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetPID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MeasurementSetP WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MeasurementSetP_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCCounter-Ingest-SPTM-Decision"/>
        <error to="OPCCounter-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCCounter-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCCounter-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCCounter_DoFull') eq 'true'}</case>
            <default to="OPCMachineEventCode-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCCounter-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCCounter_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCCounterID,OPCItemID,Description,LoValue,HiValue,Scale,Offset,Formula,UnitCountTypeID,ScrapReasonID,ModifiedDT,LoginID,IsProduction,AcceptableRateOfChange,RfDeltaValueModeID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCCounter WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCCounter_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCMachineEventCode-Ingest-SPTM-Decision"/>
        <error to="OPCMachineEventCode-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCMachineEventCode-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCMachineEventCode-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCMachineEventCode_DoFull') eq 'true'}</case>
            <default to="OperationType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCMachineEventCode-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCMachineEventCode_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCMachineEventCodeID,OPCMachineEventCode,OPCMachineEventID,MachineStopReasonID,IsRunning, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCMachineEventCode WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCMachineEventCode_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OperationType-Ingest-SPTM-Decision"/>
        <error to="OperationType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OperationType-Ingest-SPTM-Decision">
    	<switch>
			<case to="OperationType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OperationType_DoFull') eq 'true'}</case>
            <default to="Product-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OperationType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OperationType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OperationTypeID,OperationType,OperationTypeCode,Description,PartTypeID,Sequence,IsOptional, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OperationType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OperationType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Product-Ingest-SPTM-Decision"/>
        <error to="Product-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Product-Ingest-SPTM-Decision">
    	<switch>
			<case to="Product-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Product_DoFull') eq 'true'}</case>
            <default to="RootCauseType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Product-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Product_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductID,ProductTypeID,Name,Description,IsRetired,PartID,Variant1,Variant2,Variant3,Variant4,Variant5,Variant6,Variant7,Variant8,Variant9,Variant10,Variant11,Variant12,Variant13,Variant14,Variant15,Variant16,Variant17,Variant18,Variant19,Variant20, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Product WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Product_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="RootCauseType-Ingest-SPTM-Decision"/>
        <error to="RootCauseType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="RootCauseType-Ingest-SPTM-Decision">
    	<switch>
			<case to="RootCauseType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_RootCauseType_DoFull') eq 'true'}</case>
            <default to="SettingsPlantNameTemplates-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="RootCauseType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_RootCauseType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RootCauseTypeID,RootCauseType,Description,RootCauseTypeCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.RootCauseType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_RootCauseType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SettingsPlantNameTemplates-Ingest-SPTM-Decision"/>
        <error to="SettingsPlantNameTemplates-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SettingsPlantNameTemplates-Ingest-SPTM-Decision">
    	<switch>
			<case to="SettingsPlantNameTemplates-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SettingsPlantNameTemplates_DoFull') eq 'true'}</case>
            <default to="ShiftType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SettingsPlantNameTemplates-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SettingsPlantNameTemplates_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SettingsPlantNameTemplatesID,CreateInvPackNoTemplate,CustomerUniqueKeyTemplate,InventoryPackNameTemplate,WONumberTemplate,ReceiveInvPackNoTemplate,BOMVariantTemplate, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SettingsPlantNameTemplates WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SettingsPlantNameTemplates_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftType-Ingest-SPTM-Decision"/>
        <error to="ShiftType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ShiftType-Ingest-SPTM-Decision">
    	<switch>
			<case to="ShiftType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ShiftType_DoFull') eq 'true'}</case>
            <default to="SPCChartSetView-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ShiftType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ShiftType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftTypeID,Name,Description,IsNonWorking, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ShiftType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ShiftType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartSetView-Ingest-SPTM-Decision"/>
        <error to="SPCChartSetView-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCChartSetView-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCChartSetView-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCChartSetView_DoFull') eq 'true'}</case>
            <default to="SPCVarChart-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartSetView-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCChartSetView_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetViewID,SPCChartSetView,Sequence,SPCChartSetID,RfChartSetViewTypeID,NoCols,NoRows,Caption,Tooltip,IsAggregated,RfCutByIDs,IsPanelled,ImageURI,GridImageRender,ParetoXAxis,ParetoStackBy,SPCChartSetViewStyleID,IsAutoFit,OverlayFlags, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCChartSetView WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCChartSetView_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCVarChart-Ingest-SPTM-Decision"/>
        <error to="SPCVarChart-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCVarChart-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCVarChart-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCVarChart_DoFull') eq 'true'}</case>
            <default to="TagListValue-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCVarChart-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCVarChart_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCVarChartID,SPCRuleID,ProductID,AcquisitionID,MachineStageID,VariableTypeID,RfAttributeClassID,HeadNo,RfAcquisitionClassID,TrendStartMSID,TAGMSTYPE1ID,ATTRIBUTETYPEID,TAGMSVALUE1,CreateDT,LoginID,IsMsetInsert, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCVarChart WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCVarChart_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagListValue-Ingest-SPTM-Decision"/>
        <error to="TagListValue-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagListValue-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagListValue-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagListValue_DoFull') eq 'true'}</case>
            <default to="TagTreeNodeImgLoc-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagListValue-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagListValue_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagListValueID,TagListID,TagListValue,DisplayOrder,IsRetired, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagListValue WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagListValue_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagTreeNodeImgLoc-Ingest-SPTM-Decision"/>
        <error to="TagTreeNodeImgLoc-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagTreeNodeImgLoc-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagTreeNodeImgLoc-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagTreeNodeImgLoc_DoFull') eq 'true'}</case>
            <default to="Tool-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagTreeNodeImgLoc-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagTreeNodeImgLoc_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagTreeNodeImgLocID,TagTreeNodeID,X,Y,Width,Height,MappedTagTreeNodeID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagTreeNodeImgLoc WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagTreeNodeImgLoc_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool-Ingest-SPTM-Decision"/>
        <error to="Tool-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Tool-Ingest-SPTM-Decision">
    	<switch>
			<case to="Tool-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Tool_DoFull') eq 'true'}</case>
            <default to="ToolChangeReason-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Tool-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Tool_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID,Tool,ToolSet,Description,ToolTypeID,IsRetired,NoCavities,Variant1,Variant2,Variant3,Variant4,Variant5,Variant6,Variant7,Variant8,Variant9,Variant10,Variant11,Variant12,Variant13,Variant14,Variant15,PartID,Variant16,Variant17,Variant18,Variant19,Variant20, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Tool WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Tool_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolChangeReason-Ingest-SPTM-Decision"/>
        <error to="ToolChangeReason-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolChangeReason-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolChangeReason-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolChangeReason_DoFull') eq 'true'}</case>
            <default to="Unit-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolChangeReason-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolChangeReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolChangeReasonID,ToolTypeID,ChangeReason,Description,ChangeToRfToolStatusID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolChangeReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolChangeReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Unit-Ingest-SPTM-Decision"/>
        <error to="Unit-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Unit-Ingest-SPTM-Decision">
    	<switch>
			<case to="Unit-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Unit_DoFull') eq 'true'}</case>
            <default to="VarChartOC-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Unit-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Unit_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitID,Unit,Description, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Unit WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Unit_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarChartOC-Ingest-SPTM-Decision"/>
        <error to="VarChartOC-Ingest-SPTM-Decision"/>
    </action>

	<decision name="VarChartOC-Ingest-SPTM-Decision">
    	<switch>
			<case to="VarChartOC-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_VarChartOC_DoFull') eq 'true'}</case>
            <default to="VarMeasurementP-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="VarChartOC-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarChartOC_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarChartOCID,MeasurementSetID,SPCChartControlLimitID,SubgroupID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarChartOC WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarChartOC_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurementP-Ingest-SPTM-Decision"/>
        <error to="VarMeasurementP-Ingest-SPTM-Decision"/>
    </action>

	<decision name="VarMeasurementP-Ingest-SPTM-Decision">
    	<switch>
			<case to="VarMeasurementP-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurementP_DoFull') eq 'true'}</case>
            <default to="WorkInstructionResult-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="VarMeasurementP-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurementP_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementPID,SpecID,MeasurementSetPID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurementP WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurementP_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WorkInstructionResult-Ingest-SPTM-Decision"/>
        <error to="WorkInstructionResult-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WorkInstructionResult-Ingest-SPTM-Decision">
    	<switch>
			<case to="WorkInstructionResult-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WorkInstructionResult_DoFull') eq 'true'}</case>
            <default to="MachineStop-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="WorkInstructionResult-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WorkInstructionResult_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WorkInstructionResultID,WorkInstructionStepID,OperationID,DT,Comments,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WorkInstructionResult WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WorkInstructionResult_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStop-Ingest-SPMM-Decision"/>
        <error to="MachineStop-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MachineStop-Ingest-SPMM-Decision">
    	<switch>
			<case to="MachineStop-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MachineStop_DoFull') eq 'true'}</case>
            <default to="End-Full-11-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="MachineStop-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MachineStop_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStop.MachineStopID, MachineStop.MachineStopReasonID, MachineStop.FromDT, MachineStop.ToDT, MachineStop.MachineStageID, MachineStop.IsEdited, MachineStop.RevisionNo, MachineStop_.StopComments, MachineStop_.StartComments, MachineStop_.StartLoginID, MachineStop_.StopLoginID, MachineStop_.OpenedStopDT, MachineStop_.SavedStopDT, MachineStop_.OpenedStartDT, MachineStop_.SavedStartDT, MachineStop_.OriginalLoginID, MachineStop_.EditedMachineStopID,  2 as "org_id",  'SPMM' as "org_name"  FROM MachineStop FULL JOIN MachineStop_ ON (MachineStop.MachineStopID = MachineStop_.MachineStopID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MachineStop_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-11-Ingest-Decision"/>
        <error to="End-Full-11-Ingest-Decision"/>
    </action>

	<end name="End-Full-11-Ingest-Decision"/>
</workflow-app>

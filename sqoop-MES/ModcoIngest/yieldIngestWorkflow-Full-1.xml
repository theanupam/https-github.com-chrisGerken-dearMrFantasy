<workflow-app name="Ingest-Full-1" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SP_LkInvIsolatedReasonMST-Ingest-SPMM-Decision"/>


	<decision name="_SP_LkInvIsolatedReasonMST-Ingest-SPMM-Decision">
    	<switch>
			<case to="_SP_LkInvIsolatedReasonMST-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER__SP_LkInvIsolatedReasonMST_DoFull') eq 'true'}</case>
            <default to="AcquisitionChain-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="_SP_LkInvIsolatedReasonMST-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER__SP_LkInvIsolatedReasonMST_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkInvIsolatedReasonMSTID,InvIsolatedReasonID,MachineStageTypeID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo._SP_LkInvIsolatedReasonMST WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER__SP_LkInvIsolatedReasonMST_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionChain-Ingest-SPTT-Decision"/>
        <error to="AcquisitionChain-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AcquisitionChain-Ingest-SPTT-Decision">
    	<switch>
			<case to="AcquisitionChain-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AcquisitionChain_DoFull') eq 'true'}</case>
            <default to="AcquisitionVariant_-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionChain-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AcquisitionChain_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionChainID,AcquisitionChain,Description, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AcquisitionChain WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AcquisitionChain_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionVariant_-Ingest-SPTT-Decision"/>
        <error to="AcquisitionVariant_-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AcquisitionVariant_-Ingest-SPTT-Decision">
    	<switch>
			<case to="AcquisitionVariant_-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AcquisitionVariant__DoFull') eq 'true'}</case>
            <default to="ActionType-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionVariant_-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AcquisitionVariant__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionVariantID,FromDT,ToDT,DataEntryURI,SPCURI,AcquisitionImageURI,LoginID,ModifiedDT,Comments,Instructions,PartID,Variant1,Variant2,Variant3,Variant4,Variant5,Variant6,Variant7,Variant8,Variant9,Variant10,Variant11,Variant12,Variant13,Variant14,Variant15,ToolTypeID,NoCavities,Documents,IsSuspendable,IsRotatableStepPlan,EBAReference,Variant16,Variant17,Variant18,Variant19,Variant20, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AcquisitionVariant_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AcquisitionVariant__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionType-Ingest-SPTT-Decision"/>
        <error to="ActionType-Ingest-SPTT-Decision"/>
    </action>

	<decision name="ActionType-Ingest-SPTT-Decision">
    	<switch>
			<case to="ActionType-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_ActionType_DoFull') eq 'true'}</case>
            <default to="AssetLevel-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="ActionType-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_ActionType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionTypeID,ActionType,Description,ActionTypeCode,ReportOrder,Format, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.ActionType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_ActionType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AssetLevel-Ingest-SPTT-Decision"/>
        <error to="AssetLevel-Ingest-SPTT-Decision"/>
    </action>

	<decision name="AssetLevel-Ingest-SPTT-Decision">
    	<switch>
			<case to="AssetLevel-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_AssetLevel_DoFull') eq 'true'}</case>
            <default to="BOMExplosion-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="AssetLevel-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_AssetLevel_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetLevelID,AssetID,SubAssetID,Sequence,Comments,FromDT, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.AssetLevel WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_AssetLevel_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BOMExplosion-Ingest-SPTT-Decision"/>
        <error to="BOMExplosion-Ingest-SPTT-Decision"/>
    </action>

	<decision name="BOMExplosion-Ingest-SPTT-Decision">
    	<switch>
			<case to="BOMExplosion-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_BOMExplosion_DoFull') eq 'true'}</case>
            <default to="CommonFault-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="BOMExplosion-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_BOMExplosion_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,ParentPartID,SubPartID,BOMItemID,SubPartQuantityTotal,SubPartUnitID,RfInvPackTraceabilityID,Lvl,SortOrder,SubPartQuantity,BOMVariantID,Instructions,RfBOMItemTypeID,IsAllowExceedBOMQty, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.BOMExplosion WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_BOMExplosion_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="CommonFault-Ingest-SPTT-Decision"/>
        <error to="CommonFault-Ingest-SPTT-Decision"/>
    </action>

	<decision name="CommonFault-Ingest-SPTT-Decision">
    	<switch>
			<case to="CommonFault-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_CommonFault_DoFull') eq 'true'}</case>
            <default to="CrnAdapter-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="CommonFault-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_CommonFault_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CommonFaultID,CommonFault,Description,LineTypeID,MachineStageTypeID,ToolTypeID,GaugeTypeID,PartTypeID,RfAssetTypeID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.CommonFault WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_CommonFault_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="CrnAdapter-Ingest-SPTT-Decision"/>
        <error to="CrnAdapter-Ingest-SPTT-Decision"/>
    </action>

	<decision name="CrnAdapter-Ingest-SPTT-Decision">
    	<switch>
			<case to="CrnAdapter-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_CrnAdapter_DoFull') eq 'true'}</case>
            <default to="dtproperties-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="CrnAdapter-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_CrnAdapter_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CrnAdapterID,Length,ModifiedDT, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.CrnAdapter WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_CrnAdapter_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="dtproperties-Ingest-SPMM-Decision"/>
        <error to="dtproperties-Ingest-SPMM-Decision"/>
    </action>

	<decision name="dtproperties-Ingest-SPMM-Decision">
    	<switch>
			<case to="dtproperties-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_dtproperties_DoFull') eq 'true'}</case>
            <default to="IndividualDefect-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="dtproperties-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_dtproperties_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT id,objectid,property,value,uvalue,lvalue,version, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.dtproperties WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_dtproperties_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="IndividualDefect-Ingest-SPTT-Decision"/>
        <error to="IndividualDefect-Ingest-SPTT-Decision"/>
    </action>

	<decision name="IndividualDefect-Ingest-SPTT-Decision">
    	<switch>
			<case to="IndividualDefect-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_IndividualDefect_DoFull') eq 'true'}</case>
            <default to="LineGroup-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="IndividualDefect-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_IndividualDefect_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT IndividualDefectID,PartInstanceID,Ignored,DefectCount,MeasurementSetID,AttributeTypeID,ProductID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.IndividualDefect WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_IndividualDefect_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineGroup-Ingest-SPTT-Decision"/>
        <error to="LineGroup-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LineGroup-Ingest-SPTT-Decision">
    	<switch>
			<case to="LineGroup-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LineGroup_DoFull') eq 'true'}</case>
            <default to="LkATATG-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LineGroup-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LineGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineGroupID,LineGroup,LineGroupCode,Description,OEETarget,WasteTarget,Reference1,Reference2,Reference3,Reference4,Reference5, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LineGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LineGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkATATG-Ingest-SPMM-Decision"/>
        <error to="LkATATG-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkATATG-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkATATG-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkATATG_DoFull') eq 'true'}</case>
            <default to="LKCSetCDef-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkATATG-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkATATG_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeGroupID,AttributeTypeID,LkATATGID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkATATG WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkATATG_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKCSetCDef-Ingest-SPMM-Decision"/>
        <error to="LKCSetCDef-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LKCSetCDef-Ingest-SPMM-Decision">
    	<switch>
			<case to="LKCSetCDef-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LKCSetCDef_DoFull') eq 'true'}</case>
            <default to="LkDocumentWIStep-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LKCSetCDef-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LKCSetCDef_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetID,SPCChartDefID,Sequence,LkCSetCDefID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LKCSetCDef WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LKCSetCDef_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentWIStep-Ingest-SPMM-Decision"/>
        <error to="LkDocumentWIStep-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkDocumentWIStep-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkDocumentWIStep-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkDocumentWIStep_DoFull') eq 'true'}</case>
            <default to="LkMachineStagePrinter-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentWIStep-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkDocumentWIStep_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentWIStepID,WorkInstructionStepID,DocumentID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkDocumentWIStep WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkDocumentWIStep_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMachineStagePrinter-Ingest-SPTT-Decision"/>
        <error to="LkMachineStagePrinter-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkMachineStagePrinter-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkMachineStagePrinter-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkMachineStagePrinter_DoFull') eq 'true'}</case>
            <default to="LkOpTPartTConsumed-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkMachineStagePrinter-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkMachineStagePrinter_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkMachineStagePrinterID,MachineStageID,PrinterID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkMachineStagePrinter WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkMachineStagePrinter_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkOpTPartTConsumed-Ingest-SPTT-Decision"/>
        <error to="LkOpTPartTConsumed-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkOpTPartTConsumed-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkOpTPartTConsumed-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkOpTPartTConsumed_DoFull') eq 'true'}</case>
            <default to="LKShiftMachineStage-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkOpTPartTConsumed-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkOpTPartTConsumed_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartTypeID,OperationTypeID,IsInventoryCarriedOver,LkOpTPartTConsumedID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkOpTPartTConsumed WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkOpTPartTConsumed_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKShiftMachineStage-Ingest-SPTM-Decision"/>
        <error to="LKShiftMachineStage-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LKShiftMachineStage-Ingest-SPTM-Decision">
    	<switch>
			<case to="LKShiftMachineStage-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LKShiftMachineStage_DoFull') eq 'true'}</case>
            <default to="LkTTG-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LKShiftMachineStage-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LKShiftMachineStage_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkShiftMachineStageID,MachineStageID,ShiftID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LKShiftMachineStage WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LKShiftMachineStage_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkTTG-Ingest-SPTM-Decision"/>
        <error to="LkTTG-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkTTG-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkTTG-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkTTG_DoFull') eq 'true'}</case>
            <default to="MachineGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkTTG-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkTTG_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolGroupID,ToolID,LkTTGID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkTTG WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkTTG_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineGroup-Ingest-SPTM-Decision"/>
        <error to="MachineGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineGroup_DoFull') eq 'true'}</case>
            <default to="MachineStopCategory-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineGroupID,MachineGroup,Description,IsRetired,RfMachineGroupTypeID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopCategory-Ingest-SPTM-Decision"/>
        <error to="MachineStopCategory-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStopCategory-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStopCategory-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStopCategory_DoFull') eq 'true'}</case>
            <default to="MaintenancePartUsed-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStopCategory-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStopCategory_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopCategoryID,MachineStopCategory,Description,MachineStageTypeID,StopCategoryCode,DisplayOrder, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStopCategory WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStopCategory_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenancePartUsed-Ingest-SPTM-Decision"/>
        <error to="MaintenancePartUsed-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenancePartUsed-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenancePartUsed-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenancePartUsed_DoFull') eq 'true'}</case>
            <default to="MaintenanceReason-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenancePartUsed-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenancePartUsed_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenancePartUsedID,MaintenanceWorkID,MaintenanceProcedureResultID,PartID,Cost,DT,LoginID,Quantity,UnitID,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenancePartUsed WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenancePartUsed_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceReason-Ingest-SPTM-Decision"/>
        <error to="MaintenanceReason-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceReason-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceReason-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceReason_DoFull') eq 'true'}</case>
            <default to="MeasurementSetRequired-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceReason-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceReasonID,MaintenanceReason, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSetRequired-Ingest-SPTM-Decision"/>
        <error to="MeasurementSetRequired-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MeasurementSetRequired-Ingest-SPTM-Decision">
    	<switch>
			<case to="MeasurementSetRequired-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MeasurementSetRequired_DoFull') eq 'true'}</case>
            <default to="OPCDigital-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MeasurementSetRequired-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MeasurementSetRequired_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetRequiredID,EBATriggerID,AcquisitionContextID,MeasurementSetID,RfAcquisitionStatusID,SubmittedDT,DueDT,DeadlineDT,ExpiryDT,OwnerID,ActionID,JobID,PartID,AssignedLoginID,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MeasurementSetRequired WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MeasurementSetRequired_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCDigital-Ingest-SPTM-Decision"/>
        <error to="OPCDigital-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCDigital-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCDigital-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCDigital_DoFull') eq 'true'}</case>
            <default to="OPCParameter-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCDigital-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCDigital_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCDigitalID,OPCItemID,Description,Formula,VariableTypeID,HeadNo,SampleNo,PositionNo,ModifiedDT,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCDigital WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCDigital_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCParameter-Ingest-SPTM-Decision"/>
        <error to="OPCParameter-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCParameter-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCParameter-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCParameter_DoFull') eq 'true'}</case>
            <default to="PartSubClassification-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="OPCParameter-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCParameter_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCParameterID,OPCItemID,Description,Scale,Offset,Formula,VariableTypeID,HeadNo,SampleNo,PositionNo,ModifiedDT,LoginID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCParameter WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCParameter_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartSubClassification-Ingest-SPMX-Decision"/>
        <error to="PartSubClassification-Ingest-SPMX-Decision"/>
    </action>

	<decision name="PartSubClassification-Ingest-SPMX-Decision">
    	<switch>
			<case to="PartSubClassification-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_PartSubClassification_DoFull') eq 'true'}</case>
            <default to="ProductionStopReason-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="PartSubClassification-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_PartSubClassification_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartSubClassificationID,PartSubClassification,PartClassificationID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.PartSubClassification WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_PartSubClassification_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductionStopReason-Ingest-SPTM-Decision"/>
        <error to="ProductionStopReason-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ProductionStopReason-Ingest-SPTM-Decision">
    	<switch>
			<case to="ProductionStopReason-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ProductionStopReason_DoFull') eq 'true'}</case>
            <default to="ScrapReason-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ProductionStopReason-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ProductionStopReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductionStopReasonID,ProductionStopReason,Description,StopCode,RfLineStopReasonTypeID,RfStopRelativeToJobID,IsPlanned,IsDefaultNoJobReason,IsRetired, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ProductionStopReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ProductionStopReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ScrapReason-Ingest-SPTM-Decision"/>
        <error to="ScrapReason-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ScrapReason-Ingest-SPTM-Decision">
    	<switch>
			<case to="ScrapReason-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ScrapReason_DoFull') eq 'true'}</case>
            <default to="ShiftlyChecksDone-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ScrapReason-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ScrapReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ScrapReasonID,ScrapReason,Description,MachineStageTypeID,DefaultUnitID,IsRetired, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ScrapReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ScrapReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftlyChecksDone-Ingest-SPTM-Decision"/>
        <error to="ShiftlyChecksDone-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ShiftlyChecksDone-Ingest-SPTM-Decision">
    	<switch>
			<case to="ShiftlyChecksDone-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ShiftlyChecksDone_DoFull') eq 'true'}</case>
            <default to="SPCChartControlLimit-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ShiftlyChecksDone-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ShiftlyChecksDone_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftlyChecksDoneID,shiftid,jobid,fromdt,todt,partid,acquisitioncontextid,machinestageid,acquisitionvariantid,acquisitionid,downtime,uptime,total_time,datacollectionperiod,checks_req,checks_req_after_downtime,checks_done,updated_dt, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ShiftlyChecksDone WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ShiftlyChecksDone_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartControlLimit-Ingest-SPTM-Decision"/>
        <error to="SPCChartControlLimit-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCChartControlLimit-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCChartControlLimit-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCChartControlLimit_DoFull') eq 'true'}</case>
            <default to="SPCDefaultView-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartControlLimit-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCChartControlLimit_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartControlLimitID,SPCChartComponentID,RfChartComponentID,RfChart,UCL,CL,LCL,FromDT,ToDT,RangeToDT,ModifiedDT,LoginID,RangeFromDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCChartControlLimit WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCChartControlLimit_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCDefaultView-Ingest-SPTM-Decision"/>
        <error to="SPCDefaultView-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCDefaultView-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCDefaultView-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCDefaultView_DoFull') eq 'true'}</case>
            <default to="TagDef-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCDefaultView-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCDefaultView_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCDefaultViewID,Sequence,RfChartSetViewTypeID,NoCols,NoRows,Caption,Tooltip,IsAggregated,RfCutByIDs,IsPanelled,ImageURI,GridImageRender,ParetoXAxis,ParetoStackBy,SPCChartSetViewStyleID,IsAutoFit,AcquisitionUsageID,OverlayFlags, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCDefaultView WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCDefaultView_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagDef-Ingest-SPTM-Decision"/>
        <error to="TagDef-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagDef-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagDef-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagDef_DoFull') eq 'true'}</case>
            <default to="TagTreeNode-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagDef-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagDef_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagDefID,TagOwnerID,RfTable,TagTypeID,TagValue,DT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagDef WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagDef_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagTreeNode-Ingest-SPTM-Decision"/>
        <error to="TagTreeNode-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagTreeNode-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagTreeNode-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagTreeNode_DoFull') eq 'true'}</case>
            <default to="TMP_Jobs_In_Shifts-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagTreeNode-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagTreeNode_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagTreeNodeID,TagTreeNode,TagTreeID,ParentTagTreeNodeID,Depth,SortOrder,ImageURI,NoCols,NoRows,SortExpression,ImageWidth,ImageHeight, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagTreeNode WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagTreeNode_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TMP_Jobs_In_Shifts-Ingest-SPTM-Decision"/>
        <error to="TMP_Jobs_In_Shifts-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TMP_Jobs_In_Shifts-Ingest-SPTM-Decision">
    	<switch>
			<case to="TMP_Jobs_In_Shifts-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TMP_Jobs_In_Shifts_DoFull') eq 'true'}</case>
            <default to="ToolCavityStateReason-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TMP_Jobs_In_Shifts-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TMP_Jobs_In_Shifts_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftID,MachineStageID,JobID,PartID,FromDT,ToDT,Downtime,Total_Time,Uptime, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TMP_Jobs_In_Shifts WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TMP_Jobs_In_Shifts_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolCavityStateReason-Ingest-SPTM-Decision"/>
        <error to="ToolCavityStateReason-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolCavityStateReason-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolCavityStateReason-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolCavityStateReason_DoFull') eq 'true'}</case>
            <default to="ToolUsage_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolCavityStateReason-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolCavityStateReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolCavityStateReasonID,ToolTypeID,ToolCavityStateReason,Description,CavityStatusCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolCavityStateReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolCavityStateReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolUsage_-Ingest-SPTM-Decision"/>
        <error to="ToolUsage_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolUsage_-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolUsage_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolUsage__DoFull') eq 'true'}</case>
            <default to="Variable-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolUsage_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolUsage__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolUsageID,StartUsingComments,ToolChangeComments,StartLoginID,ChangeLoginID,OpenedStartDT,OpenedChangeDT,SavedStartDT,SavedChangeDT,OriginalLoginID,EditedToolUsageID,Reference1,Reference2,Reference3,Reference4,Reference5, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolUsage_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolUsage__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Variable-Ingest-SPTM-Decision"/>
        <error to="Variable-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Variable-Ingest-SPTM-Decision">
    	<switch>
			<case to="Variable-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Variable_DoFull') eq 'true'}</case>
            <default to="WO_custom-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Variable-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Variable_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableID,VariableTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Variable WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Variable_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO_custom-Ingest-SPTM-Decision"/>
        <error to="WO_custom-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WO_custom-Ingest-SPTM-Decision">
    	<switch>
			<case to="WO_custom-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WO_custom_DoFull') eq 'true'}</case>
            <default to="Location-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="WO_custom-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WO_custom_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WOID,BaseWONumber,Txn_date,Wip_Entity_ID,Alternate_Bom,WO_Status,IsBtoCto, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WO_custom WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WO_custom_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Location-Ingest-SPMM-Decision"/>
        <error to="Location-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Location-Ingest-SPMM-Decision">
    	<switch>
			<case to="Location-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Location_DoFull') eq 'true'}</case>
            <default to="End-Full-1-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="Location-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Location_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Location.LocationID, Location.Location, Location.LocationTypeID, Location.IsRetired, Location.MaxQuantity, Location.LocationCode, Location.Description, LocationType.LocationType, LocationType.LocationTypeCode,  2 as "org_id",  'SPMM' as "org_name"  FROM Location FULL JOIN LocationType ON (Location.LocationID = LocationType.LocationTypeID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Location_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-1-Ingest-Decision"/>
        <error to="End-Full-1-Ingest-Decision"/>
    </action>

	<end name="End-Full-1-Ingest-Decision"/>
</workflow-app>

<workflow-app name="Ingest-Full-21" xmlns="uri:oozie:workflow:0.1">

 	<start to="AcqCtxVarClass-Ingest-SPTM-Decision"/>


	<decision name="AcqCtxVarClass-Ingest-SPTM-Decision">
    	<switch>
			<case to="AcqCtxVarClass-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AcqCtxVarClass_DoFull') eq 'true'}</case>
            <default to="AcquisitionGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AcqCtxVarClass-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AcqCtxVarClass_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcqCtxVarClassID,AcquisitionContextID,VariableTypeClassID,IsOS,IsOC, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AcqCtxVarClass WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AcqCtxVarClass_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionGroup-Ingest-SPTM-Decision"/>
        <error to="AcquisitionGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="AcquisitionGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="AcquisitionGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AcquisitionGroup_DoFull') eq 'true'}</case>
            <default to="ActionPlan-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AcquisitionGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionGroupID,AcquisitionGroup,Description,AcquisitionGroupCode,LoginID,ModifiedDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AcquisitionGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AcquisitionGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionPlan-Ingest-SPTM-Decision"/>
        <error to="ActionPlan-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ActionPlan-Ingest-SPTM-Decision">
    	<switch>
			<case to="ActionPlan-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ActionPlan_DoFull') eq 'true'}</case>
            <default to="AssetCountType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ActionPlan-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ActionPlan_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionPlanID,RfSpecialActionTypeID,ActionTypeID,ActionSubTypeID,ActionPlanCode,ActionName,Description,ActionPlanOrder,RfPriorityID,IsRetired,VariableTypeID,AttributeTypeID,IsCompulsory,SortOrder,IsOCApplicable,IsOSApplicable, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ActionPlan WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ActionPlan_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AssetCountType-Ingest-SPTM-Decision"/>
        <error to="AssetCountType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="AssetCountType-Ingest-SPTM-Decision">
    	<switch>
			<case to="AssetCountType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AssetCountType_DoFull') eq 'true'}</case>
            <default to="AttributeTypeGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AssetCountType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AssetCountType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetCountTypeID,AssetCountType,Description, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AssetCountType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AssetCountType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AttributeTypeGroup-Ingest-SPTM-Decision"/>
        <error to="AttributeTypeGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="AttributeTypeGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="AttributeTypeGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_AttributeTypeGroup_DoFull') eq 'true'}</case>
            <default to="CauseAction-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="AttributeTypeGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_AttributeTypeGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeGroupID,Name,Description,AttributeTypeGroupCode, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.AttributeTypeGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_AttributeTypeGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="CauseAction-Ingest-SPTM-Decision"/>
        <error to="CauseAction-Ingest-SPTM-Decision"/>
    </action>

	<decision name="CauseAction-Ingest-SPTM-Decision">
    	<switch>
			<case to="CauseAction-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_CauseAction_DoFull') eq 'true'}</case>
            <default to="ConcernType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="CauseAction-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_CauseAction_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CauseActionID,MeasurementSetID,IsAttributes,IndividualDefectID,AttributeTypeID,Cause,Action,DT,VarChartOCID,RfIsOSID,VarMeasurementID,VariableTypeID,IsEdited,RevisionNo,ProductID,AcquisitionID,MachineStageID,RfAttributeClassID,HeadNo,SampleNo,PositionNo,RfAcquisitionClassID,SPCChartComponentID,SPCRuleID,RfCauseActionStateID,TAGMSVALUE1,TAGMSTYPE1ID,CreateDT,AcknowledgeDT,CloseDT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.CauseAction WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_CauseAction_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ConcernType-Ingest-SPTM-Decision"/>
        <error to="ConcernType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ConcernType-Ingest-SPTM-Decision">
    	<switch>
			<case to="ConcernType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ConcernType_DoFull') eq 'true'}</case>
            <default to="DefectCountP-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ConcernType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ConcernType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernTypeID,ConcernType,Description,ConcernTypeCode,Format, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ConcernType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ConcernType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCountP-Ingest-SPTM-Decision"/>
        <error to="DefectCountP-Ingest-SPTM-Decision"/>
    </action>

	<decision name="DefectCountP-Ingest-SPTM-Decision">
    	<switch>
			<case to="DefectCountP-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_DefectCountP_DoFull') eq 'true'}</case>
            <default to="Fault-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="DefectCountP-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_DefectCountP_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountPID,MeasurementSetPID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.DefectCountP WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_DefectCountP_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Fault-Ingest-SPTM-Decision"/>
        <error to="Fault-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Fault-Ingest-SPTM-Decision">
    	<switch>
			<case to="Fault-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Fault_DoFull') eq 'true'}</case>
            <default to="InventoryAtLocation-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="Fault-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Fault_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FaultID,Fault,FaultComments,AssetID,MaintenanceWorkID,ReportedByLoginID,FaultReportedDT,CommonFaultID,FaultStateID,TimeToRespond,TimeToRepair,TimeResponseToRepair,RevisionNo,IsEdited,LoginID,ModifiedDT,Cause,MachineStopID,Symptoms, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Fault WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Fault_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryAtLocation-Ingest-SPTT-Decision"/>
        <error to="InventoryAtLocation-Ingest-SPTT-Decision"/>
    </action>

	<decision name="InventoryAtLocation-Ingest-SPTT-Decision">
    	<switch>
			<case to="InventoryAtLocation-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_InventoryAtLocation_DoFull') eq 'true'}</case>
            <default to="LineGroup-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="InventoryAtLocation-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InventoryAtLocation_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryAtLocationID,LocationID,InventoryPackID,FromDT,ToDT,IsEdited,RevisionNo,EditedInvAtLocationID,MovedByLoginID,ModifiedDT,Reference1,Reference2,Reference3, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.InventoryAtLocation WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InventoryAtLocation_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineGroup-Ingest-SPTT-Decision"/>
        <error to="LineGroup-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LineGroup-Ingest-SPTT-Decision">
    	<switch>
			<case to="LineGroup-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LineGroup_DoFull') eq 'true'}</case>
            <default to="LkACAChain-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LineGroup-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LineGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineGroupID,LineGroup,LineGroupCode,Description,OEETarget,WasteTarget,Reference1,Reference2,Reference3,Reference4,Reference5, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LineGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LineGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkACAChain-Ingest-SPTM-Decision"/>
        <error to="LkACAChain-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkACAChain-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkACAChain-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkACAChain_DoFull') eq 'true'}</case>
            <default to="LKConcernInventoryPack-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkACAChain-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkACAChain_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionChainID,AcquisitionContextID,Sequence,LkACAChainID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkACAChain WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkACAChain_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKConcernInventoryPack-Ingest-SPTM-Decision"/>
        <error to="LKConcernInventoryPack-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LKConcernInventoryPack-Ingest-SPTM-Decision">
    	<switch>
			<case to="LKConcernInventoryPack-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LKConcernInventoryPack_DoFull') eq 'true'}</case>
            <default to="LkDocumentMaintProc-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LKConcernInventoryPack-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LKConcernInventoryPack_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LKConcernInventoryPackID,ConcernID,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LKConcernInventoryPack WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LKConcernInventoryPack_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentMaintProc-Ingest-SPTM-Decision"/>
        <error to="LkDocumentMaintProc-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkDocumentMaintProc-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkDocumentMaintProc-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkDocumentMaintProc_DoFull') eq 'true'}</case>
            <default to="LkLLS-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentMaintProc-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkDocumentMaintProc_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentMaintProcID,DocumentID,MaintenanceProcedureID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkDocumentMaintProc WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkDocumentMaintProc_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkLLS-Ingest-SPTM-Decision"/>
        <error to="LkLLS-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkLLS-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkLLS-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkLLS_DoFull') eq 'true'}</case>
            <default to="LkMSRGMSR-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkLLS-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkLLS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineID,LineSectionID,LkLLSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkLLS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkLLS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMSRGMSR-Ingest-SPTM-Decision"/>
        <error to="LkMSRGMSR-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkMSRGMSR-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkMSRGMSR-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkMSRGMSR_DoFull') eq 'true'}</case>
            <default to="LkPartSupplier-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkMSRGMSR-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkMSRGMSR_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonGroupID,MachineStopReasonID,LkMSRGMSRID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkMSRGMSR WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkMSRGMSR_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartSupplier-Ingest-SPTM-Decision"/>
        <error to="LkPartSupplier-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkPartSupplier-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkPartSupplier-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkPartSupplier_DoFull') eq 'true'}</case>
            <default to="LkSRGSR-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartSupplier-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkPartSupplier_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartSupplierID,PartID,SupplierID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkPartSupplier WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkPartSupplier_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkSRGSR-Ingest-SPTM-Decision"/>
        <error to="LkSRGSR-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkSRGSR-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkSRGSR-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkSRGSR_DoFull') eq 'true'}</case>
            <default to="LkVTVTG-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkSRGSR-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkSRGSR_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkSRGSRID,ScrapReasonGroupID,ScrapReasonID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkSRGSR WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkSRGSR_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkVTVTG-Ingest-SPTM-Decision"/>
        <error to="LkVTVTG-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkVTVTG-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkVTVTG-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkVTVTG_DoFull') eq 'true'}</case>
            <default to="MachineStageEventType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkVTVTG-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkVTVTG_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeGroupID,VariableTypeID,LkVTVTGID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkVTVTG WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkVTVTG_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageEventType-Ingest-SPTM-Decision"/>
        <error to="MachineStageEventType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MachineStageEventType-Ingest-SPTM-Decision">
    	<switch>
			<case to="MachineStageEventType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MachineStageEventType_DoFull') eq 'true'}</case>
            <default to="MaintenanceManHourPlanned-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageEventType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MachineStageEventType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageEventTypeID,MachineStageEventType,Description,MachineStageTypeID,MachineStageEventTypeCode,IsAlarm,AlarmText, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MachineStageEventType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MachineStageEventType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceManHourPlanned-Ingest-SPTM-Decision"/>
        <error to="MaintenanceManHourPlanned-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceManHourPlanned-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceManHourPlanned-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceManHourPlanned_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedureResult-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceManHourPlanned-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceManHourPlanned_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceManHourPlannedID,MaintenanceProcedureID,PlannedManHours,PersonnelGroupID,SupplierID,SupplierCost, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceManHourPlanned WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceManHourPlanned_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedureResult-Ingest-SPTM-Decision"/>
        <error to="MaintenanceProcedureResult-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceProcedureResult-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceProcedureResult-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceProcedureResult_DoFull') eq 'true'}</case>
            <default to="MaintenanceWorkStatus-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedureResult-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceProcedureResult_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureResultID,MaintenanceProcedureStepID,MaintenanceWorkID,Result,ResultPassFail,Comments,DT,CheckedByLoginID,MaintenanceProcedureStep,StepOrder,SubPartID,Component,RfMaintenanceCheckTypeID,RfSpecialActionTypeID,Test,USL,LSL,PersonnelGroupID,SupplierID,Nom,Units,DecPlaces, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceProcedureResult WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceProcedureResult_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWorkStatus-Ingest-SPTM-Decision"/>
        <error to="MaintenanceWorkStatus-Ingest-SPTM-Decision"/>
    </action>

	<decision name="MaintenanceWorkStatus-Ingest-SPTM-Decision">
    	<switch>
			<case to="MaintenanceWorkStatus-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_MaintenanceWorkStatus_DoFull') eq 'true'}</case>
            <default to="ModulePackedDateTime-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWorkStatus-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MaintenanceWorkStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkStatusID,MaintenanceWorkStatus,Description,RfMaintenanceWorkStatusID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MaintenanceWorkStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MaintenanceWorkStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ModulePackedDateTime-Ingest-SPTM-Decision"/>
        <error to="ModulePackedDateTime-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ModulePackedDateTime-Ingest-SPTM-Decision">
    	<switch>
			<case to="ModulePackedDateTime-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ModulePackedDateTime_DoFull') eq 'true'}</case>
            <default to="OPCGroup-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ModulePackedDateTime-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ModulePackedDateTime_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SerialNo,TimePacked,IMS_No, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ModulePackedDateTime WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ModulePackedDateTime_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCGroup-Ingest-SPTM-Decision"/>
        <error to="OPCGroup-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCGroup-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCGroup-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCGroup_DoFull') eq 'true'}</case>
            <default to="OPCServer-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCGroup-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCGroupID,Deadband,UpdateRate,OPCGroup,IsActive,RfGroupNotifyModeID,TimeBias,OPCServerID,IsPublic,LocalID,CacheUpdateRate, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCServer-Ingest-SPTM-Decision"/>
        <error to="OPCServer-Ingest-SPTM-Decision"/>
    </action>

	<decision name="OPCServer-Ingest-SPTM-Decision">
    	<switch>
			<case to="OPCServer-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_OPCServer_DoFull') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="OPCServer-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_OPCServer_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCServerID,OPCClientID,OPCServer,ProgID,IsActive,ComputerID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.OPCServer WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_OPCServer_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPTM-Decision"/>
        <error to="PartInstance-Ingest-SPTM-Decision"/>
    </action>

	<decision name="PartInstance-Ingest-SPTM-Decision">
    	<switch>
			<case to="PartInstance-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_PartInstance_DoFull') eq 'true'}</case>
            <default to="ProductionStop_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="PartInstance-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_PartInstance_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_PartInstance_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductionStop_-Ingest-SPTM-Decision"/>
        <error to="ProductionStop_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ProductionStop_-Ingest-SPTM-Decision">
    	<switch>
			<case to="ProductionStop_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ProductionStop__DoFull') eq 'true'}</case>
            <default to="Scrap_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ProductionStop_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ProductionStop__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductionStopID,StopComments,StopLoginID,OpenedStopDT,SavedStopDT,OriginalLoginID,EditedProductionStopID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ProductionStop_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ProductionStop__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Scrap_-Ingest-SPTM-Decision"/>
        <error to="Scrap_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Scrap_-Ingest-SPTM-Decision">
    	<switch>
			<case to="Scrap_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Scrap__DoFull') eq 'true'}</case>
            <default to="Shift-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Scrap_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Scrap__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ScrapID,CollectionQuantity,CollectionUnitID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedScrapID,Reference1,Reference2,Reference3,Reference4,Reference5, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Scrap_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Scrap__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Shift-Ingest-SPTM-Decision"/>
        <error to="Shift-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Shift-Ingest-SPTM-Decision">
    	<switch>
			<case to="Shift-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Shift_DoFull') eq 'true'}</case>
            <default to="SPCChartComponent-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Shift-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Shift_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftID,ShiftTypeID,ShiftPatternID,FromDT,ToDT,Sequence, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Shift WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Shift_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartComponent-Ingest-SPTM-Decision"/>
        <error to="SPCChartComponent-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCChartComponent-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCChartComponent-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCChartComponent_DoFull') eq 'true'}</case>
            <default to="SPCDefaultControlLimit-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartComponent-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCChartComponent_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartComponentID,SPCChartDefID,SPCVarChartID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCChartComponent WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCChartComponent_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCDefaultControlLimit-Ingest-SPTM-Decision"/>
        <error to="SPCDefaultControlLimit-Ingest-SPTM-Decision"/>
    </action>

	<decision name="SPCDefaultControlLimit-Ingest-SPTM-Decision">
    	<switch>
			<case to="SPCDefaultControlLimit-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_SPCDefaultControlLimit_DoFull') eq 'true'}</case>
            <default to="TagCauseAction-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="SPCDefaultControlLimit-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_SPCDefaultControlLimit_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCDefaultControlLimitID,SPCChartDefID,RfChartComponentID,RfChart,UCL,CL,LCL,ModifiedDT,LoginID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.SPCDefaultControlLimit WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_SPCDefaultControlLimit_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagCauseAction-Ingest-SPTM-Decision"/>
        <error to="TagCauseAction-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagCauseAction-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagCauseAction-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagCauseAction_DoFull') eq 'true'}</case>
            <default to="TagPartInstance-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagCauseAction-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagCauseAction_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagCauseActionID,CauseActionID,TagTypeID,TagValue,DT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagCauseAction WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagCauseAction_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagPartInstance-Ingest-SPTM-Decision"/>
        <error to="TagPartInstance-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagPartInstance-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagPartInstance-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagPartInstance_DoFull') eq 'true'}</case>
            <default to="TagTypeInTagProfile-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagPartInstance-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagPartInstance_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagPartInstanceID,PartInstanceID,TagTypeID,TagValue,DT, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagPartInstance WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagPartInstance_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagTypeInTagProfile-Ingest-SPTM-Decision"/>
        <error to="TagTypeInTagProfile-Ingest-SPTM-Decision"/>
    </action>

	<decision name="TagTypeInTagProfile-Ingest-SPTM-Decision">
    	<switch>
			<case to="TagTypeInTagProfile-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_TagTypeInTagProfile_DoFull') eq 'true'}</case>
            <default to="Tool_Custom-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="TagTypeInTagProfile-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagTypeInTagProfile_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagProfileID,TagTypeID,EntryOrder,CompulsoryConditions,IsDefaulted,IsEncrypted,TagListID,IsReadOnly,RptQueryID,TagTypeInTagProfileID,TagTreeID,RfTagDataSourceID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagTypeInTagProfile WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagTypeInTagProfile_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool_Custom-Ingest-SPTM-Decision"/>
        <error to="Tool_Custom-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Tool_Custom-Ingest-SPTM-Decision">
    	<switch>
			<case to="Tool_Custom-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Tool_Custom_DoFull') eq 'true'}</case>
            <default to="ToolState-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="Tool_Custom-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Tool_Custom_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Tool_Custom WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Tool_Custom_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolState-Ingest-SPTM-Decision"/>
        <error to="ToolState-Ingest-SPTM-Decision"/>
    </action>

	<decision name="ToolState-Ingest-SPTM-Decision">
    	<switch>
			<case to="ToolState-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_ToolState_DoFull') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ToolState-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_ToolState_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolStateID,ToolID,FromDT,ToDT,RfToolStatusID,LoginID,Comments,OpenedDT,SavedDT,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.ToolState WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_ToolState_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPTM-Decision"/>
        <error to="UnitCount-Ingest-SPTM-Decision"/>
    </action>

	<decision name="UnitCount-Ingest-SPTM-Decision">
    	<switch>
			<case to="UnitCount-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_UnitCount_DoFull') eq 'true'}</case>
            <default to="VariableType-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="UnitCount-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitCount_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitCount_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VariableType-Ingest-SPTM-Decision"/>
        <error to="VariableType-Ingest-SPTM-Decision"/>
    </action>

	<decision name="VariableType-Ingest-SPTM-Decision">
    	<switch>
			<case to="VariableType-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_VariableType_DoFull') eq 'true'}</case>
            <default to="WO_-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="VariableType-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VariableType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeID,Name,ProductTypeID,Description,IsUnilateral,VariableTypeCode,IsProcessParameter,VariableTypeClassID,ImageURI, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VariableType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VariableType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO_-Ingest-SPTM-Decision"/>
        <error to="WO_-Ingest-SPTM-Decision"/>
    </action>

	<decision name="WO_-Ingest-SPTM-Decision">
    	<switch>
			<case to="WO_-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_WO__DoFull') eq 'true'}</case>
            <default to="Job-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="WO_-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_WO__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WOID,CustomerOrderNo,LabelsPerInventoryPack,ItemsPerInventoryPack,ItemsPerLayer,LayersPerInventoryPack,PackingCode,LabelTemplate,LabelColour,EANCode,CusStartNum,CusEndNum,CustomerPartNo,CustomerPartDescription,LabelText1,LabelText2,LabelText3,PrinterURL,BOMVariantID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.WO_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_WO__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Job-Ingest-SPMM-Decision"/>
        <error to="Job-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Job-Ingest-SPMM-Decision">
    	<switch>
			<case to="Job-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Job_DoFull') eq 'true'}</case>
            <default to="WO-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="Job-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Job_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Job.JobID, Job.WOID, Job.RfJobStatusID, Job.DeadlineDT, Job.ActualStartDT, Job.ActualEndDT, Job.PlannedStartDT, Job.PlannedEndDT, Job.PlannedDuration, Job.EstimatedStartDT, Job.EstimatedEndDT, Job.EstimatedDuration, Job.ScheduledSequence, Job.LineID, Job.ProductionStartDT, Job.ProductionEndDT, Job.TheoreticalCycleTime, Job.BudgetChangeOver, Job.QuantityOrdered, Job.IsCalculated, Job.LineGroupID, Job_.JobInstructions, Job_.ReleaseDT, Job_.ReleaseLoginID, Job_.StartLoginID, Job_.EndLoginID, Job_.Comments, Job_.ModifiedDt, Job_.ModifiedLoginID, Job_.StoppedReason, Job_.SkippedReason, Job_.SkippedDT,  2 as "org_id",  'SPMM' as "org_name"  FROM Job FULL JOIN Job_ ON (Job.JobID = Job_.JobID) FULL JOIN Job_Custom ON (Job.JobID = Job_Custom.JobID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Job_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO-Ingest-SPDV-Decision"/>
        <error to="WO-Ingest-SPDV-Decision"/>
    </action>

	<decision name="WO-Ingest-SPDV-Decision">
    	<switch>
			<case to="WO-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_WO_DoFull') eq 'true'}</case>
            <default to="End-Full-21-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="WO-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_WO_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WO.WOID, WO.WONumber, WO.RunNo, WO.PartID, WO.QuantityOrdered, WO.RfJobStatusID, WO.DeadlineDT, WO.ActualStartDT, WO.ActualEndDT, WO.PlannedStartDT, WO.PlannedEndDT, WO.EstimatedStartDT, WO.EstimatedEndDT, WO.CustomerID, WO.IsDiscrete, WO.Reference1, WO.Reference2, WO.Reference3, WO.Reference4, WO.Reference5, WO.WORefID, WO_.CustomerOrderNo, WO_.LabelsPerInventoryPack, WO_.ItemsPerInventoryPack, WO_.ItemsPerLayer, WO_.LayersPerInventoryPack, WO_.PackingCode, WO_.LabelTemplate, WO_.LabelColour, WO_.EANCode, WO_.CusStartNum, WO_.CusEndNum, WO_.CustomerPartNo, WO_.CustomerPartDescription, WO_.LabelText1, WO_.LabelText2, WO_.LabelText3, WO_.PrinterURL, WO_.BOMVariantID, WO_custom.BaseWONumber, WO_custom.Txn_date, WO_custom.Wip_Entity_ID, WO_custom.Alternate_Bom, WO_custom.WO_Status, WO_custom.IsBtoCto,  3 as "org_id",  'SPDV' as "org_name"  FROM WO FULL JOIN WO_ ON (WO.WOID = WO_.WOID) FULL JOIN WO_custom ON (WO.WOID = WO_custom.WOID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_WO_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-21-Ingest-Decision"/>
        <error to="End-Full-21-Ingest-Decision"/>
    </action>

	<end name="End-Full-21-Ingest-Decision"/>
</workflow-app>

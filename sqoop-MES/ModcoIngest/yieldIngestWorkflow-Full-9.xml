<workflow-app name="Ingest-Full-9" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SP_PalletLabel-Ingest-SPMM-Decision"/>


	<decision name="_SP_PalletLabel-Ingest-SPMM-Decision">
    	<switch>
			<case to="_SP_PalletLabel-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER__SP_PalletLabel_DoFull') eq 'true'}</case>
            <default to="AcquisitionDevice-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="_SP_PalletLabel-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER__SP_PalletLabel_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT _SP_PalletLabelID,PalletID,MachineStage,PartNumber,InvState,PalletNo,CreatedDT,CompleteDT,Quantity,LabelTemplate,PrinterURL,PrintedDT,ScannedDT,IsCancelled,IsReprint,PartDescription,LabelSaveDirectory,IsPrintLandscape,NoCopies,LabelsPerInventoryPack, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo._SP_PalletLabel WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER__SP_PalletLabel_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionDevice-Ingest-SPMM-Decision"/>
        <error to="AcquisitionDevice-Ingest-SPMM-Decision"/>
    </action>

	<decision name="AcquisitionDevice-Ingest-SPMM-Decision">
    	<switch>
			<case to="AcquisitionDevice-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_AcquisitionDevice_DoFull') eq 'true'}</case>
            <default to="ActionNote-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionDevice-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_AcquisitionDevice_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AcquisitionDeviceID,AcquisitionVariableTypeID,WorkstationConfigID,Instructions,ImageURI,RfSourceID,DataDeviceID,DeviceArgs,DeviceOutput,FillMode,Preset,Multiplier,PreprocessingFunction,IsManualTrigger,IsManualConfirm, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.AcquisitionDevice WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_AcquisitionDevice_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ActionNote-Ingest-SPMM-Decision"/>
        <error to="ActionNote-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ActionNote-Ingest-SPMM-Decision">
    	<switch>
			<case to="ActionNote-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ActionNote_DoFull') eq 'true'}</case>
            <default to="Asset-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ActionNote-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ActionNote_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionNoteID,ActionID,Note,Comments,NoteDT,LoginID,Reference1,Reference2,Reference3, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ActionNote WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ActionNote_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Asset-Ingest-SPMM-Decision"/>
        <error to="Asset-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Asset-Ingest-SPMM-Decision">
    	<switch>
			<case to="Asset-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Asset_DoFull') eq 'true'}</case>
            <default to="AttributeType-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Asset-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Asset_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AssetID,AssetName,RfAssetTypeID,LineID,MachineStageID,ToolID,GaugeID,PartID,InventoryPackID,LocationID,IsRetired,CostCentreID,ManufacturerID,SupplierID,AcquiredDT,PONumber,OrderedDT,ExpectedDeliveryDT,ExpectedFirstUseDT,EndUseDT,EndUseReason,PurchaseCost,DefaultLocationID,Comments, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.Asset WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Asset_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AttributeType-Ingest-SPMM-Decision"/>
        <error to="AttributeType-Ingest-SPMM-Decision"/>
    </action>

	<decision name="AttributeType-Ingest-SPMM-Decision">
    	<switch>
			<case to="AttributeType-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_AttributeType_DoFull') eq 'true'}</case>
            <default to="BOMVariant-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="AttributeType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_AttributeType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeID,ProductTypeID,Name,Description,ImageURI,RfAttributeClassID,IsPassFail,IsRaiseCA,LikelyCauses,Impact,Weighting,Reference1,Reference2,Reference3,Reference4,Reference5,AttributeTypeCode, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.AttributeType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_AttributeType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BOMVariant-Ingest-SPMM-Decision"/>
        <error to="BOMVariant-Ingest-SPMM-Decision"/>
    </action>

	<decision name="BOMVariant-Ingest-SPMM-Decision">
    	<switch>
			<case to="BOMVariant-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_BOMVariant_DoFull') eq 'true'}</case>
            <default to="ConcernStatus-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="BOMVariant-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_BOMVariant_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BOMVariantID,BOMVariant,PartID,IsDefault,BOMVariantIndex,IsRetired,LoginID,DT, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.BOMVariant WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_BOMVariant_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ConcernStatus-Ingest-SPMM-Decision"/>
        <error to="ConcernStatus-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ConcernStatus-Ingest-SPMM-Decision">
    	<switch>
			<case to="ConcernStatus-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ConcernStatus_DoFull') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="ConcernStatus-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ConcernStatus_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernStatusID,ConcernStatus,ConditionalFormat,IsClosedState, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ConcernStatus WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ConcernStatus_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPTM-Decision"/>
        <error to="DefectCount-Ingest-SPTM-Decision"/>
    </action>

	<decision name="DefectCount-Ingest-SPTM-Decision">
    	<switch>
			<case to="DefectCount-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_DefectCount_DoFull') eq 'true'}</case>
            <default to="Fault-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="DefectCount-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_DefectCount_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_DefectCount_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Fault-Ingest-SPTM-Decision"/>
        <error to="Fault-Ingest-SPTM-Decision"/>
    </action>

	<decision name="Fault-Ingest-SPTM-Decision">
    	<switch>
			<case to="Fault-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_Fault_DoFull') eq 'true'}</case>
            <default to="InventoryUsage_-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Fault-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_Fault_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FaultID,Fault,FaultComments,AssetID,MaintenanceWorkID,ReportedByLoginID,FaultReportedDT,CommonFaultID,FaultStateID,TimeToRespond,TimeToRepair,TimeResponseToRepair,RevisionNo,IsEdited,LoginID,ModifiedDT,Cause,MachineStopID,Symptoms, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.Fault WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_Fault_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryUsage_-Ingest-SPMM-Decision"/>
        <error to="InventoryUsage_-Ingest-SPMM-Decision"/>
    </action>

	<decision name="InventoryUsage_-Ingest-SPMM-Decision">
    	<switch>
			<case to="InventoryUsage_-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_InventoryUsage__DoFull') eq 'true'}</case>
            <default to="LineInfoRecalc-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="InventoryUsage_-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_InventoryUsage__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryUsageID,StartUsingComments,StopUsingComments,StartLoginID,StopLoginID,OpenedStartDT,OpenedEndDT,SavedStartDT,SavedEndDT,OriginalLoginID,EditedInventoryUsageID,Reference1,Reference2,Reference3,Reference4,Reference5, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.InventoryUsage_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_InventoryUsage__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfoRecalc-Ingest-SPTM-Decision"/>
        <error to="LineInfoRecalc-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LineInfoRecalc-Ingest-SPTM-Decision">
    	<switch>
			<case to="LineInfoRecalc-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LineInfoRecalc_DoFull') eq 'true'}</case>
            <default to="LkCDefInCView-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LineInfoRecalc-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LineInfoRecalc_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,ModifiedDT,IsOEEInventoryIsolation,IsOEEInventoryReintroduction,IsOEESpoilage,IsOEEDowntime,IsOEEInventoryProduction,NoBottlenecks,BottleneckMachineStageID,IsCountOutputInventory,IsCountInputInventory,IsOEEProductionUnits,LoginID,SessionID,PlantID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LineInfoRecalc WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LineInfoRecalc_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkCDefInCView-Ingest-SPTM-Decision"/>
        <error to="LkCDefInCView-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkCDefInCView-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkCDefInCView-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkCDefInCView_DoFull') eq 'true'}</case>
            <default to="LkCutBySPCRule-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkCDefInCView-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkCDefInCView_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartDefID,SPCChartSetViewID,Sequence,LkCDefInCViewID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkCDefInCView WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkCDefInCView_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkCutBySPCRule-Ingest-SPTM-Decision"/>
        <error to="LkCutBySPCRule-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkCutBySPCRule-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkCutBySPCRule-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkCutBySPCRule_DoFull') eq 'true'}</case>
            <default to="LkFaultMaintWork-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="LkCutBySPCRule-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkCutBySPCRule_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCRuleID,RfCutByID,LkCutBySPCRuleID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkCutBySPCRule WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkCutBySPCRule_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkFaultMaintWork-Ingest-SPTM-Decision"/>
        <error to="LkFaultMaintWork-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LkFaultMaintWork-Ingest-SPTM-Decision">
    	<switch>
			<case to="LkFaultMaintWork-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LkFaultMaintWork_DoFull') eq 'true'}</case>
            <default to="LkMGMS-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkFaultMaintWork-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LkFaultMaintWork_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkID,FaultID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LkFaultMaintWork WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LkFaultMaintWork_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMGMS-Ingest-SPMM-Decision"/>
        <error to="LkMGMS-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkMGMS-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkMGMS-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkMGMS_DoFull') eq 'true'}</case>
            <default to="LkPartDocument-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkMGMS-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkMGMS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageID,MachineGroupID,LkMGMSID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkMGMS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkMGMS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartDocument-Ingest-SPMM-Decision"/>
        <error to="LkPartDocument-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkPartDocument-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkPartDocument-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkPartDocument_DoFull') eq 'true'}</case>
            <default to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="LkPartDocument-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkPartDocument_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartDocumentID,PartID,DocumentID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkPartDocument WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkPartDocument_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPDV-Decision"/>
        <error to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPDV-Decision"/>
    </action>

	<decision name="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPDV-Decision">
    	<switch>
			<case to="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFull') eq 'true'}</case>
            <default to="LkVCOCVRule-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="LKSPCStatsStyleRfSPCStat_CUS-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RfSPCStatID,SPCStatsStyleID,LkSPCStatsStyleRfSPCStatID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.LKSPCStatsStyleRfSPCStat_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_LKSPCStatsStyleRfSPCStat_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkVCOCVRule-Ingest-SPDV-Decision"/>
        <error to="LkVCOCVRule-Ingest-SPDV-Decision"/>
    </action>

	<decision name="LkVCOCVRule-Ingest-SPDV-Decision">
    	<switch>
			<case to="LkVCOCVRule-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_LkVCOCVRule_DoFull') eq 'true'}</case>
            <default to="MachineStageEvent-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="LkVCOCVRule-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_LkVCOCVRule_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarChartOCID,RfViolationRuleID,LkVCOCVRuleID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.LkVCOCVRule WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_LkVCOCVRule_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageEvent-Ingest-SPDV-Decision"/>
        <error to="MachineStageEvent-Ingest-SPDV-Decision"/>
    </action>

	<decision name="MachineStageEvent-Ingest-SPDV-Decision">
    	<switch>
			<case to="MachineStageEvent-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_MachineStageEvent_DoFull') eq 'true'}</case>
            <default to="MachineStopReasonGroup-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageEvent-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MachineStageEvent_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageEventID,LoginID,DT,MachineStageID,MachineStageEventTypeID,Comments, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MachineStageEvent WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MachineStageEvent_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopReasonGroup-Ingest-SPDV-Decision"/>
        <error to="MachineStopReasonGroup-Ingest-SPDV-Decision"/>
    </action>

	<decision name="MachineStopReasonGroup-Ingest-SPDV-Decision">
    	<switch>
			<case to="MachineStopReasonGroup-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_MachineStopReasonGroup_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedureGroup-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="MachineStopReasonGroup-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MachineStopReasonGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonGroupID,MachineStopReasonGroup,Description,MachineStopReasonGroupCode, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MachineStopReasonGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MachineStopReasonGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedureGroup-Ingest-SPDV-Decision"/>
        <error to="MaintenanceProcedureGroup-Ingest-SPDV-Decision"/>
    </action>

	<decision name="MaintenanceProcedureGroup-Ingest-SPDV-Decision">
    	<switch>
			<case to="MaintenanceProcedureGroup-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_MaintenanceProcedureGroup_DoFull') eq 'true'}</case>
            <default to="MaintenanceWork_-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedureGroup-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MaintenanceProcedureGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureGroupID,MaintenanceProcedureGroup,Description, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MaintenanceProcedureGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MaintenanceProcedureGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWork_-Ingest-SPDV-Decision"/>
        <error to="MaintenanceWork_-Ingest-SPDV-Decision"/>
    </action>

	<decision name="MaintenanceWork_-Ingest-SPDV-Decision">
    	<switch>
			<case to="MaintenanceWork_-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_MaintenanceWork__DoFull') eq 'true'}</case>
            <default to="ModulePackedDateTime_Buffer-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWork_-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MaintenanceWork__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkID,WorkDone,Comments,LoginID,ModifiedDT,Reference1,Reference2,Reference3,Reference4,Reference5, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MaintenanceWork_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MaintenanceWork__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ModulePackedDateTime_Buffer-Ingest-SPDV-Decision"/>
        <error to="ModulePackedDateTime_Buffer-Ingest-SPDV-Decision"/>
    </action>

	<decision name="ModulePackedDateTime_Buffer-Ingest-SPDV-Decision">
    	<switch>
			<case to="ModulePackedDateTime_Buffer-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_ModulePackedDateTime_Buffer_DoFull') eq 'true'}</case>
            <default to="OPCItem-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="ModulePackedDateTime_Buffer-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_ModulePackedDateTime_Buffer_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SerialNo,TimePacked,IMS_No, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.ModulePackedDateTime_Buffer WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_ModulePackedDateTime_Buffer_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCItem-Ingest-SPDV-Decision"/>
        <error to="OPCItem-Ingest-SPDV-Decision"/>
    </action>

	<decision name="OPCItem-Ingest-SPDV-Decision">
    	<switch>
			<case to="OPCItem-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_OPCItem_DoFull') eq 'true'}</case>
            <default to="OPCSpeed-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="OPCItem-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_OPCItem_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCItemID,OPCServerID,OPCGroupID,TagName,TagAddress,RfOPCItemTypeID,IsNotify,RawValue,UpdatedDT,Quality,Value,LastRawValue,LastUpdatedDT,LastQuality,LastValue,MachineStageID,ChangeAction,PLCID,IsDatedOnServer,IsStoredAsArray,IsActive,MachineStageEventTypeID,RfTransitionTypeID,TransitionToValue, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.OPCItem WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_OPCItem_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCSpeed-Ingest-SPDV-Decision"/>
        <error to="OPCSpeed-Ingest-SPDV-Decision"/>
    </action>

	<decision name="OPCSpeed-Ingest-SPDV-Decision">
    	<switch>
			<case to="OPCSpeed-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_OPCSpeed_DoFull') eq 'true'}</case>
            <default to="PartType-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="OPCSpeed-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_OPCSpeed_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCSpeedID,OPCItemID,Description,Scale,Formula,ModifiedDT,LoginID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.OPCSpeed WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_OPCSpeed_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartType-Ingest-SPTT-Decision"/>
        <error to="PartType-Ingest-SPTT-Decision"/>
    </action>

	<decision name="PartType-Ingest-SPTT-Decision">
    	<switch>
			<case to="PartType-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_PartType_DoFull') eq 'true'}</case>
            <default to="RootCause-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="PartType-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_PartType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartTypeID,PartType,Description,PartTypeCode,Variant1TagListID,Variant2TagListID,Variant3TagListID,Variant4TagListID,Variant5TagListID,Variant6TagListID,Variant7TagListID,Variant8TagListID,Variant9TagListID,Variant10TagListID,Variant11TagListID,Variant12TagListID,Variant13TagListID,Variant14TagListID,Variant15TagListID,Variant16TagListID,Variant17TagListID,Variant18TagListID,Variant19TagListID,Variant20TagListID,RfInventoryAccountingModeID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.PartType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_PartType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="RootCause-Ingest-SPDV-Decision"/>
        <error to="RootCause-Ingest-SPDV-Decision"/>
    </action>

	<decision name="RootCause-Ingest-SPDV-Decision">
    	<switch>
			<case to="RootCause-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_RootCause_DoFull') eq 'true'}</case>
            <default to="SettingsPlantDefaults-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="RootCause-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_RootCause_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT RootCauseID,RootCause,Comments,RootCauseTypeID,LineTypeID,MachineStageTypeID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.RootCause WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_RootCause_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SettingsPlantDefaults-Ingest-SPDV-Decision"/>
        <error to="SettingsPlantDefaults-Ingest-SPDV-Decision"/>
    </action>

	<decision name="SettingsPlantDefaults-Ingest-SPDV-Decision">
    	<switch>
			<case to="SettingsPlantDefaults-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_SettingsPlantDefaults_DoFull') eq 'true'}</case>
            <default to="ShiftSequence-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="SettingsPlantDefaults-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_SettingsPlantDefaults_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SettingsPlantDefaultsID,StartOfDay,StartOfWeek,StartOfYear,RfLocaleID,RfDefaultCurrencyID,DataEntryDefaultURI,OnDataCommitGoTo,ChainToStopped,ColourStagesForCurrentJob,UnAckAlarmsPeriod,ShowOverdueIcon,ShowAlarmIcon,WONumberModeID,IsShowVarClassCombo,IsShowAcqClassCombo,RfMachineStopRecordModeID,IsAutoCreateProductsForParts,IsAutoCreateProductTypeForPart,EnforceClosedAlarms,ColourOrder,IsAutoReleaseJob,JobClose,IsAllowDuplicateWONumbers,WoClose,IsOverdueRefToJob,DefaultSPCCalcStyleID,IsAllowInventoryInserts, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.SettingsPlantDefaults WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_SettingsPlantDefaults_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftSequence-Ingest-SPDV-Decision"/>
        <error to="ShiftSequence-Ingest-SPDV-Decision"/>
    </action>

	<decision name="ShiftSequence-Ingest-SPDV-Decision">
    	<switch>
			<case to="ShiftSequence-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_ShiftSequence_DoFull') eq 'true'}</case>
            <default to="SPCChartSet-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="ShiftSequence-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_ShiftSequence_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftSequenceID,ShiftPatternID,ShiftTypeID,Sequence,ShiftStartTime,ShiftEndTime, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.ShiftSequence WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_ShiftSequence_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartSet-Ingest-SPDV-Decision"/>
        <error to="SPCChartSet-Ingest-SPDV-Decision"/>
    </action>

	<decision name="SPCChartSet-Ingest-SPDV-Decision">
    	<switch>
			<case to="SPCChartSet-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_SPCChartSet_DoFull') eq 'true'}</case>
            <default to="SPCStatsStyle_CUS-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartSet-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_SPCChartSet_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetID,SPCChartSet,AcquisitionID,SPCURI,RfDataBandID,NPeriods,SpecTypeID,IsRunningProductOnly,LHSessionID,MaxTrendRecallWindow, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.SPCChartSet WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_SPCChartSet_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCStatsStyle_CUS-Ingest-SPDV-Decision"/>
        <error to="SPCStatsStyle_CUS-Ingest-SPDV-Decision"/>
    </action>

	<decision name="SPCStatsStyle_CUS-Ingest-SPDV-Decision">
    	<switch>
			<case to="SPCStatsStyle_CUS-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_SPCStatsStyle_CUS_DoFull') eq 'true'}</case>
            <default to="TagListValue-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="SPCStatsStyle_CUS-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_SPCStatsStyle_CUS_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCStatsStyleID,SPCStatsStyle,IsSystem, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.SPCStatsStyle_CUS WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_SPCStatsStyle_CUS_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagListValue-Ingest-SPDV-Decision"/>
        <error to="TagListValue-Ingest-SPDV-Decision"/>
    </action>

	<decision name="TagListValue-Ingest-SPDV-Decision">
    	<switch>
			<case to="TagListValue-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_TagListValue_DoFull') eq 'true'}</case>
            <default to="TagType-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="TagListValue-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_TagListValue_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagListValueID,TagListID,TagListValue,DisplayOrder,IsRetired, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.TagListValue WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_TagListValue_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagType-Ingest-SPDV-Decision"/>
        <error to="TagType-Ingest-SPDV-Decision"/>
    </action>

	<decision name="TagType-Ingest-SPDV-Decision">
    	<switch>
			<case to="TagType-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_TagType_DoFull') eq 'true'}</case>
            <default to="Tool_-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="TagType-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_TagType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagTypeID,RfDataTypeID,Name,TagTypeCode,ISSYSTEM,TAGVIEW, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.TagType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_TagType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool_-Ingest-SPDV-Decision"/>
        <error to="Tool_-Ingest-SPDV-Decision"/>
    </action>

	<decision name="Tool_-Ingest-SPDV-Decision">
    	<switch>
			<case to="Tool_-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_Tool__DoFull') eq 'true'}</case>
            <default to="ToolGroup-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="Tool_-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_Tool__DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID,Supplier,Reference1,Reference2,Reference3,Reference4,Reference5,Ident, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.Tool_ WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_Tool__DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolGroup-Ingest-SPDV-Decision"/>
        <error to="ToolGroup-Ingest-SPDV-Decision"/>
    </action>

	<decision name="ToolGroup-Ingest-SPDV-Decision">
    	<switch>
			<case to="ToolGroup-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_ToolGroup_DoFull') eq 'true'}</case>
            <default to="UnitConversion-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="ToolGroup-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_ToolGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolGroupID,ToolGroup,Description,ToolGroupCode, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.ToolGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_ToolGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitConversion-Ingest-SPDV-Decision"/>
        <error to="UnitConversion-Ingest-SPDV-Decision"/>
    </action>

	<decision name="UnitConversion-Ingest-SPDV-Decision">
    	<switch>
			<case to="UnitConversion-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_UnitConversion_DoFull') eq 'true'}</case>
            <default to="VariableTypeClass-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="UnitConversion-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_UnitConversion_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT FromUnitID,ToUnitID,Multiplier,UnitConversionID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.UnitConversion WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_UnitConversion_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VariableTypeClass-Ingest-SPDV-Decision"/>
        <error to="VariableTypeClass-Ingest-SPDV-Decision"/>
    </action>

	<decision name="VariableTypeClass-Ingest-SPDV-Decision">
    	<switch>
			<case to="VariableTypeClass-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_VariableTypeClass_DoFull') eq 'true'}</case>
            <default to="WorkInstructionProcedure-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="VariableTypeClass-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_VariableTypeClass_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeClassID,VariableTypeClass,Description,Priority, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.VariableTypeClass WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_VariableTypeClass_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WorkInstructionProcedure-Ingest-SPDV-Decision"/>
        <error to="WorkInstructionProcedure-Ingest-SPDV-Decision"/>
    </action>

	<decision name="WorkInstructionProcedure-Ingest-SPDV-Decision">
    	<switch>
			<case to="WorkInstructionProcedure-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_WorkInstructionProcedure_DoFull') eq 'true'}</case>
            <default to="MachineStage-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="WorkInstructionProcedure-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_WorkInstructionProcedure_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WorkInstructionProcedureID,WorkInstructionProcedure,WorkInstructionRef,PartID,IsEdited,FromDT,ToDT,RevisionNo,LoginID,ModifiedDT, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.WorkInstructionProcedure WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_WorkInstructionProcedure_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStage-Ingest-SPTT-Decision"/>
        <error to="MachineStage-Ingest-SPTT-Decision"/>
    </action>

	<decision name="MachineStage-Ingest-SPTT-Decision">
    	<switch>
			<case to="MachineStage-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_MachineStage_DoFull') eq 'true'}</case>
            <default to="End-Full-9-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="MachineStage-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_MachineStage_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStage.MachineStageID, MachineStage.MachineStageTypeID, MachineStage.Name, MachineStage.IsRetired, MachineStage.DepartmentID, MachineStage.Description, MachineStage.CurrentShiftPatternID, MachineStage.NoHeads, MachineStage.IsOEEBottleNeck, MachineStage.IsProductionOutput, MachineStage.MachineStopID, MachineStage.StoppedScreenThreshold, MachineStage.LineSectionID, MachineStage.IsDiscrete, MachineStage.RfDowntimeCollectionModeID, MachineStage.RfSpoilageCollectionModeID, MachineStage.RfProductionCollectionModeID, MachineStage.LastBuildRecordID, MachineStage.CurrentJobID, MachineStage_Custom.ModuleDatabase, MachineStage_Custom.IntendedWOID, MachineStage_Custom.MachineStageCode,  4 as "org_id",  'SPTT' as "org_name"  FROM MachineStage FULL JOIN MachineStage_Custom ON (MachineStage.MachineStageID = MachineStage_Custom.MachineStageID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_MachineStage_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-9-Ingest-Decision"/>
        <error to="End-Full-9-Ingest-Decision"/>
    </action>

	<end name="End-Full-9-Ingest-Decision"/>
</workflow-app>

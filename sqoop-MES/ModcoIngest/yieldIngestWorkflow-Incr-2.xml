<workflow-app name="Ingest-Incr-2" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SPML_ModuleInfo-Ingest-SPMX"/>


	<decision name="_SPML_ModuleInfo-Ingest-SPMX">
    	<switch>
			<case to="_SPML_ModuleInfo-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER__SPML_ModuleInfo_DoBase') eq 'true'}</case>
            <default to="_SPML_ModuleInfo-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="_SPML_ModuleInfo-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="_SPML_ModuleInfo-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER__SPML_ModuleInfo_DoDelta') eq 'true'}</case>
            <default to="_SPML_ModuleInfo-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="_SPML_ModuleInfo-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="_SPML_ModuleInfo-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER__SPML_ModuleInfo_DoIncrement') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPMM"/>
        </switch>
    </decision>

    <action name="_SPML_ModuleInfo-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER__SPML_ModuleInfo_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ModuleInfoID,SerialNo,LaminateID,LaminateCreatedDT,LaminateOrderNo,LaminatePartNo,BINNo,CktFormBuildPart,CktFormBuildMachine,CktFormBuildDT,GlassBuildPart,GlassBuildDate,LaminationBuildMachine,LaminationBuildDT,ModuleID,ModuleCreatedDT,ModuleOrderNo,IntendedModulePartNo,IntendedModulePartDesc,FramingBuildPart,FramingBuildMachine,FramingBuildDT,JboxBuildPart,JboxBuildDT,FlashtestClassifiedDT,FinalModulePartNo,FinalModulePartDesc,ActualPower,ActualVocMod,ActualFF,PackedDT,InventoryState,JboxBuildMachine,ActualIsc,FlashtestBuildMachine,Komax1,Komax2,Komax3,GlassID,CellType,StringerOperator,CircuitOperator1,CircuitOperator2,TrimChangeReason,PowerChartGenerated,LaminateWoId,ModuleWoId,VisualStateId,RfInvStateId,ElTestDate,ElBuildMachine,ActualVmpMod,ActualImpMod,TrimBuildMachine,TrimBuildDT,CellThickness,PalletID,FlashTestID,PadLock,BtoCtoSerialNo,EvaUseByDT, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo._SPML_ModuleInfo WHERE ( $CONDITIONS )  AND ( ModuleInfoID ${lessThanEqual} ${job_MEXICALI_OWNER__SPML_ModuleInfo_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER__SPML_ModuleInfo_MinBaseID} ${lessThanEqual} ModuleInfoID )</arg>
            <arg>--split-by</arg>
            <arg>ModuleInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER__SPML_ModuleInfo_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="_SPML_ModuleInfo-Ingest-SPMX-IsDelta"/>
        <error to="_SPML_ModuleInfo-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="_SPML_ModuleInfo-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER__SPML_ModuleInfo_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ModuleInfoID,SerialNo,LaminateID,LaminateCreatedDT,LaminateOrderNo,LaminatePartNo,BINNo,CktFormBuildPart,CktFormBuildMachine,CktFormBuildDT,GlassBuildPart,GlassBuildDate,LaminationBuildMachine,LaminationBuildDT,ModuleID,ModuleCreatedDT,ModuleOrderNo,IntendedModulePartNo,IntendedModulePartDesc,FramingBuildPart,FramingBuildMachine,FramingBuildDT,JboxBuildPart,JboxBuildDT,FlashtestClassifiedDT,FinalModulePartNo,FinalModulePartDesc,ActualPower,ActualVocMod,ActualFF,PackedDT,InventoryState,JboxBuildMachine,ActualIsc,FlashtestBuildMachine,Komax1,Komax2,Komax3,GlassID,CellType,StringerOperator,CircuitOperator1,CircuitOperator2,TrimChangeReason,PowerChartGenerated,LaminateWoId,ModuleWoId,VisualStateId,RfInvStateId,ElTestDate,ElBuildMachine,ActualVmpMod,ActualImpMod,TrimBuildMachine,TrimBuildDT,CellThickness,PalletID,FlashTestID,PadLock,BtoCtoSerialNo,EvaUseByDT, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo._SPML_ModuleInfo WHERE ( $CONDITIONS )  AND ( ModuleInfoID ${greaterThanEqual} ${job_MEXICALI_OWNER__SPML_ModuleInfo_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>ModuleInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER__SPML_ModuleInfo_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="_SPML_ModuleInfo-Ingest-SPMX-IsIncrement"/>
        <error to="_SPML_ModuleInfo-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="_SPML_ModuleInfo-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER__SPML_ModuleInfo_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ModuleInfoID,SerialNo,LaminateID,LaminateCreatedDT,LaminateOrderNo,LaminatePartNo,BINNo,CktFormBuildPart,CktFormBuildMachine,CktFormBuildDT,GlassBuildPart,GlassBuildDate,LaminationBuildMachine,LaminationBuildDT,ModuleID,ModuleCreatedDT,ModuleOrderNo,IntendedModulePartNo,IntendedModulePartDesc,FramingBuildPart,FramingBuildMachine,FramingBuildDT,JboxBuildPart,JboxBuildDT,FlashtestClassifiedDT,FinalModulePartNo,FinalModulePartDesc,ActualPower,ActualVocMod,ActualFF,PackedDT,InventoryState,JboxBuildMachine,ActualIsc,FlashtestBuildMachine,Komax1,Komax2,Komax3,GlassID,CellType,StringerOperator,CircuitOperator1,CircuitOperator2,TrimChangeReason,PowerChartGenerated,LaminateWoId,ModuleWoId,VisualStateId,RfInvStateId,ElTestDate,ElBuildMachine,ActualVmpMod,ActualImpMod,TrimBuildMachine,TrimBuildDT,CellThickness,PalletID,FlashTestID,PadLock,BtoCtoSerialNo,EvaUseByDT, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo._SPML_ModuleInfo WHERE ( $CONDITIONS )  AND (  ModuleInfoID ${greaterThanEqual} ${job_MEXICALI_OWNER__SPML_ModuleInfo_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER__SPML_ModuleInfo_MaxIncrementID} ${greaterThanEqual} ModuleInfoID )</arg>
            <arg>--split-by</arg>
            <arg>ModuleInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER__SPML_ModuleInfo_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPMM"/>
        <error to="DefectCount-Ingest-SPMM"/>
    </action>


	<decision name="DefectCount-Ingest-SPMM">
    	<switch>
			<case to="DefectCount-Ingest-SPMM-DoBase">${ wf:conf('job_SPMM_C1_OWNER_DefectCount_DoBase') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPMM-IsDelta"/>
        </switch>
    </decision>

	<decision name="DefectCount-Ingest-SPMM-IsDelta">
    	<switch>
			<case to="DefectCount-Ingest-SPMM-DoDelta">${ wf:conf('job_SPMM_C1_OWNER_DefectCount_DoDelta') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPMM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="DefectCount-Ingest-SPMM-IsIncrement">
    	<switch>
			<case to="DefectCount-Ingest-SPMM-DoIncrement">${ wf:conf('job_SPMM_C1_OWNER_DefectCount_DoIncrement') eq 'true'}</case>
            <default to="EBATrigger-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="DefectCount-Ingest-SPMM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_DefectCount_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS )  AND ( DefectCountID ${lessThanEqual} ${job_SPMM_C1_OWNER_DefectCount_MaxBaseID} ) AND ( ${job_SPMM_C1_OWNER_DefectCount_MinBaseID} ${lessThanEqual} DefectCountID )</arg>
            <arg>--split-by</arg>
            <arg>DefectCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_DefectCount_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPMM-IsDelta"/>
        <error to="DefectCount-Ingest-SPMM-IsDelta"/>
    </action>
    <action name="DefectCount-Ingest-SPMM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_DefectCount_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS )  AND ( DefectCountID ${greaterThanEqual} ${job_SPMM_C1_OWNER_DefectCount_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>DefectCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_DefectCount_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPMM-IsIncrement"/>
        <error to="DefectCount-Ingest-SPMM-IsIncrement"/>
    </action>

    <action name="DefectCount-Ingest-SPMM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_DefectCount_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS )  AND (  DefectCountID ${greaterThanEqual} ${job_SPMM_C1_OWNER_DefectCount_MinIncrementID} ) AND ( ${job_SPMM_C1_OWNER_DefectCount_MaxIncrementID} ${greaterThanEqual} DefectCountID )</arg>
            <arg>--split-by</arg>
            <arg>DefectCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_DefectCount_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="EBATrigger-Ingest-SPTM"/>
        <error to="EBATrigger-Ingest-SPTM"/>
    </action>


	<decision name="EBATrigger-Ingest-SPTM">
    	<switch>
			<case to="EBATrigger-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_EBATrigger_DoBase') eq 'true'}</case>
            <default to="EBATrigger-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="EBATrigger-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="EBATrigger-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_EBATrigger_DoDelta') eq 'true'}</case>
            <default to="EBATrigger-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="EBATrigger-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="EBATrigger-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_EBATrigger_DoIncrement') eq 'true'}</case>
            <default to="InvChangeState-Ingest-SPTT"/>
        </switch>
    </decision>

    <action name="EBATrigger-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_EBATrigger_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT EBATriggerID,RfTriggerTypeID,ContextDictionary,TriggerOwnerID,CreateDT,ProcessedDT,RfWatchProcessStateID,Message,TotalTime,OracleInsertTime,OracleConnectionTime,OracleInsertStatement, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.EBATrigger WHERE ( $CONDITIONS )  AND ( EBATriggerID ${lessThanEqual} ${job_CAPETOWN_OWNER_EBATrigger_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_EBATrigger_MinBaseID} ${lessThanEqual} EBATriggerID )</arg>
            <arg>--split-by</arg>
            <arg>EBATriggerID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_EBATrigger_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="EBATrigger-Ingest-SPTM-IsDelta"/>
        <error to="EBATrigger-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="EBATrigger-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_EBATrigger_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT EBATriggerID,RfTriggerTypeID,ContextDictionary,TriggerOwnerID,CreateDT,ProcessedDT,RfWatchProcessStateID,Message,TotalTime,OracleInsertTime,OracleConnectionTime,OracleInsertStatement, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.EBATrigger WHERE ( $CONDITIONS )  AND ( EBATriggerID ${greaterThanEqual} ${job_CAPETOWN_OWNER_EBATrigger_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>EBATriggerID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_EBATrigger_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="EBATrigger-Ingest-SPTM-IsIncrement"/>
        <error to="EBATrigger-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="EBATrigger-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_EBATrigger_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT EBATriggerID,RfTriggerTypeID,ContextDictionary,TriggerOwnerID,CreateDT,ProcessedDT,RfWatchProcessStateID,Message,TotalTime,OracleInsertTime,OracleConnectionTime,OracleInsertStatement, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.EBATrigger WHERE ( $CONDITIONS )  AND (  EBATriggerID ${greaterThanEqual} ${job_CAPETOWN_OWNER_EBATrigger_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_EBATrigger_MaxIncrementID} ${greaterThanEqual} EBATriggerID )</arg>
            <arg>--split-by</arg>
            <arg>EBATriggerID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_EBATrigger_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPTT"/>
        <error to="InvChangeState-Ingest-SPTT"/>
    </action>


	<decision name="InvChangeState-Ingest-SPTT">
    	<switch>
			<case to="InvChangeState-Ingest-SPTT-DoBase">${ wf:conf('job_TOULOUSE_OWNER_InvChangeState_DoBase') eq 'true'}</case>
            <default to="InvChangeState-Ingest-SPTT-IsDelta"/>
        </switch>
    </decision>

	<decision name="InvChangeState-Ingest-SPTT-IsDelta">
    	<switch>
			<case to="InvChangeState-Ingest-SPTT-DoDelta">${ wf:conf('job_TOULOUSE_OWNER_InvChangeState_DoDelta') eq 'true'}</case>
            <default to="InvChangeState-Ingest-SPTT-IsIncrement"/>
        </switch>
    </decision>

	<decision name="InvChangeState-Ingest-SPTT-IsIncrement">
    	<switch>
			<case to="InvChangeState-Ingest-SPTT-DoIncrement">${ wf:conf('job_TOULOUSE_OWNER_InvChangeState_DoIncrement') eq 'true'}</case>
            <default to="InventoryAtLocation-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="InvChangeState-Ingest-SPTT-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InvChangeState_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 4 as "org_id",  'SPTT' as "org_name" , (DatePart(HOUR,InvChangeState.FromDT)) as "Trans_Hours" , (case when DatePart(HOUR,InvChangeState.FromDT) ${lessThan} 7 then cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) -1 else cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) end) as "ShiftStart_DateTime"   FROM dbo.InvChangeState WHERE ( $CONDITIONS )  AND ( InvChangeStateID ${lessThanEqual} ${job_TOULOUSE_OWNER_InvChangeState_MaxBaseID} ) AND ( ${job_TOULOUSE_OWNER_InvChangeState_MinBaseID} ${lessThanEqual} InvChangeStateID )</arg>
            <arg>--split-by</arg>
            <arg>InvChangeStateID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InvChangeState_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPTT-IsDelta"/>
        <error to="InvChangeState-Ingest-SPTT-IsDelta"/>
    </action>
    <action name="InvChangeState-Ingest-SPTT-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InvChangeState_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 4 as "org_id",  'SPTT' as "org_name" , (DatePart(HOUR,InvChangeState.FromDT)) as "Trans_Hours" , (case when DatePart(HOUR,InvChangeState.FromDT) ${lessThan} 7 then cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) -1 else cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) end) as "ShiftStart_DateTime"   FROM dbo.InvChangeState WHERE ( $CONDITIONS )  AND ( InvChangeStateID ${greaterThanEqual} ${job_TOULOUSE_OWNER_InvChangeState_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>InvChangeStateID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InvChangeState_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPTT-IsIncrement"/>
        <error to="InvChangeState-Ingest-SPTT-IsIncrement"/>
    </action>

    <action name="InvChangeState-Ingest-SPTT-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_InvChangeState_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 4 as "org_id",  'SPTT' as "org_name" , (DatePart(HOUR,InvChangeState.FromDT)) as "Trans_Hours" , (case when DatePart(HOUR,InvChangeState.FromDT) ${lessThan} 7 then cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) -1 else cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) end) as "ShiftStart_DateTime"   FROM dbo.InvChangeState WHERE ( $CONDITIONS )  AND (  InvChangeStateID ${greaterThanEqual} ${job_TOULOUSE_OWNER_InvChangeState_MinIncrementID} ) AND ( ${job_TOULOUSE_OWNER_InvChangeState_MaxIncrementID} ${greaterThanEqual} InvChangeStateID )</arg>
            <arg>--split-by</arg>
            <arg>InvChangeStateID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_InvChangeState_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryAtLocation-Ingest-SPTM"/>
        <error to="InventoryAtLocation-Ingest-SPTM"/>
    </action>


	<decision name="InventoryAtLocation-Ingest-SPTM">
    	<switch>
			<case to="InventoryAtLocation-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_InventoryAtLocation_DoBase') eq 'true'}</case>
            <default to="InventoryAtLocation-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="InventoryAtLocation-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="InventoryAtLocation-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_InventoryAtLocation_DoDelta') eq 'true'}</case>
            <default to="InventoryAtLocation-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="InventoryAtLocation-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="InventoryAtLocation-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_InventoryAtLocation_DoIncrement') eq 'true'}</case>
            <default to="LineInfo_custom-Ingest-SPMM"/>
        </switch>
    </decision>

    <action name="InventoryAtLocation-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_InventoryAtLocation_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryAtLocationID,LocationID,InventoryPackID,FromDT,ToDT,IsEdited,RevisionNo,EditedInvAtLocationID,MovedByLoginID,ModifiedDT,Reference1,Reference2,Reference3, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.InventoryAtLocation WHERE ( $CONDITIONS )  AND ( InventoryAtLocationID ${lessThanEqual} ${job_CAPETOWN_OWNER_InventoryAtLocation_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_InventoryAtLocation_MinBaseID} ${lessThanEqual} InventoryAtLocationID )</arg>
            <arg>--split-by</arg>
            <arg>InventoryAtLocationID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_InventoryAtLocation_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryAtLocation-Ingest-SPTM-IsDelta"/>
        <error to="InventoryAtLocation-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="InventoryAtLocation-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_InventoryAtLocation_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryAtLocationID,LocationID,InventoryPackID,FromDT,ToDT,IsEdited,RevisionNo,EditedInvAtLocationID,MovedByLoginID,ModifiedDT,Reference1,Reference2,Reference3, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.InventoryAtLocation WHERE ( $CONDITIONS )  AND ( InventoryAtLocationID ${greaterThanEqual} ${job_CAPETOWN_OWNER_InventoryAtLocation_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>InventoryAtLocationID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_InventoryAtLocation_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryAtLocation-Ingest-SPTM-IsIncrement"/>
        <error to="InventoryAtLocation-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="InventoryAtLocation-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_InventoryAtLocation_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryAtLocationID,LocationID,InventoryPackID,FromDT,ToDT,IsEdited,RevisionNo,EditedInvAtLocationID,MovedByLoginID,ModifiedDT,Reference1,Reference2,Reference3, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.InventoryAtLocation WHERE ( $CONDITIONS )  AND (  InventoryAtLocationID ${greaterThanEqual} ${job_CAPETOWN_OWNER_InventoryAtLocation_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_InventoryAtLocation_MaxIncrementID} ${greaterThanEqual} InventoryAtLocationID )</arg>
            <arg>--split-by</arg>
            <arg>InventoryAtLocationID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_InventoryAtLocation_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo_custom-Ingest-SPMM"/>
        <error to="LineInfo_custom-Ingest-SPMM"/>
    </action>


	<decision name="LineInfo_custom-Ingest-SPMM">
    	<switch>
			<case to="LineInfo_custom-Ingest-SPMM-DoBase">${ wf:conf('job_SPMM_C1_OWNER_LineInfo_custom_DoBase') eq 'true'}</case>
            <default to="LineInfo_custom-Ingest-SPMM-IsDelta"/>
        </switch>
    </decision>

	<decision name="LineInfo_custom-Ingest-SPMM-IsDelta">
    	<switch>
			<case to="LineInfo_custom-Ingest-SPMM-DoDelta">${ wf:conf('job_SPMM_C1_OWNER_LineInfo_custom_DoDelta') eq 'true'}</case>
            <default to="LineInfo_custom-Ingest-SPMM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="LineInfo_custom-Ingest-SPMM-IsIncrement">
    	<switch>
			<case to="LineInfo_custom-Ingest-SPMM-DoIncrement">${ wf:conf('job_SPMM_C1_OWNER_LineInfo_custom_DoIncrement') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPMM"/>
        </switch>
    </decision>

    <action name="LineInfo_custom-Ingest-SPMM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LineInfo_custom_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,CellsProduced, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LineInfo_custom WHERE ( $CONDITIONS )  AND ( LineInfoID ${lessThanEqual} ${job_SPMM_C1_OWNER_LineInfo_custom_MaxBaseID} ) AND ( ${job_SPMM_C1_OWNER_LineInfo_custom_MinBaseID} ${lessThanEqual} LineInfoID )</arg>
            <arg>--split-by</arg>
            <arg>LineInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LineInfo_custom_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo_custom-Ingest-SPMM-IsDelta"/>
        <error to="LineInfo_custom-Ingest-SPMM-IsDelta"/>
    </action>
    <action name="LineInfo_custom-Ingest-SPMM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LineInfo_custom_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,CellsProduced, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LineInfo_custom WHERE ( $CONDITIONS )  AND ( LineInfoID ${greaterThanEqual} ${job_SPMM_C1_OWNER_LineInfo_custom_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>LineInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LineInfo_custom_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo_custom-Ingest-SPMM-IsIncrement"/>
        <error to="LineInfo_custom-Ingest-SPMM-IsIncrement"/>
    </action>

    <action name="LineInfo_custom-Ingest-SPMM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LineInfo_custom_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,CellsProduced, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LineInfo_custom WHERE ( $CONDITIONS )  AND (  LineInfoID ${greaterThanEqual} ${job_SPMM_C1_OWNER_LineInfo_custom_MinIncrementID} ) AND ( ${job_SPMM_C1_OWNER_LineInfo_custom_MaxIncrementID} ${greaterThanEqual} LineInfoID )</arg>
            <arg>--split-by</arg>
            <arg>LineInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LineInfo_custom_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPMM"/>
        <error to="LkPartLineSection-Ingest-SPMM"/>
    </action>


	<decision name="LkPartLineSection-Ingest-SPMM">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPMM-DoBase">${ wf:conf('job_SPMM_C1_OWNER_LkPartLineSection_DoBase') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPMM-IsDelta"/>
        </switch>
    </decision>

	<decision name="LkPartLineSection-Ingest-SPMM-IsDelta">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPMM-DoDelta">${ wf:conf('job_SPMM_C1_OWNER_LkPartLineSection_DoDelta') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPMM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="LkPartLineSection-Ingest-SPMM-IsIncrement">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPMM-DoIncrement">${ wf:conf('job_SPMM_C1_OWNER_LkPartLineSection_DoIncrement') eq 'true'}</case>
            <default to="MeasurementSet-Ingest-SPMM"/>
        </switch>
    </decision>

    <action name="LkPartLineSection-Ingest-SPMM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkPartLineSection_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS )  AND ( PartID ${lessThanEqual} ${job_SPMM_C1_OWNER_LkPartLineSection_MaxBaseID} ) AND ( ${job_SPMM_C1_OWNER_LkPartLineSection_MinBaseID} ${lessThanEqual} PartID )</arg>
            <arg>--split-by</arg>
            <arg>PartID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkPartLineSection_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPMM-IsDelta"/>
        <error to="LkPartLineSection-Ingest-SPMM-IsDelta"/>
    </action>
    <action name="LkPartLineSection-Ingest-SPMM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkPartLineSection_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS )  AND ( PartID ${greaterThanEqual} ${job_SPMM_C1_OWNER_LkPartLineSection_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>PartID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkPartLineSection_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPMM-IsIncrement"/>
        <error to="LkPartLineSection-Ingest-SPMM-IsIncrement"/>
    </action>

    <action name="LkPartLineSection-Ingest-SPMM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkPartLineSection_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS )  AND (  PartID ${greaterThanEqual} ${job_SPMM_C1_OWNER_LkPartLineSection_MinIncrementID} ) AND ( ${job_SPMM_C1_OWNER_LkPartLineSection_MaxIncrementID} ${greaterThanEqual} PartID )</arg>
            <arg>--split-by</arg>
            <arg>PartID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkPartLineSection_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet-Ingest-SPMM"/>
        <error to="MeasurementSet-Ingest-SPMM"/>
    </action>


	<decision name="MeasurementSet-Ingest-SPMM">
    	<switch>
			<case to="MeasurementSet-Ingest-SPMM-DoBase">${ wf:conf('job_SPMM_C1_OWNER_MeasurementSet_DoBase') eq 'true'}</case>
            <default to="MeasurementSet-Ingest-SPMM-IsDelta"/>
        </switch>
    </decision>

	<decision name="MeasurementSet-Ingest-SPMM-IsDelta">
    	<switch>
			<case to="MeasurementSet-Ingest-SPMM-DoDelta">${ wf:conf('job_SPMM_C1_OWNER_MeasurementSet_DoDelta') eq 'true'}</case>
            <default to="MeasurementSet-Ingest-SPMM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="MeasurementSet-Ingest-SPMM-IsIncrement">
    	<switch>
			<case to="MeasurementSet-Ingest-SPMM-DoIncrement">${ wf:conf('job_SPMM_C1_OWNER_MeasurementSet_DoIncrement') eq 'true'}</case>
            <default to="MeasurementSet_-Ingest-SPDV"/>
        </switch>
    </decision>

    <action name="MeasurementSet-Ingest-SPMM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MeasurementSet_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID,ResumeStep,InventoryPackID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MeasurementSet WHERE ( $CONDITIONS )  AND ( MeasurementSetID ${lessThanEqual} ${job_SPMM_C1_OWNER_MeasurementSet_MaxBaseID} ) AND ( ${job_SPMM_C1_OWNER_MeasurementSet_MinBaseID} ${lessThanEqual} MeasurementSetID )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MeasurementSet_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet-Ingest-SPMM-IsDelta"/>
        <error to="MeasurementSet-Ingest-SPMM-IsDelta"/>
    </action>
    <action name="MeasurementSet-Ingest-SPMM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MeasurementSet_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID,ResumeStep,InventoryPackID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MeasurementSet WHERE ( $CONDITIONS )  AND ( MeasurementSetID ${greaterThanEqual} ${job_SPMM_C1_OWNER_MeasurementSet_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MeasurementSet_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet-Ingest-SPMM-IsIncrement"/>
        <error to="MeasurementSet-Ingest-SPMM-IsIncrement"/>
    </action>

    <action name="MeasurementSet-Ingest-SPMM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MeasurementSet_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID,ResumeStep,InventoryPackID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MeasurementSet WHERE ( $CONDITIONS )  AND (  MeasurementSetID ${greaterThanEqual} ${job_SPMM_C1_OWNER_MeasurementSet_MinIncrementID} ) AND ( ${job_SPMM_C1_OWNER_MeasurementSet_MaxIncrementID} ${greaterThanEqual} MeasurementSetID )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MeasurementSet_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet_-Ingest-SPDV"/>
        <error to="MeasurementSet_-Ingest-SPDV"/>
    </action>


	<decision name="MeasurementSet_-Ingest-SPDV">
    	<switch>
			<case to="MeasurementSet_-Ingest-SPDV-DoBase">${ wf:conf('job_DEVERN_OWNER_MeasurementSet__DoBase') eq 'true'}</case>
            <default to="MeasurementSet_-Ingest-SPDV-IsDelta"/>
        </switch>
    </decision>

	<decision name="MeasurementSet_-Ingest-SPDV-IsDelta">
    	<switch>
			<case to="MeasurementSet_-Ingest-SPDV-DoDelta">${ wf:conf('job_DEVERN_OWNER_MeasurementSet__DoDelta') eq 'true'}</case>
            <default to="MeasurementSet_-Ingest-SPDV-IsIncrement"/>
        </switch>
    </decision>

	<decision name="MeasurementSet_-Ingest-SPDV-IsIncrement">
    	<switch>
			<case to="MeasurementSet_-Ingest-SPDV-DoIncrement">${ wf:conf('job_DEVERN_OWNER_MeasurementSet__DoIncrement') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPDV"/>
        </switch>
    </decision>

    <action name="MeasurementSet_-Ingest-SPDV-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MeasurementSet__DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedMSID,ApprovalLoginID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MeasurementSet_ WHERE ( $CONDITIONS )  AND ( MeasurementSetID ${lessThanEqual} ${job_DEVERN_OWNER_MeasurementSet__MaxBaseID} ) AND ( ${job_DEVERN_OWNER_MeasurementSet__MinBaseID} ${lessThanEqual} MeasurementSetID )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MeasurementSet__DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet_-Ingest-SPDV-IsDelta"/>
        <error to="MeasurementSet_-Ingest-SPDV-IsDelta"/>
    </action>
    <action name="MeasurementSet_-Ingest-SPDV-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MeasurementSet__DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedMSID,ApprovalLoginID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MeasurementSet_ WHERE ( $CONDITIONS )  AND ( MeasurementSetID ${greaterThanEqual} ${job_DEVERN_OWNER_MeasurementSet__MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MeasurementSet__DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet_-Ingest-SPDV-IsIncrement"/>
        <error to="MeasurementSet_-Ingest-SPDV-IsIncrement"/>
    </action>

    <action name="MeasurementSet_-Ingest-SPDV-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_MeasurementSet__DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedMSID,ApprovalLoginID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.MeasurementSet_ WHERE ( $CONDITIONS )  AND (  MeasurementSetID ${greaterThanEqual} ${job_DEVERN_OWNER_MeasurementSet__MinIncrementID} ) AND ( ${job_DEVERN_OWNER_MeasurementSet__MaxIncrementID} ${greaterThanEqual} MeasurementSetID )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_MeasurementSet__DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPDV"/>
        <error to="PartInstance-Ingest-SPDV"/>
    </action>


	<decision name="PartInstance-Ingest-SPDV">
    	<switch>
			<case to="PartInstance-Ingest-SPDV-DoBase">${ wf:conf('job_DEVERN_OWNER_PartInstance_DoBase') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPDV-IsDelta"/>
        </switch>
    </decision>

	<decision name="PartInstance-Ingest-SPDV-IsDelta">
    	<switch>
			<case to="PartInstance-Ingest-SPDV-DoDelta">${ wf:conf('job_DEVERN_OWNER_PartInstance_DoDelta') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPDV-IsIncrement"/>
        </switch>
    </decision>

	<decision name="PartInstance-Ingest-SPDV-IsIncrement">
    	<switch>
			<case to="PartInstance-Ingest-SPDV-DoIncrement">${ wf:conf('job_DEVERN_OWNER_PartInstance_DoIncrement') eq 'true'}</case>
            <default to="ProductionStop_-Ingest-SPMM"/>
        </switch>
    </decision>

    <action name="PartInstance-Ingest-SPDV-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_PartInstance_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS )  AND ( PartInstanceID ${lessThanEqual} ${job_DEVERN_OWNER_PartInstance_MaxBaseID} ) AND ( ${job_DEVERN_OWNER_PartInstance_MinBaseID} ${lessThanEqual} PartInstanceID )</arg>
            <arg>--split-by</arg>
            <arg>PartInstanceID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_PartInstance_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPDV-IsDelta"/>
        <error to="PartInstance-Ingest-SPDV-IsDelta"/>
    </action>
    <action name="PartInstance-Ingest-SPDV-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_PartInstance_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS )  AND ( PartInstanceID ${greaterThanEqual} ${job_DEVERN_OWNER_PartInstance_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>PartInstanceID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_PartInstance_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPDV-IsIncrement"/>
        <error to="PartInstance-Ingest-SPDV-IsIncrement"/>
    </action>

    <action name="PartInstance-Ingest-SPDV-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_PartInstance_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS )  AND (  PartInstanceID ${greaterThanEqual} ${job_DEVERN_OWNER_PartInstance_MinIncrementID} ) AND ( ${job_DEVERN_OWNER_PartInstance_MaxIncrementID} ${greaterThanEqual} PartInstanceID )</arg>
            <arg>--split-by</arg>
            <arg>PartInstanceID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_PartInstance_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductionStop_-Ingest-SPMM"/>
        <error to="ProductionStop_-Ingest-SPMM"/>
    </action>


	<decision name="ProductionStop_-Ingest-SPMM">
    	<switch>
			<case to="ProductionStop_-Ingest-SPMM-DoBase">${ wf:conf('job_SPMM_C1_OWNER_ProductionStop__DoBase') eq 'true'}</case>
            <default to="ProductionStop_-Ingest-SPMM-IsDelta"/>
        </switch>
    </decision>

	<decision name="ProductionStop_-Ingest-SPMM-IsDelta">
    	<switch>
			<case to="ProductionStop_-Ingest-SPMM-DoDelta">${ wf:conf('job_SPMM_C1_OWNER_ProductionStop__DoDelta') eq 'true'}</case>
            <default to="ProductionStop_-Ingest-SPMM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="ProductionStop_-Ingest-SPMM-IsIncrement">
    	<switch>
			<case to="ProductionStop_-Ingest-SPMM-DoIncrement">${ wf:conf('job_SPMM_C1_OWNER_ProductionStop__DoIncrement') eq 'true'}</case>
            <default to="TagMS-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="ProductionStop_-Ingest-SPMM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ProductionStop__DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductionStopID,StopComments,StopLoginID,OpenedStopDT,SavedStopDT,OriginalLoginID,EditedProductionStopID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ProductionStop_ WHERE ( $CONDITIONS )  AND ( ProductionStopID ${lessThanEqual} ${job_SPMM_C1_OWNER_ProductionStop__MaxBaseID} ) AND ( ${job_SPMM_C1_OWNER_ProductionStop__MinBaseID} ${lessThanEqual} ProductionStopID )</arg>
            <arg>--split-by</arg>
            <arg>ProductionStopID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ProductionStop__DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductionStop_-Ingest-SPMM-IsDelta"/>
        <error to="ProductionStop_-Ingest-SPMM-IsDelta"/>
    </action>
    <action name="ProductionStop_-Ingest-SPMM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ProductionStop__DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductionStopID,StopComments,StopLoginID,OpenedStopDT,SavedStopDT,OriginalLoginID,EditedProductionStopID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ProductionStop_ WHERE ( $CONDITIONS )  AND ( ProductionStopID ${greaterThanEqual} ${job_SPMM_C1_OWNER_ProductionStop__MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>ProductionStopID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ProductionStop__DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductionStop_-Ingest-SPMM-IsIncrement"/>
        <error to="ProductionStop_-Ingest-SPMM-IsIncrement"/>
    </action>

    <action name="ProductionStop_-Ingest-SPMM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ProductionStop__DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductionStopID,StopComments,StopLoginID,OpenedStopDT,SavedStopDT,OriginalLoginID,EditedProductionStopID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ProductionStop_ WHERE ( $CONDITIONS )  AND (  ProductionStopID ${greaterThanEqual} ${job_SPMM_C1_OWNER_ProductionStop__MinIncrementID} ) AND ( ${job_SPMM_C1_OWNER_ProductionStop__MaxIncrementID} ${greaterThanEqual} ProductionStopID )</arg>
            <arg>--split-by</arg>
            <arg>ProductionStopID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ProductionStop__DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagMS-Ingest-SPMX"/>
        <error to="TagMS-Ingest-SPMX"/>
    </action>


	<decision name="TagMS-Ingest-SPMX">
    	<switch>
			<case to="TagMS-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_TagMS_DoBase') eq 'true'}</case>
            <default to="TagMS-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="TagMS-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="TagMS-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_TagMS_DoDelta') eq 'true'}</case>
            <default to="TagMS-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="TagMS-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="TagMS-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_TagMS_DoIncrement') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPMM"/>
        </switch>
    </decision>

    <action name="TagMS-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_TagMS_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagMSID,MeasurementSetID,TagTypeID,TagValue,DT,TagTreeNodeID,X,Y, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.TagMS WHERE ( $CONDITIONS )  AND ( TagMSID ${lessThanEqual} ${job_MEXICALI_OWNER_TagMS_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_TagMS_MinBaseID} ${lessThanEqual} TagMSID )</arg>
            <arg>--split-by</arg>
            <arg>TagMSID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_TagMS_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagMS-Ingest-SPMX-IsDelta"/>
        <error to="TagMS-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="TagMS-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_TagMS_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagMSID,MeasurementSetID,TagTypeID,TagValue,DT,TagTreeNodeID,X,Y, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.TagMS WHERE ( $CONDITIONS )  AND ( TagMSID ${greaterThanEqual} ${job_MEXICALI_OWNER_TagMS_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>TagMSID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_TagMS_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagMS-Ingest-SPMX-IsIncrement"/>
        <error to="TagMS-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="TagMS-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_TagMS_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagMSID,MeasurementSetID,TagTypeID,TagValue,DT,TagTreeNodeID,X,Y, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.TagMS WHERE ( $CONDITIONS )  AND (  TagMSID ${greaterThanEqual} ${job_MEXICALI_OWNER_TagMS_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_TagMS_MaxIncrementID} ${greaterThanEqual} TagMSID )</arg>
            <arg>--split-by</arg>
            <arg>TagMSID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_TagMS_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPMM"/>
        <error to="UnitCount-Ingest-SPMM"/>
    </action>


	<decision name="UnitCount-Ingest-SPMM">
    	<switch>
			<case to="UnitCount-Ingest-SPMM-DoBase">${ wf:conf('job_SPMM_C1_OWNER_UnitCount_DoBase') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPMM-IsDelta"/>
        </switch>
    </decision>

	<decision name="UnitCount-Ingest-SPMM-IsDelta">
    	<switch>
			<case to="UnitCount-Ingest-SPMM-DoDelta">${ wf:conf('job_SPMM_C1_OWNER_UnitCount_DoDelta') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPMM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="UnitCount-Ingest-SPMM-IsIncrement">
    	<switch>
			<case to="UnitCount-Ingest-SPMM-DoIncrement">${ wf:conf('job_SPMM_C1_OWNER_UnitCount_DoIncrement') eq 'true'}</case>
            <default to="UnitCount_-Ingest-SPDV"/>
        </switch>
    </decision>

    <action name="UnitCount-Ingest-SPMM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_UnitCount_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS )  AND ( UnitCountID ${lessThanEqual} ${job_SPMM_C1_OWNER_UnitCount_MaxBaseID} ) AND ( ${job_SPMM_C1_OWNER_UnitCount_MinBaseID} ${lessThanEqual} UnitCountID )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_UnitCount_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPMM-IsDelta"/>
        <error to="UnitCount-Ingest-SPMM-IsDelta"/>
    </action>
    <action name="UnitCount-Ingest-SPMM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_UnitCount_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS )  AND ( UnitCountID ${greaterThanEqual} ${job_SPMM_C1_OWNER_UnitCount_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_UnitCount_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPMM-IsIncrement"/>
        <error to="UnitCount-Ingest-SPMM-IsIncrement"/>
    </action>

    <action name="UnitCount-Ingest-SPMM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_UnitCount_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS )  AND (  UnitCountID ${greaterThanEqual} ${job_SPMM_C1_OWNER_UnitCount_MinIncrementID} ) AND ( ${job_SPMM_C1_OWNER_UnitCount_MaxIncrementID} ${greaterThanEqual} UnitCountID )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_UnitCount_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount_-Ingest-SPDV"/>
        <error to="UnitCount_-Ingest-SPDV"/>
    </action>


	<decision name="UnitCount_-Ingest-SPDV">
    	<switch>
			<case to="UnitCount_-Ingest-SPDV-DoBase">${ wf:conf('job_DEVERN_OWNER_UnitCount__DoBase') eq 'true'}</case>
            <default to="UnitCount_-Ingest-SPDV-IsDelta"/>
        </switch>
    </decision>

	<decision name="UnitCount_-Ingest-SPDV-IsDelta">
    	<switch>
			<case to="UnitCount_-Ingest-SPDV-DoDelta">${ wf:conf('job_DEVERN_OWNER_UnitCount__DoDelta') eq 'true'}</case>
            <default to="UnitCount_-Ingest-SPDV-IsIncrement"/>
        </switch>
    </decision>

	<decision name="UnitCount_-Ingest-SPDV-IsIncrement">
    	<switch>
			<case to="UnitCount_-Ingest-SPDV-DoIncrement">${ wf:conf('job_DEVERN_OWNER_UnitCount__DoIncrement') eq 'true'}</case>
            <default to="VarMeasurement-Ingest-SPTT"/>
        </switch>
    </decision>

    <action name="UnitCount_-Ingest-SPDV-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_UnitCount__DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,CollectionQuantity,CollectionUnitID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedUnitCountID,Reference1,Reference2,Reference3,Reference4,Reference5, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.UnitCount_ WHERE ( $CONDITIONS )  AND ( UnitCountID ${lessThanEqual} ${job_DEVERN_OWNER_UnitCount__MaxBaseID} ) AND ( ${job_DEVERN_OWNER_UnitCount__MinBaseID} ${lessThanEqual} UnitCountID )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_UnitCount__DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount_-Ingest-SPDV-IsDelta"/>
        <error to="UnitCount_-Ingest-SPDV-IsDelta"/>
    </action>
    <action name="UnitCount_-Ingest-SPDV-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_UnitCount__DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,CollectionQuantity,CollectionUnitID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedUnitCountID,Reference1,Reference2,Reference3,Reference4,Reference5, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.UnitCount_ WHERE ( $CONDITIONS )  AND ( UnitCountID ${greaterThanEqual} ${job_DEVERN_OWNER_UnitCount__MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_UnitCount__DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount_-Ingest-SPDV-IsIncrement"/>
        <error to="UnitCount_-Ingest-SPDV-IsIncrement"/>
    </action>

    <action name="UnitCount_-Ingest-SPDV-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_UnitCount__DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,CollectionQuantity,CollectionUnitID,Comments,LoginID,OpenedDT,SavedDT,OriginalLoginID,EditedUnitCountID,Reference1,Reference2,Reference3,Reference4,Reference5, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.UnitCount_ WHERE ( $CONDITIONS )  AND (  UnitCountID ${greaterThanEqual} ${job_DEVERN_OWNER_UnitCount__MinIncrementID} ) AND ( ${job_DEVERN_OWNER_UnitCount__MaxIncrementID} ${greaterThanEqual} UnitCountID )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_UnitCount__DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurement-Ingest-SPTT"/>
        <error to="VarMeasurement-Ingest-SPTT"/>
    </action>


	<decision name="VarMeasurement-Ingest-SPTT">
    	<switch>
			<case to="VarMeasurement-Ingest-SPTT-DoBase">${ wf:conf('job_TOULOUSE_OWNER_VarMeasurement_DoBase') eq 'true'}</case>
            <default to="VarMeasurement-Ingest-SPTT-IsDelta"/>
        </switch>
    </decision>

	<decision name="VarMeasurement-Ingest-SPTT-IsDelta">
    	<switch>
			<case to="VarMeasurement-Ingest-SPTT-DoDelta">${ wf:conf('job_TOULOUSE_OWNER_VarMeasurement_DoDelta') eq 'true'}</case>
            <default to="VarMeasurement-Ingest-SPTT-IsIncrement"/>
        </switch>
    </decision>

	<decision name="VarMeasurement-Ingest-SPTT-IsIncrement">
    	<switch>
			<case to="VarMeasurement-Ingest-SPTT-DoIncrement">${ wf:conf('job_TOULOUSE_OWNER_VarMeasurement_DoIncrement') eq 'true'}</case>
            <default to="VarMeasurementP-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="VarMeasurement-Ingest-SPTT-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_VarMeasurement_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementID,SpecID,MeasurementSetID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.VarMeasurement WHERE ( $CONDITIONS )  AND ( VarMeasurementID ${lessThanEqual} ${job_TOULOUSE_OWNER_VarMeasurement_MaxBaseID} ) AND ( ${job_TOULOUSE_OWNER_VarMeasurement_MinBaseID} ${lessThanEqual} VarMeasurementID )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_VarMeasurement_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurement-Ingest-SPTT-IsDelta"/>
        <error to="VarMeasurement-Ingest-SPTT-IsDelta"/>
    </action>
    <action name="VarMeasurement-Ingest-SPTT-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_VarMeasurement_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementID,SpecID,MeasurementSetID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.VarMeasurement WHERE ( $CONDITIONS )  AND ( VarMeasurementID ${greaterThanEqual} ${job_TOULOUSE_OWNER_VarMeasurement_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_VarMeasurement_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurement-Ingest-SPTT-IsIncrement"/>
        <error to="VarMeasurement-Ingest-SPTT-IsIncrement"/>
    </action>

    <action name="VarMeasurement-Ingest-SPTT-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_VarMeasurement_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementID,SpecID,MeasurementSetID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.VarMeasurement WHERE ( $CONDITIONS )  AND (  VarMeasurementID ${greaterThanEqual} ${job_TOULOUSE_OWNER_VarMeasurement_MinIncrementID} ) AND ( ${job_TOULOUSE_OWNER_VarMeasurement_MaxIncrementID} ${greaterThanEqual} VarMeasurementID )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_VarMeasurement_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurementP-Ingest-SPTM"/>
        <error to="VarMeasurementP-Ingest-SPTM"/>
    </action>


	<decision name="VarMeasurementP-Ingest-SPTM">
    	<switch>
			<case to="VarMeasurementP-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurementP_DoBase') eq 'true'}</case>
            <default to="VarMeasurementP-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="VarMeasurementP-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="VarMeasurementP-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurementP_DoDelta') eq 'true'}</case>
            <default to="VarMeasurementP-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="VarMeasurementP-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="VarMeasurementP-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurementP_DoIncrement') eq 'true'}</case>
            <default to="InventoryLabel-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="VarMeasurementP-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurementP_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementPID,SpecID,MeasurementSetPID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurementP WHERE ( $CONDITIONS )  AND ( VarMeasurementPID ${lessThanEqual} ${job_CAPETOWN_OWNER_VarMeasurementP_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_VarMeasurementP_MinBaseID} ${lessThanEqual} VarMeasurementPID )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementPID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurementP_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurementP-Ingest-SPTM-IsDelta"/>
        <error to="VarMeasurementP-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="VarMeasurementP-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurementP_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementPID,SpecID,MeasurementSetPID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurementP WHERE ( $CONDITIONS )  AND ( VarMeasurementPID ${greaterThanEqual} ${job_CAPETOWN_OWNER_VarMeasurementP_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementPID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurementP_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurementP-Ingest-SPTM-IsIncrement"/>
        <error to="VarMeasurementP-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="VarMeasurementP-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurementP_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementPID,SpecID,MeasurementSetPID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurementP WHERE ( $CONDITIONS )  AND (  VarMeasurementPID ${greaterThanEqual} ${job_CAPETOWN_OWNER_VarMeasurementP_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_VarMeasurementP_MaxIncrementID} ${greaterThanEqual} VarMeasurementPID )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementPID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurementP_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryLabel-Ingest-SPMX"/>
        <error to="InventoryLabel-Ingest-SPMX"/>
    </action>


	<decision name="InventoryLabel-Ingest-SPMX">
    	<switch>
			<case to="InventoryLabel-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_InventoryLabel_DoBase') eq 'true'}</case>
            <default to="InventoryLabel-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="InventoryLabel-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="InventoryLabel-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_InventoryLabel_DoDelta') eq 'true'}</case>
            <default to="InventoryLabel-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="InventoryLabel-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="InventoryLabel-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_InventoryLabel_DoIncrement') eq 'true'}</case>
            <default to="InventoryPack-Ingest-SPDV"/>
        </switch>
    </decision>

    <action name="InventoryLabel-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InventoryLabel_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryLabel.InventoryLabelID, InventoryLabel.MachineStage, InventoryLabel.PartNumber, InventoryLabel.PartType, InventoryLabel.QuantityOrdered, InventoryLabel.WONumber, InventoryLabel.InventoryPackNo, InventoryLabel.CreatedFromDT, InventoryLabel.Quantity, InventoryLabel.Unit, InventoryLabel.Line, InventoryLabel.LabelTemplate, InventoryLabel.LabelsPerInventoryPack, InventoryLabel.ItemsPerLayer, InventoryLabel.LayersPerInventoryPack, InventoryLabel.PrinterURL, InventoryLabel.PrintedDT, InventoryLabel.ItemsPerInventoryPack, InventoryLabel.ScannedDT, InventoryLabel.IsCancelled, InventoryLabel.OrderQuantityPacks, InventoryLabel.LineShortName, InventoryLabel.PackNo, InventoryLabel.IsReprint, InventoryLabel.PartDescription, InventoryLabel.LabelSaveDirectory, InventoryLabel.JobID, InventoryLabel.IsPrintLandscape, InventoryLabel.NoCopies, InventoryLabel_.LabelColour, InventoryLabel_.EANCode, InventoryLabel_.CusNum, InventoryLabel_.PackingCode, InventoryLabel_.CustomerPartNo, InventoryLabel_.CustomerPartDescription, InventoryLabel_.LabelText1, InventoryLabel_.LabelText2, InventoryLabel_.LabelText3, InventoryLabel_.Customer, InventoryLabel_.Address1, InventoryLabel_.Address2, InventoryLabel_.City, InventoryLabel_.County, InventoryLabel_.PostCode, InventoryLabel_.Country, InventoryLabel_custom.InventoryPackID,  1 as "org_id",  'SPMX' as "org_name"  FROM InventoryLabel FULL JOIN InventoryLabel_ ON (InventoryLabel.InventoryLabelID = InventoryLabel_.InventoryLabelID) FULL JOIN InventoryLabel_custom ON (InventoryLabel.InventoryLabelID = InventoryLabel_custom.InventoryLabelID)   WHERE ( $CONDITIONS )  AND ( InventoryLabel.InventoryLabelID ${lessThanEqual} ${job_MEXICALI_OWNER_InventoryLabel_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_InventoryLabel_MinBaseID} ${lessThanEqual} InventoryLabel.InventoryLabelID )</arg>
            <arg>--split-by</arg>
            <arg>InventoryLabel.InventoryLabelID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InventoryLabel_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryLabel-Ingest-SPMX-IsDelta"/>
        <error to="InventoryLabel-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="InventoryLabel-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InventoryLabel_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryLabel.InventoryLabelID, InventoryLabel.MachineStage, InventoryLabel.PartNumber, InventoryLabel.PartType, InventoryLabel.QuantityOrdered, InventoryLabel.WONumber, InventoryLabel.InventoryPackNo, InventoryLabel.CreatedFromDT, InventoryLabel.Quantity, InventoryLabel.Unit, InventoryLabel.Line, InventoryLabel.LabelTemplate, InventoryLabel.LabelsPerInventoryPack, InventoryLabel.ItemsPerLayer, InventoryLabel.LayersPerInventoryPack, InventoryLabel.PrinterURL, InventoryLabel.PrintedDT, InventoryLabel.ItemsPerInventoryPack, InventoryLabel.ScannedDT, InventoryLabel.IsCancelled, InventoryLabel.OrderQuantityPacks, InventoryLabel.LineShortName, InventoryLabel.PackNo, InventoryLabel.IsReprint, InventoryLabel.PartDescription, InventoryLabel.LabelSaveDirectory, InventoryLabel.JobID, InventoryLabel.IsPrintLandscape, InventoryLabel.NoCopies, InventoryLabel_.LabelColour, InventoryLabel_.EANCode, InventoryLabel_.CusNum, InventoryLabel_.PackingCode, InventoryLabel_.CustomerPartNo, InventoryLabel_.CustomerPartDescription, InventoryLabel_.LabelText1, InventoryLabel_.LabelText2, InventoryLabel_.LabelText3, InventoryLabel_.Customer, InventoryLabel_.Address1, InventoryLabel_.Address2, InventoryLabel_.City, InventoryLabel_.County, InventoryLabel_.PostCode, InventoryLabel_.Country, InventoryLabel_custom.InventoryPackID,  1 as "org_id",  'SPMX' as "org_name"  FROM InventoryLabel FULL JOIN InventoryLabel_ ON (InventoryLabel.InventoryLabelID = InventoryLabel_.InventoryLabelID) FULL JOIN InventoryLabel_custom ON (InventoryLabel.InventoryLabelID = InventoryLabel_custom.InventoryLabelID)   WHERE ( $CONDITIONS )  AND ( InventoryLabel.InventoryLabelID ${greaterThanEqual} ${job_MEXICALI_OWNER_InventoryLabel_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>InventoryLabel.InventoryLabelID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InventoryLabel_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryLabel-Ingest-SPMX-IsIncrement"/>
        <error to="InventoryLabel-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="InventoryLabel-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InventoryLabel_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryLabel.InventoryLabelID, InventoryLabel.MachineStage, InventoryLabel.PartNumber, InventoryLabel.PartType, InventoryLabel.QuantityOrdered, InventoryLabel.WONumber, InventoryLabel.InventoryPackNo, InventoryLabel.CreatedFromDT, InventoryLabel.Quantity, InventoryLabel.Unit, InventoryLabel.Line, InventoryLabel.LabelTemplate, InventoryLabel.LabelsPerInventoryPack, InventoryLabel.ItemsPerLayer, InventoryLabel.LayersPerInventoryPack, InventoryLabel.PrinterURL, InventoryLabel.PrintedDT, InventoryLabel.ItemsPerInventoryPack, InventoryLabel.ScannedDT, InventoryLabel.IsCancelled, InventoryLabel.OrderQuantityPacks, InventoryLabel.LineShortName, InventoryLabel.PackNo, InventoryLabel.IsReprint, InventoryLabel.PartDescription, InventoryLabel.LabelSaveDirectory, InventoryLabel.JobID, InventoryLabel.IsPrintLandscape, InventoryLabel.NoCopies, InventoryLabel_.LabelColour, InventoryLabel_.EANCode, InventoryLabel_.CusNum, InventoryLabel_.PackingCode, InventoryLabel_.CustomerPartNo, InventoryLabel_.CustomerPartDescription, InventoryLabel_.LabelText1, InventoryLabel_.LabelText2, InventoryLabel_.LabelText3, InventoryLabel_.Customer, InventoryLabel_.Address1, InventoryLabel_.Address2, InventoryLabel_.City, InventoryLabel_.County, InventoryLabel_.PostCode, InventoryLabel_.Country, InventoryLabel_custom.InventoryPackID,  1 as "org_id",  'SPMX' as "org_name"  FROM InventoryLabel FULL JOIN InventoryLabel_ ON (InventoryLabel.InventoryLabelID = InventoryLabel_.InventoryLabelID) FULL JOIN InventoryLabel_custom ON (InventoryLabel.InventoryLabelID = InventoryLabel_custom.InventoryLabelID)   WHERE ( $CONDITIONS )  AND (  InventoryLabel.InventoryLabelID ${greaterThanEqual} ${job_MEXICALI_OWNER_InventoryLabel_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_InventoryLabel_MaxIncrementID} ${greaterThanEqual} InventoryLabel.InventoryLabelID )</arg>
            <arg>--split-by</arg>
            <arg>InventoryLabel.InventoryLabelID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InventoryLabel_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryPack-Ingest-SPDV"/>
        <error to="InventoryPack-Ingest-SPDV"/>
    </action>


	<decision name="InventoryPack-Ingest-SPDV">
    	<switch>
			<case to="InventoryPack-Ingest-SPDV-DoBase">${ wf:conf('job_DEVERN_OWNER_InventoryPack_DoBase') eq 'true'}</case>
            <default to="InventoryPack-Ingest-SPDV-IsDelta"/>
        </switch>
    </decision>

	<decision name="InventoryPack-Ingest-SPDV-IsDelta">
    	<switch>
			<case to="InventoryPack-Ingest-SPDV-DoDelta">${ wf:conf('job_DEVERN_OWNER_InventoryPack_DoDelta') eq 'true'}</case>
            <default to="InventoryPack-Ingest-SPDV-IsIncrement"/>
        </switch>
    </decision>

	<decision name="InventoryPack-Ingest-SPDV-IsIncrement">
    	<switch>
			<case to="InventoryPack-Ingest-SPDV-DoIncrement">${ wf:conf('job_DEVERN_OWNER_InventoryPack_DoIncrement') eq 'true'}</case>
            <default to="WO-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="InventoryPack-Ingest-SPDV-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_InventoryPack_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryPack.InventoryPackID, InventoryPack.InventoryPackNo, InventoryPack.WOID, InventoryPack.JobID, InventoryPack.CreatedFromDT, InventoryPack.CreatedToDT, InventoryPack.CreatedOnMachineStageID, InventoryPack.IsEdited, InventoryPack.RevisionNo, InventoryPack.PartID, InventoryPack.Quantity, InventoryPack.UnitID, InventoryPack.Ignored, InventoryPack.InventoryPackIndex, InventoryPack.CustomerUniqueKey, InventoryPack.ReceivedDT, InventoryPack.BirthDT, InventoryPack.LastBuildRecordID, InventoryPack.msrepl_tran_version, InventoryPack.CurrentQuantity, InventoryPack.QuantityAdjustment, InventoryPack.PositionNumber, InventoryPack.LocationID, InventoryPack.InvStateID, InventoryPack.LocationFromDT, InventoryPack_.Comments, InventoryPack_.LoginID, InventoryPack_.OpenedDT, InventoryPack_.SavedDT, InventoryPack_.OriginalLoginID, InventoryPack_.EditedInventoryPackID, InventoryPack_.Reference1, InventoryPack_.Reference2, InventoryPack_.Reference3, InventoryPack_.Reference4, InventoryPack_.Reference5, InventoryPack_.Reference6, InventoryPack_.Reference7, InventoryPack_.Reference8, InventoryPack_.Reference9, InventoryPack_.Reference10, InventoryPack_.SupplierID, InventoryPack_.SupplierReference, InventoryPack_.UseByDT, InventoryPack_.UseAfterDT, InventoryPack_Custom.Txn_date, InventoryPack_Custom.OracleStatus, InventoryPack_Custom.IntendedWOID, InventoryPack_Custom.FinalWOID, InventoryPack_Custom.OriginalQty, InventoryPack_Custom.Seq_Id, InventoryPack_Custom.From_Subinventory, InventoryPack_Custom.From_Locator, InventoryPack_Custom.To_Subinventory, InventoryPack_Custom.To_Locator, InventoryPack_Custom.ScrappedShiftID, InventoryPack_Custom.LastInventoryLabelID, InventoryPack_Custom.ScrapLocationID, InventoryPack_Custom.MachineLocationID, InventoryPack_Custom.ScrapReasonID, InventoryPack_Custom.ModuleInfoID, InventoryPack_Custom.ResealedDT,  3 as "org_id",  'SPDV' as "org_name"  FROM InventoryPack FULL JOIN InventoryPack_ ON (InventoryPack.InventoryPackID = InventoryPack_.InventoryPackID) FULL JOIN InventoryPack_Custom ON (InventoryPack.InventoryPackID = InventoryPack_Custom.InventoryPackId)   WHERE ( $CONDITIONS )  AND ( InventoryPack.InventoryPackID ${lessThanEqual} ${job_DEVERN_OWNER_InventoryPack_MaxBaseID} ) AND ( ${job_DEVERN_OWNER_InventoryPack_MinBaseID} ${lessThanEqual} InventoryPack.InventoryPackID )</arg>
            <arg>--split-by</arg>
            <arg>InventoryPack.InventoryPackID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_InventoryPack_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryPack-Ingest-SPDV-IsDelta"/>
        <error to="InventoryPack-Ingest-SPDV-IsDelta"/>
    </action>
    <action name="InventoryPack-Ingest-SPDV-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_InventoryPack_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryPack.InventoryPackID, InventoryPack.InventoryPackNo, InventoryPack.WOID, InventoryPack.JobID, InventoryPack.CreatedFromDT, InventoryPack.CreatedToDT, InventoryPack.CreatedOnMachineStageID, InventoryPack.IsEdited, InventoryPack.RevisionNo, InventoryPack.PartID, InventoryPack.Quantity, InventoryPack.UnitID, InventoryPack.Ignored, InventoryPack.InventoryPackIndex, InventoryPack.CustomerUniqueKey, InventoryPack.ReceivedDT, InventoryPack.BirthDT, InventoryPack.LastBuildRecordID, InventoryPack.msrepl_tran_version, InventoryPack.CurrentQuantity, InventoryPack.QuantityAdjustment, InventoryPack.PositionNumber, InventoryPack.LocationID, InventoryPack.InvStateID, InventoryPack.LocationFromDT, InventoryPack_.Comments, InventoryPack_.LoginID, InventoryPack_.OpenedDT, InventoryPack_.SavedDT, InventoryPack_.OriginalLoginID, InventoryPack_.EditedInventoryPackID, InventoryPack_.Reference1, InventoryPack_.Reference2, InventoryPack_.Reference3, InventoryPack_.Reference4, InventoryPack_.Reference5, InventoryPack_.Reference6, InventoryPack_.Reference7, InventoryPack_.Reference8, InventoryPack_.Reference9, InventoryPack_.Reference10, InventoryPack_.SupplierID, InventoryPack_.SupplierReference, InventoryPack_.UseByDT, InventoryPack_.UseAfterDT, InventoryPack_Custom.Txn_date, InventoryPack_Custom.OracleStatus, InventoryPack_Custom.IntendedWOID, InventoryPack_Custom.FinalWOID, InventoryPack_Custom.OriginalQty, InventoryPack_Custom.Seq_Id, InventoryPack_Custom.From_Subinventory, InventoryPack_Custom.From_Locator, InventoryPack_Custom.To_Subinventory, InventoryPack_Custom.To_Locator, InventoryPack_Custom.ScrappedShiftID, InventoryPack_Custom.LastInventoryLabelID, InventoryPack_Custom.ScrapLocationID, InventoryPack_Custom.MachineLocationID, InventoryPack_Custom.ScrapReasonID, InventoryPack_Custom.ModuleInfoID, InventoryPack_Custom.ResealedDT,  3 as "org_id",  'SPDV' as "org_name"  FROM InventoryPack FULL JOIN InventoryPack_ ON (InventoryPack.InventoryPackID = InventoryPack_.InventoryPackID) FULL JOIN InventoryPack_Custom ON (InventoryPack.InventoryPackID = InventoryPack_Custom.InventoryPackId)   WHERE ( $CONDITIONS )  AND ( InventoryPack.InventoryPackID ${greaterThanEqual} ${job_DEVERN_OWNER_InventoryPack_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>InventoryPack.InventoryPackID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_InventoryPack_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryPack-Ingest-SPDV-IsIncrement"/>
        <error to="InventoryPack-Ingest-SPDV-IsIncrement"/>
    </action>

    <action name="InventoryPack-Ingest-SPDV-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_InventoryPack_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryPack.InventoryPackID, InventoryPack.InventoryPackNo, InventoryPack.WOID, InventoryPack.JobID, InventoryPack.CreatedFromDT, InventoryPack.CreatedToDT, InventoryPack.CreatedOnMachineStageID, InventoryPack.IsEdited, InventoryPack.RevisionNo, InventoryPack.PartID, InventoryPack.Quantity, InventoryPack.UnitID, InventoryPack.Ignored, InventoryPack.InventoryPackIndex, InventoryPack.CustomerUniqueKey, InventoryPack.ReceivedDT, InventoryPack.BirthDT, InventoryPack.LastBuildRecordID, InventoryPack.msrepl_tran_version, InventoryPack.CurrentQuantity, InventoryPack.QuantityAdjustment, InventoryPack.PositionNumber, InventoryPack.LocationID, InventoryPack.InvStateID, InventoryPack.LocationFromDT, InventoryPack_.Comments, InventoryPack_.LoginID, InventoryPack_.OpenedDT, InventoryPack_.SavedDT, InventoryPack_.OriginalLoginID, InventoryPack_.EditedInventoryPackID, InventoryPack_.Reference1, InventoryPack_.Reference2, InventoryPack_.Reference3, InventoryPack_.Reference4, InventoryPack_.Reference5, InventoryPack_.Reference6, InventoryPack_.Reference7, InventoryPack_.Reference8, InventoryPack_.Reference9, InventoryPack_.Reference10, InventoryPack_.SupplierID, InventoryPack_.SupplierReference, InventoryPack_.UseByDT, InventoryPack_.UseAfterDT, InventoryPack_Custom.Txn_date, InventoryPack_Custom.OracleStatus, InventoryPack_Custom.IntendedWOID, InventoryPack_Custom.FinalWOID, InventoryPack_Custom.OriginalQty, InventoryPack_Custom.Seq_Id, InventoryPack_Custom.From_Subinventory, InventoryPack_Custom.From_Locator, InventoryPack_Custom.To_Subinventory, InventoryPack_Custom.To_Locator, InventoryPack_Custom.ScrappedShiftID, InventoryPack_Custom.LastInventoryLabelID, InventoryPack_Custom.ScrapLocationID, InventoryPack_Custom.MachineLocationID, InventoryPack_Custom.ScrapReasonID, InventoryPack_Custom.ModuleInfoID, InventoryPack_Custom.ResealedDT,  3 as "org_id",  'SPDV' as "org_name"  FROM InventoryPack FULL JOIN InventoryPack_ ON (InventoryPack.InventoryPackID = InventoryPack_.InventoryPackID) FULL JOIN InventoryPack_Custom ON (InventoryPack.InventoryPackID = InventoryPack_Custom.InventoryPackId)   WHERE ( $CONDITIONS )  AND (  InventoryPack.InventoryPackID ${greaterThanEqual} ${job_DEVERN_OWNER_InventoryPack_MinIncrementID} ) AND ( ${job_DEVERN_OWNER_InventoryPack_MaxIncrementID} ${greaterThanEqual} InventoryPack.InventoryPackID )</arg>
            <arg>--split-by</arg>
            <arg>InventoryPack.InventoryPackID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_InventoryPack_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO-Ingest-SPMX"/>
        <error to="WO-Ingest-SPMX"/>
    </action>


	<decision name="WO-Ingest-SPMX">
    	<switch>
			<case to="WO-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_WO_DoBase') eq 'true'}</case>
            <default to="WO-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="WO-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="WO-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_WO_DoDelta') eq 'true'}</case>
            <default to="WO-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="WO-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="WO-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_WO_DoIncrement') eq 'true'}</case>
            <default to="End-Incr-2-Ingest"/>
        </switch>
    </decision>

    <action name="WO-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_WO_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WO.WOID, WO.WONumber, WO.RunNo, WO.PartID, WO.QuantityOrdered, WO.RfJobStatusID, WO.DeadlineDT, WO.ActualStartDT, WO.ActualEndDT, WO.PlannedStartDT, WO.PlannedEndDT, WO.EstimatedStartDT, WO.EstimatedEndDT, WO.CustomerID, WO.IsDiscrete, WO.Reference1, WO.Reference2, WO.Reference3, WO.Reference4, WO.Reference5, WO.WORefID, WO_.CustomerOrderNo, WO_.LabelsPerInventoryPack, WO_.ItemsPerInventoryPack, WO_.ItemsPerLayer, WO_.LayersPerInventoryPack, WO_.PackingCode, WO_.LabelTemplate, WO_.LabelColour, WO_.EANCode, WO_.CusStartNum, WO_.CusEndNum, WO_.CustomerPartNo, WO_.CustomerPartDescription, WO_.LabelText1, WO_.LabelText2, WO_.LabelText3, WO_.PrinterURL, WO_.BOMVariantID, WO_custom.BaseWONumber, WO_custom.Txn_date, WO_custom.Wip_Entity_ID, WO_custom.Alternate_Bom, WO_custom.WO_Status, WO_custom.IsBtoCto,  1 as "org_id",  'SPMX' as "org_name"  FROM WO FULL JOIN WO_ ON (WO.WOID = WO_.WOID) FULL JOIN WO_custom ON (WO.WOID = WO_custom.WOID)   WHERE ( $CONDITIONS )  AND ( WO.WOID ${lessThanEqual} ${job_MEXICALI_OWNER_WO_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_WO_MinBaseID} ${lessThanEqual} WO.WOID )</arg>
            <arg>--split-by</arg>
            <arg>WO.WOID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_WO_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO-Ingest-SPMX-IsDelta"/>
        <error to="WO-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="WO-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_WO_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WO.WOID, WO.WONumber, WO.RunNo, WO.PartID, WO.QuantityOrdered, WO.RfJobStatusID, WO.DeadlineDT, WO.ActualStartDT, WO.ActualEndDT, WO.PlannedStartDT, WO.PlannedEndDT, WO.EstimatedStartDT, WO.EstimatedEndDT, WO.CustomerID, WO.IsDiscrete, WO.Reference1, WO.Reference2, WO.Reference3, WO.Reference4, WO.Reference5, WO.WORefID, WO_.CustomerOrderNo, WO_.LabelsPerInventoryPack, WO_.ItemsPerInventoryPack, WO_.ItemsPerLayer, WO_.LayersPerInventoryPack, WO_.PackingCode, WO_.LabelTemplate, WO_.LabelColour, WO_.EANCode, WO_.CusStartNum, WO_.CusEndNum, WO_.CustomerPartNo, WO_.CustomerPartDescription, WO_.LabelText1, WO_.LabelText2, WO_.LabelText3, WO_.PrinterURL, WO_.BOMVariantID, WO_custom.BaseWONumber, WO_custom.Txn_date, WO_custom.Wip_Entity_ID, WO_custom.Alternate_Bom, WO_custom.WO_Status, WO_custom.IsBtoCto,  1 as "org_id",  'SPMX' as "org_name"  FROM WO FULL JOIN WO_ ON (WO.WOID = WO_.WOID) FULL JOIN WO_custom ON (WO.WOID = WO_custom.WOID)   WHERE ( $CONDITIONS )  AND ( WO.WOID ${greaterThanEqual} ${job_MEXICALI_OWNER_WO_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>WO.WOID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_WO_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WO-Ingest-SPMX-IsIncrement"/>
        <error to="WO-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="WO-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_WO_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WO.WOID, WO.WONumber, WO.RunNo, WO.PartID, WO.QuantityOrdered, WO.RfJobStatusID, WO.DeadlineDT, WO.ActualStartDT, WO.ActualEndDT, WO.PlannedStartDT, WO.PlannedEndDT, WO.EstimatedStartDT, WO.EstimatedEndDT, WO.CustomerID, WO.IsDiscrete, WO.Reference1, WO.Reference2, WO.Reference3, WO.Reference4, WO.Reference5, WO.WORefID, WO_.CustomerOrderNo, WO_.LabelsPerInventoryPack, WO_.ItemsPerInventoryPack, WO_.ItemsPerLayer, WO_.LayersPerInventoryPack, WO_.PackingCode, WO_.LabelTemplate, WO_.LabelColour, WO_.EANCode, WO_.CusStartNum, WO_.CusEndNum, WO_.CustomerPartNo, WO_.CustomerPartDescription, WO_.LabelText1, WO_.LabelText2, WO_.LabelText3, WO_.PrinterURL, WO_.BOMVariantID, WO_custom.BaseWONumber, WO_custom.Txn_date, WO_custom.Wip_Entity_ID, WO_custom.Alternate_Bom, WO_custom.WO_Status, WO_custom.IsBtoCto,  1 as "org_id",  'SPMX' as "org_name"  FROM WO FULL JOIN WO_ ON (WO.WOID = WO_.WOID) FULL JOIN WO_custom ON (WO.WOID = WO_custom.WOID)   WHERE ( $CONDITIONS )  AND (  WO.WOID ${greaterThanEqual} ${job_MEXICALI_OWNER_WO_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_WO_MaxIncrementID} ${greaterThanEqual} WO.WOID )</arg>
            <arg>--split-by</arg>
            <arg>WO.WOID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_WO_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Incr-2-Ingest"/>
        <error to="End-Incr-2-Ingest"/>
    </action>


	<end name="End-Incr-2-Ingest"/>
</workflow-app>

<workflow-app name="Ingest-Incr-7" xmlns="uri:oozie:workflow:0.1">

 	<start to="DefectCount-Ingest-SPMX"/>


	<decision name="DefectCount-Ingest-SPMX">
    	<switch>
			<case to="DefectCount-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_DefectCount_DoBase') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="DefectCount-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="DefectCount-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_DefectCount_DoDelta') eq 'true'}</case>
            <default to="DefectCount-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="DefectCount-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="DefectCount-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_DefectCount_DoIncrement') eq 'true'}</case>
            <default to="InvChangeState-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="DefectCount-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_DefectCount_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS )  AND ( DefectCountID ${lessThanEqual} ${job_MEXICALI_OWNER_DefectCount_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_DefectCount_MinBaseID} ${lessThanEqual} DefectCountID )</arg>
            <arg>--split-by</arg>
            <arg>DefectCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_DefectCount_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPMX-IsDelta"/>
        <error to="DefectCount-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="DefectCount-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_DefectCount_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS )  AND ( DefectCountID ${greaterThanEqual} ${job_MEXICALI_OWNER_DefectCount_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>DefectCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_DefectCount_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="DefectCount-Ingest-SPMX-IsIncrement"/>
        <error to="DefectCount-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="DefectCount-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_DefectCount_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT DefectCountID,MeasurementSetID,HeadNo,DefectCount,Ignored,AttributeTypeID,ProductID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.DefectCount WHERE ( $CONDITIONS )  AND (  DefectCountID ${greaterThanEqual} ${job_MEXICALI_OWNER_DefectCount_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_DefectCount_MaxIncrementID} ${greaterThanEqual} DefectCountID )</arg>
            <arg>--split-by</arg>
            <arg>DefectCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_DefectCount_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPMX"/>
        <error to="InvChangeState-Ingest-SPMX"/>
    </action>


	<decision name="InvChangeState-Ingest-SPMX">
    	<switch>
			<case to="InvChangeState-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_InvChangeState_DoBase') eq 'true'}</case>
            <default to="InvChangeState-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="InvChangeState-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="InvChangeState-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_InvChangeState_DoDelta') eq 'true'}</case>
            <default to="InvChangeState-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="InvChangeState-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="InvChangeState-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_InvChangeState_DoIncrement') eq 'true'}</case>
            <default to="LineInfo-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="InvChangeState-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InvChangeState_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 1 as "org_id",  'SPMX' as "org_name" , (DatePart(HOUR,InvChangeState.FromDT)) as "Trans_Hours" , (case when DatePart(HOUR,InvChangeState.FromDT) ${lessThan} 7 then cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) -1 else cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) end) as "ShiftStart_DateTime"   FROM dbo.InvChangeState WHERE ( $CONDITIONS )  AND ( InvChangeStateID ${lessThanEqual} ${job_MEXICALI_OWNER_InvChangeState_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_InvChangeState_MinBaseID} ${lessThanEqual} InvChangeStateID )</arg>
            <arg>--split-by</arg>
            <arg>InvChangeStateID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InvChangeState_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPMX-IsDelta"/>
        <error to="InvChangeState-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="InvChangeState-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InvChangeState_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 1 as "org_id",  'SPMX' as "org_name" , (DatePart(HOUR,InvChangeState.FromDT)) as "Trans_Hours" , (case when DatePart(HOUR,InvChangeState.FromDT) ${lessThan} 7 then cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) -1 else cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) end) as "ShiftStart_DateTime"   FROM dbo.InvChangeState WHERE ( $CONDITIONS )  AND ( InvChangeStateID ${greaterThanEqual} ${job_MEXICALI_OWNER_InvChangeState_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>InvChangeStateID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InvChangeState_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InvChangeState-Ingest-SPMX-IsIncrement"/>
        <error to="InvChangeState-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="InvChangeState-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InvChangeState_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InvChangeStateID,InventoryPackID,FromDT,ToDT,InvIsolatedReasonID,Comments,LoginID,OpenedDT,SavedDT,IsEdited,RevisionNo,OriginalLoginID,EditedInvChangeStateID,InvStateID, 1 as "org_id",  'SPMX' as "org_name" , (DatePart(HOUR,InvChangeState.FromDT)) as "Trans_Hours" , (case when DatePart(HOUR,InvChangeState.FromDT) ${lessThan} 7 then cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) -1 else cast(convert(char(11), InvChangeState.FromDT, 113) as datetime) end) as "ShiftStart_DateTime"   FROM dbo.InvChangeState WHERE ( $CONDITIONS )  AND (  InvChangeStateID ${greaterThanEqual} ${job_MEXICALI_OWNER_InvChangeState_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_InvChangeState_MaxIncrementID} ${greaterThanEqual} InvChangeStateID )</arg>
            <arg>--split-by</arg>
            <arg>InvChangeStateID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InvChangeState_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo-Ingest-SPMX"/>
        <error to="LineInfo-Ingest-SPMX"/>
    </action>


	<decision name="LineInfo-Ingest-SPMX">
    	<switch>
			<case to="LineInfo-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_LineInfo_DoBase') eq 'true'}</case>
            <default to="LineInfo-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="LineInfo-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="LineInfo-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_LineInfo_DoDelta') eq 'true'}</case>
            <default to="LineInfo-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="LineInfo-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="LineInfo-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_LineInfo_DoIncrement') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="LineInfo-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LineInfo_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,RfLineInfoEventID,LineID,ShiftID,WOID,FromDT,ToDT,rfDayHourPeriodID,TotalTime,ExcludedTime,ScheduledTime,STOperations,STInduced,DTTechnical,DTOperations,DTQuality,DownTime,StopTime,RunTime,NotRunTime,TheoreticalCycleTime,QuantityScrap,QuantityGood,ModifiedDT,LoginID,QuantityIn,TotalInventoryProduced,TotalInventoryReintroduced,NetQuantityProduced,QuantityInLineSpoilage,TotalSpoilage,AccountedSpoilage,TotalInventoryIsolated,ProductionStopJobID,TotalUnitsProduced,BottleNeckMachineStageID,InventoryIn,InterProdStopTime,InProdStopTime,QuantityUnitsIn,QuantityInventoryIn,TotalQuantityProduced,TotalPacksProduced,TotalPacksIsolated,TotalPacksReintroduced,TotalPacksMade,ValidState,LineGroupID,LineGroupShiftID,LineGroupBottleneckID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LineInfo WHERE ( $CONDITIONS )  AND ( LineInfoID ${lessThanEqual} ${job_MEXICALI_OWNER_LineInfo_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_LineInfo_MinBaseID} ${lessThanEqual} LineInfoID )</arg>
            <arg>--split-by</arg>
            <arg>LineInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LineInfo_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo-Ingest-SPMX-IsDelta"/>
        <error to="LineInfo-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="LineInfo-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LineInfo_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,RfLineInfoEventID,LineID,ShiftID,WOID,FromDT,ToDT,rfDayHourPeriodID,TotalTime,ExcludedTime,ScheduledTime,STOperations,STInduced,DTTechnical,DTOperations,DTQuality,DownTime,StopTime,RunTime,NotRunTime,TheoreticalCycleTime,QuantityScrap,QuantityGood,ModifiedDT,LoginID,QuantityIn,TotalInventoryProduced,TotalInventoryReintroduced,NetQuantityProduced,QuantityInLineSpoilage,TotalSpoilage,AccountedSpoilage,TotalInventoryIsolated,ProductionStopJobID,TotalUnitsProduced,BottleNeckMachineStageID,InventoryIn,InterProdStopTime,InProdStopTime,QuantityUnitsIn,QuantityInventoryIn,TotalQuantityProduced,TotalPacksProduced,TotalPacksIsolated,TotalPacksReintroduced,TotalPacksMade,ValidState,LineGroupID,LineGroupShiftID,LineGroupBottleneckID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LineInfo WHERE ( $CONDITIONS )  AND ( LineInfoID ${greaterThanEqual} ${job_MEXICALI_OWNER_LineInfo_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>LineInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LineInfo_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo-Ingest-SPMX-IsIncrement"/>
        <error to="LineInfo-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="LineInfo-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LineInfo_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,RfLineInfoEventID,LineID,ShiftID,WOID,FromDT,ToDT,rfDayHourPeriodID,TotalTime,ExcludedTime,ScheduledTime,STOperations,STInduced,DTTechnical,DTOperations,DTQuality,DownTime,StopTime,RunTime,NotRunTime,TheoreticalCycleTime,QuantityScrap,QuantityGood,ModifiedDT,LoginID,QuantityIn,TotalInventoryProduced,TotalInventoryReintroduced,NetQuantityProduced,QuantityInLineSpoilage,TotalSpoilage,AccountedSpoilage,TotalInventoryIsolated,ProductionStopJobID,TotalUnitsProduced,BottleNeckMachineStageID,InventoryIn,InterProdStopTime,InProdStopTime,QuantityUnitsIn,QuantityInventoryIn,TotalQuantityProduced,TotalPacksProduced,TotalPacksIsolated,TotalPacksReintroduced,TotalPacksMade,ValidState,LineGroupID,LineGroupShiftID,LineGroupBottleneckID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LineInfo WHERE ( $CONDITIONS )  AND (  LineInfoID ${greaterThanEqual} ${job_MEXICALI_OWNER_LineInfo_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_LineInfo_MaxIncrementID} ${greaterThanEqual} LineInfoID )</arg>
            <arg>--split-by</arg>
            <arg>LineInfoID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LineInfo_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPMX"/>
        <error to="LkPartLineSection-Ingest-SPMX"/>
    </action>


	<decision name="LkPartLineSection-Ingest-SPMX">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_LkPartLineSection_DoBase') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="LkPartLineSection-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_LkPartLineSection_DoDelta') eq 'true'}</case>
            <default to="LkPartLineSection-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="LkPartLineSection-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="LkPartLineSection-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_LkPartLineSection_DoIncrement') eq 'true'}</case>
            <default to="MeasurementSet-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="LkPartLineSection-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkPartLineSection_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS )  AND ( PartID ${lessThanEqual} ${job_MEXICALI_OWNER_LkPartLineSection_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_LkPartLineSection_MinBaseID} ${lessThanEqual} PartID )</arg>
            <arg>--split-by</arg>
            <arg>PartID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkPartLineSection_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPMX-IsDelta"/>
        <error to="LkPartLineSection-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="LkPartLineSection-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkPartLineSection_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS )  AND ( PartID ${greaterThanEqual} ${job_MEXICALI_OWNER_LkPartLineSection_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>PartID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkPartLineSection_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartLineSection-Ingest-SPMX-IsIncrement"/>
        <error to="LkPartLineSection-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="LkPartLineSection-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkPartLineSection_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartID,LineSectionID,LkPartLineSectionID,TheoreticalCycleTime, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkPartLineSection WHERE ( $CONDITIONS )  AND (  PartID ${greaterThanEqual} ${job_MEXICALI_OWNER_LkPartLineSection_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_LkPartLineSection_MaxIncrementID} ${greaterThanEqual} PartID )</arg>
            <arg>--split-by</arg>
            <arg>PartID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkPartLineSection_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet-Ingest-SPTM"/>
        <error to="MeasurementSet-Ingest-SPTM"/>
    </action>


	<decision name="MeasurementSet-Ingest-SPTM">
    	<switch>
			<case to="MeasurementSet-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_MeasurementSet_DoBase') eq 'true'}</case>
            <default to="MeasurementSet-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="MeasurementSet-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="MeasurementSet-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_MeasurementSet_DoDelta') eq 'true'}</case>
            <default to="MeasurementSet-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="MeasurementSet-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="MeasurementSet-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_MeasurementSet_DoIncrement') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPTT"/>
        </switch>
    </decision>

    <action name="MeasurementSet-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MeasurementSet_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID,ResumeStep,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MeasurementSet WHERE ( $CONDITIONS )  AND ( MeasurementSetID ${lessThanEqual} ${job_CAPETOWN_OWNER_MeasurementSet_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_MeasurementSet_MinBaseID} ${lessThanEqual} MeasurementSetID )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MeasurementSet_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet-Ingest-SPTM-IsDelta"/>
        <error to="MeasurementSet-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="MeasurementSet-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MeasurementSet_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID,ResumeStep,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MeasurementSet WHERE ( $CONDITIONS )  AND ( MeasurementSetID ${greaterThanEqual} ${job_CAPETOWN_OWNER_MeasurementSet_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MeasurementSet_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MeasurementSet-Ingest-SPTM-IsIncrement"/>
        <error to="MeasurementSet-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="MeasurementSet-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_MeasurementSet_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MeasurementSetID,ActualAttrSampleSize,AcquisitionContextID,IsEdited,DT,AcquisitionID,MachineStageID,RfAcquisitionClassID,RevisionNo,PartID,JobID,ResumeStep,InventoryPackID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.MeasurementSet WHERE ( $CONDITIONS )  AND (  MeasurementSetID ${greaterThanEqual} ${job_CAPETOWN_OWNER_MeasurementSet_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_MeasurementSet_MaxIncrementID} ${greaterThanEqual} MeasurementSetID )</arg>
            <arg>--split-by</arg>
            <arg>MeasurementSetID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_MeasurementSet_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPTT"/>
        <error to="PartInstance-Ingest-SPTT"/>
    </action>


	<decision name="PartInstance-Ingest-SPTT">
    	<switch>
			<case to="PartInstance-Ingest-SPTT-DoBase">${ wf:conf('job_TOULOUSE_OWNER_PartInstance_DoBase') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPTT-IsDelta"/>
        </switch>
    </decision>

	<decision name="PartInstance-Ingest-SPTT-IsDelta">
    	<switch>
			<case to="PartInstance-Ingest-SPTT-DoDelta">${ wf:conf('job_TOULOUSE_OWNER_PartInstance_DoDelta') eq 'true'}</case>
            <default to="PartInstance-Ingest-SPTT-IsIncrement"/>
        </switch>
    </decision>

	<decision name="PartInstance-Ingest-SPTT-IsIncrement">
    	<switch>
			<case to="PartInstance-Ingest-SPTT-DoIncrement">${ wf:conf('job_TOULOUSE_OWNER_PartInstance_DoIncrement') eq 'true'}</case>
            <default to="TagDefect-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="PartInstance-Ingest-SPTT-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_PartInstance_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS )  AND ( PartInstanceID ${lessThanEqual} ${job_TOULOUSE_OWNER_PartInstance_MaxBaseID} ) AND ( ${job_TOULOUSE_OWNER_PartInstance_MinBaseID} ${lessThanEqual} PartInstanceID )</arg>
            <arg>--split-by</arg>
            <arg>PartInstanceID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_PartInstance_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPTT-IsDelta"/>
        <error to="PartInstance-Ingest-SPTT-IsDelta"/>
    </action>
    <action name="PartInstance-Ingest-SPTT-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_PartInstance_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS )  AND ( PartInstanceID ${greaterThanEqual} ${job_TOULOUSE_OWNER_PartInstance_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>PartInstanceID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_PartInstance_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartInstance-Ingest-SPTT-IsIncrement"/>
        <error to="PartInstance-Ingest-SPTT-IsIncrement"/>
    </action>

    <action name="PartInstance-Ingest-SPTT-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_PartInstance_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartInstanceID,MeasurementSetID,HeadNo,SampleNo,SerialNo, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.PartInstance WHERE ( $CONDITIONS )  AND (  PartInstanceID ${greaterThanEqual} ${job_TOULOUSE_OWNER_PartInstance_MinIncrementID} ) AND ( ${job_TOULOUSE_OWNER_PartInstance_MaxIncrementID} ${greaterThanEqual} PartInstanceID )</arg>
            <arg>--split-by</arg>
            <arg>PartInstanceID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_PartInstance_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagDefect-Ingest-SPTM"/>
        <error to="TagDefect-Ingest-SPTM"/>
    </action>


	<decision name="TagDefect-Ingest-SPTM">
    	<switch>
			<case to="TagDefect-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_TagDefect_DoBase') eq 'true'}</case>
            <default to="TagDefect-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="TagDefect-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="TagDefect-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_TagDefect_DoDelta') eq 'true'}</case>
            <default to="TagDefect-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="TagDefect-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="TagDefect-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_TagDefect_DoIncrement') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="TagDefect-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagDefect_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagDefectID,IndividualDefectID,TagTypeID,TagValue,DT,X,Y, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagDefect WHERE ( $CONDITIONS )  AND ( TagDefectID ${lessThanEqual} ${job_CAPETOWN_OWNER_TagDefect_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_TagDefect_MinBaseID} ${lessThanEqual} TagDefectID )</arg>
            <arg>--split-by</arg>
            <arg>TagDefectID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagDefect_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagDefect-Ingest-SPTM-IsDelta"/>
        <error to="TagDefect-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="TagDefect-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagDefect_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagDefectID,IndividualDefectID,TagTypeID,TagValue,DT,X,Y, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagDefect WHERE ( $CONDITIONS )  AND ( TagDefectID ${greaterThanEqual} ${job_CAPETOWN_OWNER_TagDefect_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>TagDefectID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagDefect_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagDefect-Ingest-SPTM-IsIncrement"/>
        <error to="TagDefect-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="TagDefect-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_TagDefect_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagDefectID,IndividualDefectID,TagTypeID,TagValue,DT,X,Y, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.TagDefect WHERE ( $CONDITIONS )  AND (  TagDefectID ${greaterThanEqual} ${job_CAPETOWN_OWNER_TagDefect_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_TagDefect_MaxIncrementID} ${greaterThanEqual} TagDefectID )</arg>
            <arg>--split-by</arg>
            <arg>TagDefectID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_TagDefect_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPTM"/>
        <error to="UnitCount-Ingest-SPTM"/>
    </action>


	<decision name="UnitCount-Ingest-SPTM">
    	<switch>
			<case to="UnitCount-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_UnitCount_DoBase') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="UnitCount-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="UnitCount-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_UnitCount_DoDelta') eq 'true'}</case>
            <default to="UnitCount-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="UnitCount-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="UnitCount-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_UnitCount_DoIncrement') eq 'true'}</case>
            <default to="VarMeasurement-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="UnitCount-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitCount_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS )  AND ( UnitCountID ${lessThanEqual} ${job_CAPETOWN_OWNER_UnitCount_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_UnitCount_MinBaseID} ${lessThanEqual} UnitCountID )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitCount_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPTM-IsDelta"/>
        <error to="UnitCount-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="UnitCount-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitCount_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS )  AND ( UnitCountID ${greaterThanEqual} ${job_CAPETOWN_OWNER_UnitCount_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitCount_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="UnitCount-Ingest-SPTM-IsIncrement"/>
        <error to="UnitCount-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="UnitCount-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_UnitCount_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitCountID,UnitCountTypeID,PartID,Quantity,UnitID,DT,MachineStageID,IsEdited,RevisionNo, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.UnitCount WHERE ( $CONDITIONS )  AND (  UnitCountID ${greaterThanEqual} ${job_CAPETOWN_OWNER_UnitCount_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_UnitCount_MaxIncrementID} ${greaterThanEqual} UnitCountID )</arg>
            <arg>--split-by</arg>
            <arg>UnitCountID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_UnitCount_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurement-Ingest-SPTM"/>
        <error to="VarMeasurement-Ingest-SPTM"/>
    </action>


	<decision name="VarMeasurement-Ingest-SPTM">
    	<switch>
			<case to="VarMeasurement-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurement_DoBase') eq 'true'}</case>
            <default to="VarMeasurement-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="VarMeasurement-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="VarMeasurement-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurement_DoDelta') eq 'true'}</case>
            <default to="VarMeasurement-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="VarMeasurement-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="VarMeasurement-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_VarMeasurement_DoIncrement') eq 'true'}</case>
            <default to="BuildRecord-Ingest-SPTM"/>
        </switch>
    </decision>

    <action name="VarMeasurement-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurement_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementID,SpecID,MeasurementSetID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurement WHERE ( $CONDITIONS )  AND ( VarMeasurementID ${lessThanEqual} ${job_CAPETOWN_OWNER_VarMeasurement_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_VarMeasurement_MinBaseID} ${lessThanEqual} VarMeasurementID )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurement_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurement-Ingest-SPTM-IsDelta"/>
        <error to="VarMeasurement-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="VarMeasurement-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurement_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementID,SpecID,MeasurementSetID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurement WHERE ( $CONDITIONS )  AND ( VarMeasurementID ${greaterThanEqual} ${job_CAPETOWN_OWNER_VarMeasurement_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurement_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VarMeasurement-Ingest-SPTM-IsIncrement"/>
        <error to="VarMeasurement-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="VarMeasurement-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_VarMeasurement_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VarMeasurementID,SpecID,MeasurementSetID,Measurement,Ignored,VariableTypeID,ProductID,HeadNo,SampleNo,PositionNo,DT,RfIsOSID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.VarMeasurement WHERE ( $CONDITIONS )  AND (  VarMeasurementID ${greaterThanEqual} ${job_CAPETOWN_OWNER_VarMeasurement_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_VarMeasurement_MaxIncrementID} ${greaterThanEqual} VarMeasurementID )</arg>
            <arg>--split-by</arg>
            <arg>VarMeasurementID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_VarMeasurement_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BuildRecord-Ingest-SPTM"/>
        <error to="BuildRecord-Ingest-SPTM"/>
    </action>


	<decision name="BuildRecord-Ingest-SPTM">
    	<switch>
			<case to="BuildRecord-Ingest-SPTM-DoBase">${ wf:conf('job_CAPETOWN_OWNER_BuildRecord_DoBase') eq 'true'}</case>
            <default to="BuildRecord-Ingest-SPTM-IsDelta"/>
        </switch>
    </decision>

	<decision name="BuildRecord-Ingest-SPTM-IsDelta">
    	<switch>
			<case to="BuildRecord-Ingest-SPTM-DoDelta">${ wf:conf('job_CAPETOWN_OWNER_BuildRecord_DoDelta') eq 'true'}</case>
            <default to="BuildRecord-Ingest-SPTM-IsIncrement"/>
        </switch>
    </decision>

	<decision name="BuildRecord-Ingest-SPTM-IsIncrement">
    	<switch>
			<case to="BuildRecord-Ingest-SPTM-DoIncrement">${ wf:conf('job_CAPETOWN_OWNER_BuildRecord_DoIncrement') eq 'true'}</case>
            <default to="Job-Ingest-SPMX"/>
        </switch>
    </decision>

    <action name="BuildRecord-Ingest-SPTM-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_BuildRecord_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BuildRecord.BuildRecordID, BuildRecord.InvPackCreatedID, BuildRecord.InvPackConsumedID, BuildRecord.QuantityUsed, BuildRecord.UnitID, BuildRecord.BuildDT, BuildRecord.IsEdited, BuildRecord.RevisionNo, BuildRecord.BuildMachineStageID, BuildRecord_.Comments, BuildRecord_.LoginID, BuildRecord_.OpenedDT, BuildRecord_.SavedDT, BuildRecord_.EditedBuildRecordID, BuildRecord_.OriginalLoginID, BuildRecord_.Reference1, BuildRecord_.Reference2, BuildRecord_.Reference3, BuildRecord_.Reference4, BuildRecord_.Reference5,  5 as "org_id",  'SPTM' as "org_name"  FROM BuildRecord FULL JOIN BuildRecord_ ON (BuildRecord.BuildRecordID = BuildRecord_.BuildRecordID)   WHERE ( $CONDITIONS )  AND ( BuildRecord.BuildRecordID ${lessThanEqual} ${job_CAPETOWN_OWNER_BuildRecord_MaxBaseID} ) AND ( ${job_CAPETOWN_OWNER_BuildRecord_MinBaseID} ${lessThanEqual} BuildRecord.BuildRecordID )</arg>
            <arg>--split-by</arg>
            <arg>BuildRecord.BuildRecordID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_BuildRecord_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BuildRecord-Ingest-SPTM-IsDelta"/>
        <error to="BuildRecord-Ingest-SPTM-IsDelta"/>
    </action>
    <action name="BuildRecord-Ingest-SPTM-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_BuildRecord_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BuildRecord.BuildRecordID, BuildRecord.InvPackCreatedID, BuildRecord.InvPackConsumedID, BuildRecord.QuantityUsed, BuildRecord.UnitID, BuildRecord.BuildDT, BuildRecord.IsEdited, BuildRecord.RevisionNo, BuildRecord.BuildMachineStageID, BuildRecord_.Comments, BuildRecord_.LoginID, BuildRecord_.OpenedDT, BuildRecord_.SavedDT, BuildRecord_.EditedBuildRecordID, BuildRecord_.OriginalLoginID, BuildRecord_.Reference1, BuildRecord_.Reference2, BuildRecord_.Reference3, BuildRecord_.Reference4, BuildRecord_.Reference5,  5 as "org_id",  'SPTM' as "org_name"  FROM BuildRecord FULL JOIN BuildRecord_ ON (BuildRecord.BuildRecordID = BuildRecord_.BuildRecordID)   WHERE ( $CONDITIONS )  AND ( BuildRecord.BuildRecordID ${greaterThanEqual} ${job_CAPETOWN_OWNER_BuildRecord_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>BuildRecord.BuildRecordID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_BuildRecord_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BuildRecord-Ingest-SPTM-IsIncrement"/>
        <error to="BuildRecord-Ingest-SPTM-IsIncrement"/>
    </action>

    <action name="BuildRecord-Ingest-SPTM-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_BuildRecord_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BuildRecord.BuildRecordID, BuildRecord.InvPackCreatedID, BuildRecord.InvPackConsumedID, BuildRecord.QuantityUsed, BuildRecord.UnitID, BuildRecord.BuildDT, BuildRecord.IsEdited, BuildRecord.RevisionNo, BuildRecord.BuildMachineStageID, BuildRecord_.Comments, BuildRecord_.LoginID, BuildRecord_.OpenedDT, BuildRecord_.SavedDT, BuildRecord_.EditedBuildRecordID, BuildRecord_.OriginalLoginID, BuildRecord_.Reference1, BuildRecord_.Reference2, BuildRecord_.Reference3, BuildRecord_.Reference4, BuildRecord_.Reference5,  5 as "org_id",  'SPTM' as "org_name"  FROM BuildRecord FULL JOIN BuildRecord_ ON (BuildRecord.BuildRecordID = BuildRecord_.BuildRecordID)   WHERE ( $CONDITIONS )  AND (  BuildRecord.BuildRecordID ${greaterThanEqual} ${job_CAPETOWN_OWNER_BuildRecord_MinIncrementID} ) AND ( ${job_CAPETOWN_OWNER_BuildRecord_MaxIncrementID} ${greaterThanEqual} BuildRecord.BuildRecordID )</arg>
            <arg>--split-by</arg>
            <arg>BuildRecord.BuildRecordID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_BuildRecord_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Job-Ingest-SPMX"/>
        <error to="Job-Ingest-SPMX"/>
    </action>


	<decision name="Job-Ingest-SPMX">
    	<switch>
			<case to="Job-Ingest-SPMX-DoBase">${ wf:conf('job_MEXICALI_OWNER_Job_DoBase') eq 'true'}</case>
            <default to="Job-Ingest-SPMX-IsDelta"/>
        </switch>
    </decision>

	<decision name="Job-Ingest-SPMX-IsDelta">
    	<switch>
			<case to="Job-Ingest-SPMX-DoDelta">${ wf:conf('job_MEXICALI_OWNER_Job_DoDelta') eq 'true'}</case>
            <default to="Job-Ingest-SPMX-IsIncrement"/>
        </switch>
    </decision>

	<decision name="Job-Ingest-SPMX-IsIncrement">
    	<switch>
			<case to="Job-Ingest-SPMX-DoIncrement">${ wf:conf('job_MEXICALI_OWNER_Job_DoIncrement') eq 'true'}</case>
            <default to="End-Incr-7-Ingest"/>
        </switch>
    </decision>

    <action name="Job-Ingest-SPMX-DoBase">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Job_DoBaseTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Job.JobID, Job.WOID, Job.RfJobStatusID, Job.DeadlineDT, Job.ActualStartDT, Job.ActualEndDT, Job.PlannedStartDT, Job.PlannedEndDT, Job.PlannedDuration, Job.EstimatedStartDT, Job.EstimatedEndDT, Job.EstimatedDuration, Job.ScheduledSequence, Job.LineID, Job.ProductionStartDT, Job.ProductionEndDT, Job.TheoreticalCycleTime, Job.BudgetChangeOver, Job.QuantityOrdered, Job.IsCalculated, Job.LineGroupID, Job_.JobInstructions, Job_.ReleaseDT, Job_.ReleaseLoginID, Job_.StartLoginID, Job_.EndLoginID, Job_.Comments, Job_.ModifiedDt, Job_.ModifiedLoginID, Job_.StoppedReason, Job_.SkippedReason, Job_.SkippedDT,  1 as "org_id",  'SPMX' as "org_name"  FROM Job FULL JOIN Job_ ON (Job.JobID = Job_.JobID) FULL JOIN Job_Custom ON (Job.JobID = Job_Custom.JobID)   WHERE ( $CONDITIONS )  AND ( Job.JobID ${lessThanEqual} ${job_MEXICALI_OWNER_Job_MaxBaseID} ) AND ( ${job_MEXICALI_OWNER_Job_MinBaseID} ${lessThanEqual} Job.JobID )</arg>
            <arg>--split-by</arg>
            <arg>Job.JobID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Job_DoBaseTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Job-Ingest-SPMX-IsDelta"/>
        <error to="Job-Ingest-SPMX-IsDelta"/>
    </action>
    <action name="Job-Ingest-SPMX-DoDelta">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Job_DoDeltaTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Job.JobID, Job.WOID, Job.RfJobStatusID, Job.DeadlineDT, Job.ActualStartDT, Job.ActualEndDT, Job.PlannedStartDT, Job.PlannedEndDT, Job.PlannedDuration, Job.EstimatedStartDT, Job.EstimatedEndDT, Job.EstimatedDuration, Job.ScheduledSequence, Job.LineID, Job.ProductionStartDT, Job.ProductionEndDT, Job.TheoreticalCycleTime, Job.BudgetChangeOver, Job.QuantityOrdered, Job.IsCalculated, Job.LineGroupID, Job_.JobInstructions, Job_.ReleaseDT, Job_.ReleaseLoginID, Job_.StartLoginID, Job_.EndLoginID, Job_.Comments, Job_.ModifiedDt, Job_.ModifiedLoginID, Job_.StoppedReason, Job_.SkippedReason, Job_.SkippedDT,  1 as "org_id",  'SPMX' as "org_name"  FROM Job FULL JOIN Job_ ON (Job.JobID = Job_.JobID) FULL JOIN Job_Custom ON (Job.JobID = Job_Custom.JobID)   WHERE ( $CONDITIONS )  AND ( Job.JobID ${greaterThanEqual} ${job_MEXICALI_OWNER_Job_MinDeltaID} )</arg>
            <arg>--split-by</arg>
            <arg>Job.JobID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Job_DoDeltaTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Job-Ingest-SPMX-IsIncrement"/>
        <error to="Job-Ingest-SPMX-IsIncrement"/>
    </action>

    <action name="Job-Ingest-SPMX-DoIncrement">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Job_DoIncrementTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Job.JobID, Job.WOID, Job.RfJobStatusID, Job.DeadlineDT, Job.ActualStartDT, Job.ActualEndDT, Job.PlannedStartDT, Job.PlannedEndDT, Job.PlannedDuration, Job.EstimatedStartDT, Job.EstimatedEndDT, Job.EstimatedDuration, Job.ScheduledSequence, Job.LineID, Job.ProductionStartDT, Job.ProductionEndDT, Job.TheoreticalCycleTime, Job.BudgetChangeOver, Job.QuantityOrdered, Job.IsCalculated, Job.LineGroupID, Job_.JobInstructions, Job_.ReleaseDT, Job_.ReleaseLoginID, Job_.StartLoginID, Job_.EndLoginID, Job_.Comments, Job_.ModifiedDt, Job_.ModifiedLoginID, Job_.StoppedReason, Job_.SkippedReason, Job_.SkippedDT,  1 as "org_id",  'SPMX' as "org_name"  FROM Job FULL JOIN Job_ ON (Job.JobID = Job_.JobID) FULL JOIN Job_Custom ON (Job.JobID = Job_Custom.JobID)   WHERE ( $CONDITIONS )  AND (  Job.JobID ${greaterThanEqual} ${job_MEXICALI_OWNER_Job_MinIncrementID} ) AND ( ${job_MEXICALI_OWNER_Job_MaxIncrementID} ${greaterThanEqual} Job.JobID )</arg>
            <arg>--split-by</arg>
            <arg>Job.JobID</arg>
            <arg>--num-mappers</arg>
            <arg>6</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Job_DoIncrementTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Incr-7-Ingest"/>
        <error to="End-Incr-7-Ingest"/>
    </action>


	<end name="End-Incr-7-Ingest"/>
</workflow-app>

<workflow-app name="Ingest-Full-3" xmlns="uri:oozie:workflow:0.1">

 	<start to="_SP_LkInvIsolatedReasonMST-Ingest-SPTT-Decision"/>


	<decision name="_SP_LkInvIsolatedReasonMST-Ingest-SPTT-Decision">
    	<switch>
			<case to="_SP_LkInvIsolatedReasonMST-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER__SP_LkInvIsolatedReasonMST_DoFull') eq 'true'}</case>
            <default to="AcquisitionContext-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="_SP_LkInvIsolatedReasonMST-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER__SP_LkInvIsolatedReasonMST_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkInvIsolatedReasonMSTID,InvIsolatedReasonID,MachineStageTypeID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo._SP_LkInvIsolatedReasonMST WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER__SP_LkInvIsolatedReasonMST_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="AcquisitionContext-Ingest-SPMX-Decision"/>
        <error to="AcquisitionContext-Ingest-SPMX-Decision"/>
    </action>

	<decision name="AcquisitionContext-Ingest-SPMX-Decision">
    	<switch>
			<case to="AcquisitionContext-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_AcquisitionContext_DoFull') eq 'true'}</case>
            <default to="Action-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="AcquisitionContext-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_AcquisitionContext_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageID,AcquisitionVariantID,LastMeasurementSetID,AcquisitionContextID,LastDoneDT,IsAttrOC,IsCriticalDefect, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.AcquisitionContext WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_AcquisitionContext_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Action-Ingest-SPMX-Decision"/>
        <error to="Action-Ingest-SPMX-Decision"/>
    </action>

	<decision name="Action-Ingest-SPMX-Decision">
    	<switch>
			<case to="Action-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Action_DoFull') eq 'true'}</case>
            <default to="Address-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="Action-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Action_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ActionID,RfSpecialActionTypeID,ActionTypeID,ActionSubTypeID,ActionPlanID,ActionPlanCode,ActionName,Description,ActionOrder,RfPriorityID,SubmitterID,SubmittedDT,OwnerID,ActionStatusID,ClosedDT,ModifiedDT,LoginID,IsEdited,RevisionNo,DueDT,DeadlineDT,ExpiryDT,SortOrder, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Action WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Action_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Address-Ingest-SPMX-Decision"/>
        <error to="Address-Ingest-SPMX-Decision"/>
    </action>

	<decision name="Address-Ingest-SPMX-Decision">
    	<switch>
			<case to="Address-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Address_DoFull') eq 'true'}</case>
            <default to="Attribute-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="Address-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Address_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AddressID,Address1,Address2,City,County,PostCode,Country, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Address WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Address_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Attribute-Ingest-SPMX-Decision"/>
        <error to="Attribute-Ingest-SPMX-Decision"/>
    </action>

	<decision name="Attribute-Ingest-SPMX-Decision">
    	<switch>
			<case to="Attribute-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Attribute_DoFull') eq 'true'}</case>
            <default to="BOMItem-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="Attribute-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Attribute_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeID,AttributeTypeID,ProductID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Attribute WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Attribute_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="BOMItem-Ingest-SPMX-Decision"/>
        <error to="BOMItem-Ingest-SPMX-Decision"/>
    </action>

	<decision name="BOMItem-Ingest-SPMX-Decision">
    	<switch>
			<case to="BOMItem-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_BOMItem_DoFull') eq 'true'}</case>
            <default to="Concern-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="BOMItem-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_BOMItem_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT BOMItemID,BOMVariantID,PartID,SubPartID,SubPartQuantity,SubPartUnitID,RfInvPackTraceabilityID,Sequence,Instructions,RfBOMItemTypeID,IsDefault,IsAllowExceedBOMQty,Reference1,Reference2,Reference3,Reference4,Reference5, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.BOMItem WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_BOMItem_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Concern-Ingest-SPMX-Decision"/>
        <error to="Concern-Ingest-SPMX-Decision"/>
    </action>

	<decision name="Concern-Ingest-SPMX-Decision">
    	<switch>
			<case to="Concern-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Concern_DoFull') eq 'true'}</case>
            <default to="Customer-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="Concern-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Concern_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ConcernID,ConcernStatusID,ConcernTypeID,RaisedDT,ClosedDT,SeverityID,DueDate,ConcernOwnerID,DepartmentOwnerID,CustomerID,CustomerContact,CustomerReference,AffectOnCustomer,PartTypeID,PartID,WOID,LineID,ProductionFromDT,ShiftID,QuantityAffected,QuantityUsed,InvIsolatedReasonID,Cost,LoginID,ModifiedDT,Concern,SubmitterLoginID,CustomerProduct,RfCurrencyID,MachineStageID,Reference1,Reference2,Reference3,RfConcernApplicationTypeID,HeadNo,ProductionToDT,QuantityFound,QuantityReturned,QuantityScrapped,QuantitySorted,SupplierID,ToolID,VariableTypeID,AttributeTypeID,ClosedByLoginID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Concern WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Concern_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Customer-Ingest-SPMX-Decision"/>
        <error to="Customer-Ingest-SPMX-Decision"/>
    </action>

	<decision name="Customer-Ingest-SPMX-Decision">
    	<switch>
			<case to="Customer-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_Customer_DoFull') eq 'true'}</case>
            <default to="dtproperties-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="Customer-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_Customer_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT CustomerID,Customer,CustomerCode,AddressID,RfLanguageID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.Customer WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_Customer_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="dtproperties-Ingest-SPTT-Decision"/>
        <error to="dtproperties-Ingest-SPTT-Decision"/>
    </action>

	<decision name="dtproperties-Ingest-SPTT-Decision">
    	<switch>
			<case to="dtproperties-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_dtproperties_DoFull') eq 'true'}</case>
            <default to="InventoryUsage-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="dtproperties-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_dtproperties_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT id,objectid,property,value,uvalue,lvalue,version, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.dtproperties WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_dtproperties_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="InventoryUsage-Ingest-SPMX-Decision"/>
        <error to="InventoryUsage-Ingest-SPMX-Decision"/>
    </action>

	<decision name="InventoryUsage-Ingest-SPMX-Decision">
    	<switch>
			<case to="InventoryUsage-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_InventoryUsage_DoFull') eq 'true'}</case>
            <default to="LineInfo-Ingest-SPTM-Decision"/>
        </switch>
    </decision>

    <action name="InventoryUsage-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_InventoryUsage_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT InventoryUsageID,JobID,MachineStageID,InventoryPackID,FromDT,ToDT,IsEdited,RevisionNo,IsReintroduced,Quantity, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.InventoryUsage WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_InventoryUsage_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LineInfo-Ingest-SPTM-Decision"/>
        <error to="LineInfo-Ingest-SPTM-Decision"/>
    </action>

	<decision name="LineInfo-Ingest-SPTM-Decision">
    	<switch>
			<case to="LineInfo-Ingest-SPTM">${ wf:conf('job_CAPETOWN_OWNER_LineInfo_DoFull') eq 'true'}</case>
            <default to="LkATATG-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LineInfo-Ingest-SPTM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_CAPETOWN_OWNER_LineInfo_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=CAPETOWN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LineInfoID,RfLineInfoEventID,LineID,ShiftID,WOID,FromDT,ToDT,rfDayHourPeriodID,TotalTime,ExcludedTime,ScheduledTime,STOperations,STInduced,DTTechnical,DTOperations,DTQuality,DownTime,StopTime,RunTime,NotRunTime,TheoreticalCycleTime,QuantityScrap,QuantityGood,ModifiedDT,LoginID,QuantityIn,TotalInventoryProduced,TotalInventoryReintroduced,NetQuantityProduced,QuantityInLineSpoilage,TotalSpoilage,AccountedSpoilage,TotalInventoryIsolated,ProductionStopJobID,TotalUnitsProduced,BottleNeckMachineStageID,InventoryIn,InterProdStopTime,InProdStopTime,QuantityUnitsIn,QuantityInventoryIn,TotalQuantityProduced,TotalPacksProduced,TotalPacksIsolated,TotalPacksReintroduced,TotalPacksMade,ValidState,LineGroupID,LineGroupShiftID,LineGroupBottleneckID, 5 as "org_id",  'SPTM' as "org_name"   FROM dbo.LineInfo WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_CAPETOWN_OWNER_LineInfo_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkATATG-Ingest-SPTT-Decision"/>
        <error to="LkATATG-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkATATG-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkATATG-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkATATG_DoFull') eq 'true'}</case>
            <default to="LKCSetCDef-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LkATATG-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkATATG_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT AttributeTypeGroupID,AttributeTypeID,LkATATGID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkATATG WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkATATG_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LKCSetCDef-Ingest-SPTT-Decision"/>
        <error to="LKCSetCDef-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LKCSetCDef-Ingest-SPTT-Decision">
    	<switch>
			<case to="LKCSetCDef-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LKCSetCDef_DoFull') eq 'true'}</case>
            <default to="LkDocumentWIStep-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="LKCSetCDef-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LKCSetCDef_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartSetID,SPCChartDefID,Sequence,LkCSetCDefID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LKCSetCDef WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LKCSetCDef_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkDocumentWIStep-Ingest-SPTT-Decision"/>
        <error to="LkDocumentWIStep-Ingest-SPTT-Decision"/>
    </action>

	<decision name="LkDocumentWIStep-Ingest-SPTT-Decision">
    	<switch>
			<case to="LkDocumentWIStep-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_LkDocumentWIStep_DoFull') eq 'true'}</case>
            <default to="LkMaintProcPersonnel-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="LkDocumentWIStep-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_LkDocumentWIStep_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkDocumentWIStepID,WorkInstructionStepID,DocumentID, 4 as "org_id",  'SPTT' as "org_name"   FROM dbo.LkDocumentWIStep WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_LkDocumentWIStep_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkMaintProcPersonnel-Ingest-SPMX-Decision"/>
        <error to="LkMaintProcPersonnel-Ingest-SPMX-Decision"/>
    </action>

	<decision name="LkMaintProcPersonnel-Ingest-SPMX-Decision">
    	<switch>
			<case to="LkMaintProcPersonnel-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_LkMaintProcPersonnel_DoFull') eq 'true'}</case>
            <default to="LkPartAlternatePart-Ingest-SPMX-Decision"/>
        </switch>
    </decision>

    <action name="LkMaintProcPersonnel-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkMaintProcPersonnel_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkMaintProcPersonnelID,MaintenanceProcedureID,PersonnelID, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkMaintProcPersonnel WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkMaintProcPersonnel_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkPartAlternatePart-Ingest-SPMX-Decision"/>
        <error to="LkPartAlternatePart-Ingest-SPMX-Decision"/>
    </action>

	<decision name="LkPartAlternatePart-Ingest-SPMX-Decision">
    	<switch>
			<case to="LkPartAlternatePart-Ingest-SPMX">${ wf:conf('job_MEXICALI_OWNER_LkPartAlternatePart_DoFull') eq 'true'}</case>
            <default to="LkSPCCSVR-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkPartAlternatePart-Ingest-SPMX">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_MEXICALI_OWNER_LkPartAlternatePart_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=MEXICALI_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkPartAlternatePartID,AlternatePartID,PartID,PartToAlternatePartRatio, 1 as "org_id",  'SPMX' as "org_name"   FROM dbo.LkPartAlternatePart WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_MEXICALI_OWNER_LkPartAlternatePart_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkSPCCSVR-Ingest-SPMM-Decision"/>
        <error to="LkSPCCSVR-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkSPCCSVR-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkSPCCSVR-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkSPCCSVR_DoFull') eq 'true'}</case>
            <default to="LkUCTGUCT-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkSPCCSVR-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkSPCCSVR_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCCalcStyleID,RfViolationRuleID,RfChartComponentID,LkSPCCSVRID,RuleRange,RuleGroup, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkSPCCSVR WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkSPCCSVR_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="LkUCTGUCT-Ingest-SPMM-Decision"/>
        <error to="LkUCTGUCT-Ingest-SPMM-Decision"/>
    </action>

	<decision name="LkUCTGUCT-Ingest-SPMM-Decision">
    	<switch>
			<case to="LkUCTGUCT-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_LkUCTGUCT_DoFull') eq 'true'}</case>
            <default to="MachineStageCell-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="LkUCTGUCT-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_LkUCTGUCT_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT LkUCTGUCTID,UnitCountTypeGroupID,UnitCountTypeID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.LkUCTGUCT WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_LkUCTGUCT_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStageCell-Ingest-SPMM-Decision"/>
        <error to="MachineStageCell-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MachineStageCell-Ingest-SPMM-Decision">
    	<switch>
			<case to="MachineStageCell-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MachineStageCell_DoFull') eq 'true'}</case>
            <default to="MachineStopReason-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStageCell-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MachineStageCell_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStageCellID,MachineStageID,IsCreator,IsConsumer,IsLabeller,IsAutoBatchNo,IsPackConsumer,IsResortConsumer,IsNonJob,IsToolShowCavities,IsInvPackPackNo,IsInvPackPartNo,IsInvPackPartDesc,IsInvPackPartType,IsInvPackQty,IsInvPackHeader,IsInvPackRows,IsInvPackState,IsInvPackReason,IsAcqDblck,AcqGrid,CustomPage,IsClickable,IsDrillable, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MachineStageCell WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MachineStageCell_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MachineStopReason-Ingest-SPMM-Decision"/>
        <error to="MachineStopReason-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MachineStopReason-Ingest-SPMM-Decision">
    	<switch>
			<case to="MachineStopReason-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MachineStopReason_DoFull') eq 'true'}</case>
            <default to="MaintenanceProcedure-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MachineStopReason-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MachineStopReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MachineStopReasonID,StopReason,Description,MachineStageTypeID,IsPlanned,StopCode,RfMachineStopClassID,RfLineStopReasonTypeID,MachineStopCategoryID,IsRetired, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MachineStopReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MachineStopReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceProcedure-Ingest-SPMM-Decision"/>
        <error to="MaintenanceProcedure-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MaintenanceProcedure-Ingest-SPMM-Decision">
    	<switch>
			<case to="MaintenanceProcedure-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MaintenanceProcedure_DoFull') eq 'true'}</case>
            <default to="MaintenanceWork-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceProcedure-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MaintenanceProcedure_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceProcedureID,MaintenanceProcedure,PartID,ResponsibleDepartmentID,BudgetWorkDone,PlannedManHours,PlannedDuration,MaintenanceProcedureCode,AdvanceWarningPeriod,SchedulingWindow,PlannedMachineStageDowntime,PlannedLineDowntime,SubPartID,CreatedDT,CreatedLoginID,RfMaintenanceWorkTypeID,CostCentreID,IsAutoAuthoriseWork,IsRetired,IsToolTakenOutOfService, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MaintenanceProcedure WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MaintenanceProcedure_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="MaintenanceWork-Ingest-SPMM-Decision"/>
        <error to="MaintenanceWork-Ingest-SPMM-Decision"/>
    </action>

	<decision name="MaintenanceWork-Ingest-SPMM-Decision">
    	<switch>
			<case to="MaintenanceWork-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_MaintenanceWork_DoFull') eq 'true'}</case>
            <default to="ModulePackedDateTime-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="MaintenanceWork-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_MaintenanceWork_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT MaintenanceWorkID,MaintenanceWO,AssetID,MaintenanceProcedureID,MaintenanceProcedureRevisionID,MaintProcScheduleOnAssetID,RfMaintenanceWorkTypeID,AdhocWorkToDo,MaintProcScheduleOnAssetNo,MaintenanceWorkStatusID,ActualStartDT,ActualEndDT,ActualManHours,PlannedStartDT,PlannedEndDT,PlannedManHours,OwnerLoginID,ActualLabourCost,PlannedLabourCost,RfCurrencyID,PartsCost,LineDownCost,Priority,MaintenanceReasonID,IsPlannedDateLockedByUser,EBATriggerID,PeriodDueDT,RunHoursDueDT,PartsBasedDueDT,EventDueDT,ReleasedDT,ReleasedLoginID,IsEdited,RevisionNo,AbsoluteCounterThreshold, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.MaintenanceWork WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_MaintenanceWork_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ModulePackedDateTime-Ingest-SPMM-Decision"/>
        <error to="ModulePackedDateTime-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ModulePackedDateTime-Ingest-SPMM-Decision">
    	<switch>
			<case to="ModulePackedDateTime-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ModulePackedDateTime_DoFull') eq 'true'}</case>
            <default to="OPCGroup-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ModulePackedDateTime-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ModulePackedDateTime_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SerialNo,TimePacked,IMS_No, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ModulePackedDateTime WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ModulePackedDateTime_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCGroup-Ingest-SPMM-Decision"/>
        <error to="OPCGroup-Ingest-SPMM-Decision"/>
    </action>

	<decision name="OPCGroup-Ingest-SPMM-Decision">
    	<switch>
			<case to="OPCGroup-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_OPCGroup_DoFull') eq 'true'}</case>
            <default to="OPCServer-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="OPCGroup-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_OPCGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCGroupID,Deadband,UpdateRate,OPCGroup,IsActive,RfGroupNotifyModeID,TimeBias,OPCServerID,IsPublic,LocalID,CacheUpdateRate, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.OPCGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_OPCGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="OPCServer-Ingest-SPMM-Decision"/>
        <error to="OPCServer-Ingest-SPMM-Decision"/>
    </action>

	<decision name="OPCServer-Ingest-SPMM-Decision">
    	<switch>
			<case to="OPCServer-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_OPCServer_DoFull') eq 'true'}</case>
            <default to="PartSubClassification-Ingest-SPDV-Decision"/>
        </switch>
    </decision>

    <action name="OPCServer-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_OPCServer_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT OPCServerID,OPCClientID,OPCServer,ProgID,IsActive,ComputerID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.OPCServer WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_OPCServer_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="PartSubClassification-Ingest-SPDV-Decision"/>
        <error to="PartSubClassification-Ingest-SPDV-Decision"/>
    </action>

	<decision name="PartSubClassification-Ingest-SPDV-Decision">
    	<switch>
			<case to="PartSubClassification-Ingest-SPDV">${ wf:conf('job_DEVERN_OWNER_PartSubClassification_DoFull') eq 'true'}</case>
            <default to="ProductType-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="PartSubClassification-Ingest-SPDV">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_DEVERN_OWNER_PartSubClassification_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=DEVERN_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT PartSubClassificationID,PartSubClassification,PartClassificationID, 3 as "org_id",  'SPDV' as "org_name"   FROM dbo.PartSubClassification WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_DEVERN_OWNER_PartSubClassification_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ProductType-Ingest-SPMM-Decision"/>
        <error to="ProductType-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ProductType-Ingest-SPMM-Decision">
    	<switch>
			<case to="ProductType-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ProductType_DoFull') eq 'true'}</case>
            <default to="ScrapReasonGroup-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ProductType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ProductType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ProductTypeID,Name,ProductTypeCode,Variant1TagListID,Variant2TagListID,Variant3TagListID,Variant4TagListID,Variant5TagListID,Variant6TagListID,Variant7TagListID,Variant8TagListID,Variant9TagListID,Variant10TagListID,Variant11TagListID,Variant12TagListID,Variant13TagListID,Variant14TagListID,Variant15TagListID,Variant16TagListID,Variant17TagListID,Variant18TagListID,Variant19TagListID,Variant20TagListID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ProductType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ProductType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ScrapReasonGroup-Ingest-SPMM-Decision"/>
        <error to="ScrapReasonGroup-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ScrapReasonGroup-Ingest-SPMM-Decision">
    	<switch>
			<case to="ScrapReasonGroup-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ScrapReasonGroup_DoFull') eq 'true'}</case>
            <default to="ShiftPattern-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ScrapReasonGroup-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ScrapReasonGroup_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ScrapReasonGroupID,ScrapReasonGroup,Description, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ScrapReasonGroup WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ScrapReasonGroup_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ShiftPattern-Ingest-SPMM-Decision"/>
        <error to="ShiftPattern-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ShiftPattern-Ingest-SPMM-Decision">
    	<switch>
			<case to="ShiftPattern-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ShiftPattern_DoFull') eq 'true'}</case>
            <default to="SPCChartDef-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ShiftPattern-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ShiftPattern_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ShiftPatternID,ShiftPattern,PatternDuration,IsPatternDirty,IsCustomPeriod, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ShiftPattern WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ShiftPattern_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCChartDef-Ingest-SPMM-Decision"/>
        <error to="SPCChartDef-Ingest-SPMM-Decision"/>
    </action>

	<decision name="SPCChartDef-Ingest-SPMM-Decision">
    	<switch>
			<case to="SPCChartDef-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_SPCChartDef_DoFull') eq 'true'}</case>
            <default to="SPCRule-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="SPCChartDef-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_SPCChartDef_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCChartDefID,VariableTypeID,SPCRuleID,RfStudyTypeID,GroupingSize,MovingRange,SPCCalcStyleID,RfGroupingID,NGroupMarkerID,CpBasedOnID,CLBasedOnID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.SPCChartDef WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_SPCChartDef_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="SPCRule-Ingest-SPMM-Decision"/>
        <error to="SPCRule-Ingest-SPMM-Decision"/>
    </action>

	<decision name="SPCRule-Ingest-SPMM-Decision">
    	<switch>
			<case to="SPCRule-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_SPCRule_DoFull') eq 'true'}</case>
            <default to="TagList-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="SPCRule-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_SPCRule_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT SPCRuleID,SPCRule,TAGMSTYPE1ID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.SPCRule WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_SPCRule_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagList-Ingest-SPMM-Decision"/>
        <error to="TagList-Ingest-SPMM-Decision"/>
    </action>

	<decision name="TagList-Ingest-SPMM-Decision">
    	<switch>
			<case to="TagList-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_TagList_DoFull') eq 'true'}</case>
            <default to="TagTreeNodeImgLoc-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="TagList-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_TagList_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagListID,ListName,VariantNo, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.TagList WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_TagList_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="TagTreeNodeImgLoc-Ingest-SPMM-Decision"/>
        <error to="TagTreeNodeImgLoc-Ingest-SPMM-Decision"/>
    </action>

	<decision name="TagTreeNodeImgLoc-Ingest-SPMM-Decision">
    	<switch>
			<case to="TagTreeNodeImgLoc-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_TagTreeNodeImgLoc_DoFull') eq 'true'}</case>
            <default to="Tool-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="TagTreeNodeImgLoc-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_TagTreeNodeImgLoc_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT TagTreeNodeImgLocID,TagTreeNodeID,X,Y,Width,Height,MappedTagTreeNodeID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.TagTreeNodeImgLoc WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_TagTreeNodeImgLoc_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Tool-Ingest-SPMM-Decision"/>
        <error to="Tool-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Tool-Ingest-SPMM-Decision">
    	<switch>
			<case to="Tool-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Tool_DoFull') eq 'true'}</case>
            <default to="ToolChangeReason-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Tool-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Tool_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolID,Tool,ToolSet,Description,ToolTypeID,IsRetired,NoCavities,Variant1,Variant2,Variant3,Variant4,Variant5,Variant6,Variant7,Variant8,Variant9,Variant10,Variant11,Variant12,Variant13,Variant14,Variant15,PartID,Variant16,Variant17,Variant18,Variant19,Variant20, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.Tool WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Tool_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="ToolChangeReason-Ingest-SPMM-Decision"/>
        <error to="ToolChangeReason-Ingest-SPMM-Decision"/>
    </action>

	<decision name="ToolChangeReason-Ingest-SPMM-Decision">
    	<switch>
			<case to="ToolChangeReason-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_ToolChangeReason_DoFull') eq 'true'}</case>
            <default to="Unit-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="ToolChangeReason-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_ToolChangeReason_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT ToolChangeReasonID,ToolTypeID,ChangeReason,Description,ChangeToRfToolStatusID, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.ToolChangeReason WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_ToolChangeReason_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Unit-Ingest-SPMM-Decision"/>
        <error to="Unit-Ingest-SPMM-Decision"/>
    </action>

	<decision name="Unit-Ingest-SPMM-Decision">
    	<switch>
			<case to="Unit-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_Unit_DoFull') eq 'true'}</case>
            <default to="VariableType-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="Unit-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_Unit_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT UnitID,Unit,Description, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.Unit WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_Unit_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="VariableType-Ingest-SPMM-Decision"/>
        <error to="VariableType-Ingest-SPMM-Decision"/>
    </action>

	<decision name="VariableType-Ingest-SPMM-Decision">
    	<switch>
			<case to="VariableType-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_VariableType_DoFull') eq 'true'}</case>
            <default to="WORef-Ingest-SPMM-Decision"/>
        </switch>
    </decision>

    <action name="VariableType-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_VariableType_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT VariableTypeID,Name,ProductTypeID,Description,IsUnilateral,VariableTypeCode,IsProcessParameter,VariableTypeClassID,ImageURI, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.VariableType WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_VariableType_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="WORef-Ingest-SPMM-Decision"/>
        <error to="WORef-Ingest-SPMM-Decision"/>
    </action>

	<decision name="WORef-Ingest-SPMM-Decision">
    	<switch>
			<case to="WORef-Ingest-SPMM">${ wf:conf('job_SPMM_C1_OWNER_WORef_DoFull') eq 'true'}</case>
            <default to="Location-Ingest-SPTT-Decision"/>
        </switch>
    </decision>

    <action name="WORef-Ingest-SPMM">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_SPMM_C1_OWNER_WORef_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=SPMM_C1_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT WORefID,WOReference, 2 as "org_id",  'SPMM' as "org_name"   FROM dbo.WORef WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_SPMM_C1_OWNER_WORef_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="Location-Ingest-SPTT-Decision"/>
        <error to="Location-Ingest-SPTT-Decision"/>
    </action>

	<decision name="Location-Ingest-SPTT-Decision">
    	<switch>
			<case to="Location-Ingest-SPTT">${ wf:conf('job_TOULOUSE_OWNER_Location_DoFull') eq 'true'}</case>
            <default to="End-Full-3-Ingest-Decision"/>
        </switch>
    </decision>

    <action name="Location-Ingest-SPTT">
        <sqoop xmlns="uri:oozie:sqoop-action:0.2">
			<job-tracker>${jobTracker}</job-tracker>
            <name-node>${nameNode}</name-node>
			<prepare>
            	<delete path="${job_TOULOUSE_OWNER_Location_DoFullTarget}" />
            </prepare>         	
            <arg>import</arg>
         	<arg>--connect</arg>
            <arg>jdbc:sqlserver://172.23.236.90:1433;database=TOULOUSE_OWNER</arg>
            <arg>--username</arg>
            <arg>usrSqoop</arg>
            <arg>--password</arg>
            <arg>AXm6Sn6#o</arg>
            <arg>--query</arg>
            <arg>SELECT Location.LocationID, Location.Location, Location.LocationTypeID, Location.IsRetired, Location.MaxQuantity, Location.LocationCode, Location.Description, LocationType.LocationType, LocationType.LocationTypeCode,  4 as "org_id",  'SPTT' as "org_name"  FROM Location FULL JOIN LocationType ON (Location.LocationID = LocationType.LocationTypeID)   WHERE ( $CONDITIONS ) </arg>
            <arg>--num-mappers</arg>
            <arg>1</arg>
            <arg>--target-dir</arg>
            <arg>${job_TOULOUSE_OWNER_Location_DoFullTarget}</arg>
            <arg>--fields-terminated-by</arg>
            <arg>\t</arg>
            <arg>--direct</arg>
            <arg>--</arg>
            <arg>--schema</arg>
            <arg>dbo</arg>
            <arg>-validate</arg>
        </sqoop>
        <ok to="End-Full-3-Ingest-Decision"/>
        <error to="End-Full-3-Ingest-Decision"/>
    </action>

	<end name="End-Full-3-Ingest-Decision"/>
</workflow-app>
